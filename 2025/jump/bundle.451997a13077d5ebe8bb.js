(()=>{var t,s,i={133:(t,s,i)=>{"use strict";i.d(s,{L:()=>n});const e={default:-1};function n(t="default"){return void 0===e[t]&&(e[t]=-1),++e[t]}},218:(t,s,i)=>{"use strict";i.d(s,{n:()=>a});var e=i(4486),n=i(133),r=i(4670);const h=Object.create(null),o=class t extends e.A{constructor(s={}){super(),this._="textureSampler",this.O=0,this.U=1,this.destroyed=!1,s={...t.defaultOptions,...s},this.addressMode=s.addressMode,this.addressModeU=s.addressModeU??this.addressModeU,this.addressModeV=s.addressModeV??this.addressModeV,this.addressModeW=s.addressModeW??this.addressModeW,this.scaleMode=s.scaleMode,this.magFilter=s.magFilter??this.magFilter,this.minFilter=s.minFilter??this.minFilter,this.mipmapFilter=s.mipmapFilter??this.mipmapFilter,this.lodMinClamp=s.lodMinClamp,this.lodMaxClamp=s.lodMaxClamp,this.compare=s.compare,this.maxAnisotropy=s.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){(0,r.t6)(r.lj,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this.U=Math.min(t,16),this.U>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this.U}get D(){return this.H||this.tt()}update(){this.emit("change",this),this.H=null}tt(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this.U}`;return this.H=function(t){const s=h[t];return void 0===s&&(h[t]=(0,n.L)("resource")),s}(t),this.D}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};o.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let a=o},228:t=>{"use strict";var s=Object.prototype.hasOwnProperty,i="~";function e(){}function n(t,s,i){this.fn=t,this.context=s,this.once=i||!1}function r(t,s,e,r,h){if("function"!=typeof e)throw new TypeError("The listener must be a function");var o=new n(e,r||t,h),a=i?i+s:s;return t.st[a]?t.st[a].fn?t.st[a]=[t.st[a],o]:t.st[a].push(o):(t.st[a]=o,t.it++),t}function h(t,s){0===--t.it?t.st=new e:delete t.st[s]}function o(){this.st=new e,this.it=0}Object.create&&(e.prototype=Object.create(null),(new e).__proto__||(i=!1)),o.prototype.eventNames=function(){var t,e,n=[];if(0===this.it)return n;for(e in t=this.st)s.call(t,e)&&n.push(i?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},o.prototype.listeners=function(t){var s=i?i+t:t,e=this.st[s];if(!e)return[];if(e.fn)return[e.fn];for(var n=0,r=e.length,h=new Array(r);n<r;n++)h[n]=e[n].fn;return h},o.prototype.listenerCount=function(t){var s=i?i+t:t,e=this.st[s];return e?e.fn?1:e.length:0},o.prototype.emit=function(t,s,e,n,r,h){var o=i?i+t:t;if(!this.st[o])return!1;var a,c,l=this.st[o],u=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),u){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,s),!0;case 3:return l.fn.call(l.context,s,e),!0;case 4:return l.fn.call(l.context,s,e,n),!0;case 5:return l.fn.call(l.context,s,e,n,r),!0;case 6:return l.fn.call(l.context,s,e,n,r,h),!0}for(c=1,a=new Array(u-1);c<u;c++)a[c-1]=arguments[c];l.fn.apply(l.context,a)}else{var d,f=l.length;for(c=0;c<f;c++)switch(l[c].once&&this.removeListener(t,l[c].fn,void 0,!0),u){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,s);break;case 3:l[c].fn.call(l[c].context,s,e);break;case 4:l[c].fn.call(l[c].context,s,e,n);break;default:if(!a)for(d=1,a=new Array(u-1);d<u;d++)a[d-1]=arguments[d];l[c].fn.apply(l[c].context,a)}}return!0},o.prototype.on=function(t,s,i){return r(this,t,s,i,!1)},o.prototype.once=function(t,s,i){return r(this,t,s,i,!0)},o.prototype.removeListener=function(t,s,e,n){var r=i?i+t:t;if(!this.st[r])return this;if(!s)return h(this,r),this;var o=this.st[r];if(o.fn)o.fn!==s||n&&!o.once||e&&o.context!==e||h(this,r);else{for(var a=0,c=[],l=o.length;a<l;a++)(o[a].fn!==s||n&&!o[a].once||e&&o[a].context!==e)&&c.push(o[a]);c.length?this.st[r]=1===c.length?c[0]:c:h(this,r)}return this},o.prototype.removeAllListeners=function(t){var s;return t?(s=i?i+t:t,this.st[s]&&h(this,s)):(this.st=new e,this.it=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,t.exports=o},268:(t,s,i)=>{"use strict";i.d(s,{R:()=>r});let e=0;const n=500;function r(...t){e!==n&&(e++,e===n?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...t))}},341:(t,s,i)=>{"use strict";i.d(s,{w:()=>h});var e=i(3513),n=i(5589);const r={};function h(t,s,i){let h=2166136261;for(let i=0;i<s;i++)h^=t[i].uid,h=Math.imul(h,16777619),h>>>=0;return r[h]||function(t,s,i,h){const o={};let a=0;for(let i=0;i<h;i++){const e=i<s?t[i]:n.g.EMPTY.source;o[a++]=e.source,o[a++]=e.style}const c=new e.T(o);return r[i]=c,c}(t,s,h,i)}},583:(t,s,i)=>{"use strict";i.d(s,{v:()=>c});var e=i(4486),n=i(9939),r=i(2698),h=i(133),o=i(218);const a=class t extends e.A{constructor(s={}){super(),this.options=s,this.uid=(0,h.L)("textureSource"),this._="textureSource",this.D=(0,h.L)("resource"),this.uploadMethodId="unknown",this.et=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this.O=0,this.nt=-1,this.rt=-1,s={...t.defaultOptions,...s},this.label=s.label??"",this.resource=s.resource,this.autoGarbageCollect=s.autoGarbageCollect,this.et=s.resolution,s.width?this.pixelWidth=s.width*this.et:this.pixelWidth=this.resource?this.resourceWidth??1:1,s.height?this.pixelHeight=s.height*this.et:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this.et,this.height=this.pixelHeight/this.et,this.format=s.format,this.dimension=s.dimensions,this.mipLevelCount=s.mipLevelCount,this.autoGenerateMipmaps=s.autoGenerateMipmaps,this.sampleCount=s.sampleCount,this.antialias=s.antialias,this.alphaMode=s.alphaMode,this.style=new o.n((0,r.S)(s)),this.destroyed=!1,this.ht()}get source(){return this}get style(){return this.ot}set style(t){this.style!==t&&(this.ot?.off("change",this.ct,this),this.ot=t,this.ot?.on("change",this.ct,this),this.ct())}set maxAnisotropy(t){this.ot.maxAnisotropy=t}get maxAnisotropy(){return this.ot.maxAnisotropy}get addressMode(){return this.ot.addressMode}set addressMode(t){this.ot.addressMode=t}get repeatMode(){return this.ot.addressMode}set repeatMode(t){this.ot.addressMode=t}get magFilter(){return this.ot.magFilter}set magFilter(t){this.ot.magFilter=t}get minFilter(){return this.ot.minFilter}set minFilter(t){this.ot.minFilter=t}get mipmapFilter(){return this.ot.mipmapFilter}set mipmapFilter(t){this.ot.mipmapFilter=t}get lodMinClamp(){return this.ot.lodMinClamp}set lodMinClamp(t){this.ot.lodMinClamp=t}get lodMaxClamp(){return this.ot.lodMaxClamp}set lodMaxClamp(t){this.ot.lodMaxClamp=t}ct(){this.emit("styleChange",this)}update(){if(this.resource){const t=this.et;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.ot&&(this.ot.destroy(),this.ot=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this.D=(0,h.L)("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this.et}set resolution(t){this.et!==t&&(this.et=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,s,i){i||(i=this.et),t||(t=this.width),s||(s=this.height);const e=Math.round(t*i),n=Math.round(s*i);return this.width=e/i,this.height=n/i,this.et=i,(this.pixelWidth!==e||this.pixelHeight!==n)&&(this.ht(),this.pixelWidth=e,this.pixelHeight=n,this.emit("resize",this),this.D=(0,h.L)("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this.ot.wrapMode=t}get wrapMode(){return this.ot.wrapMode}set scaleMode(t){this.ot.scaleMode=t}get scaleMode(){return this.ot.scaleMode}ht(){this.isPowerOfTwo=(0,n.f3)(this.pixelWidth)&&(0,n.f3)(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};a.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let c=a},753:(t,s,i)=>{"use strict";i.d(s,{j:()=>r});var e=i(4676);const n=16777215;function r(t,s){return t===n?s:s===n?t:(0,e.u)(t,s)}},800:(t,s,i)=>{"use strict";i.d(s,{k:()=>m});var e=i(2577),n=i(8507);const r=[];n.XO.handleByNamedList(n.Ag.Environment,r);var h=i(7457),o=i(4577),a=i(133),c=i(4670),l=i(6083),u=i(1257),d=i(7729),f=i(4486);const p=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],g=class t extends f.A{constructor(t){super(),this.uid=(0,a.L)("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this.lt={},this.ut=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const s=[...p,...this.config.runners??[]];this.dt(...s),this.ft()}async init(s={}){const i=!0===s.skipExtensionImports||!1===s.manageImports;await async function(t){if(!t)for(let t=0;t<r.length;t++){const s=r[t];if(s.value.test())return void await s.value.load()}}(i),this.gt(this.config.systems),this.yt(this.config.renderPipes,this.config.renderPipeAdaptors);for(const t in this.ut)s={...this.ut[t].constructor.defaultOptions,...s};s={...t.defaultOptions,...s},this.bt=s.roundPixels?1:0;for(let t=0;t<this.runners.init.items.length;t++)await this.runners.init.items[t].init(s);this.lt=s}render(t,s){let i=t;if(i instanceof h.mc&&(i={container:i},s&&((0,c.t6)(c.lj,"passing a second argument is deprecated, please use render options instead"),i.target=s.renderTexture)),i.target||(i.target=this.view.renderTarget),i.target===this.view.renderTarget&&(this.wt=i.container,i.clearColor??(i.clearColor=this.background.colorRgba),i.clear??(i.clear=this.background.clearBeforeRender)),i.clearColor){const t=Array.isArray(i.clearColor)&&4===i.clearColor.length;i.clearColor=t?i.clearColor:e.Q.shared.setValue(i.clearColor).toArray()}i.transform||(i.container.updateLocalTransform(),i.transform=i.container.localTransform),i.container.visible&&(i.container.enableRenderGroup(),this.runners.prerender.emit(i),this.runners.renderStart.emit(i),this.runners.render.emit(i),this.runners.renderEnd.emit(i),this.runners.postrender.emit(i))}resize(t,s,i){const e=this.view.resolution;this.view.resize(t,s,i),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),void 0!==i&&i!==e&&this.runners.resolutionChange.emit(i)}clear(t={}){t.target||(t.target=this.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=u.u.ALL);const{clear:s,clearColor:i,target:n}=t;e.Q.shared.setValue(i??this.background.colorRgba),this.renderTarget.clear(n,s,e.Q.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this.wt}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}dt(...t){t.forEach(t=>{this.runners[t]=new d.C(t)})}gt(t){let s;for(s in t){const i=t[s];this.vt(i.value,i.name)}}vt(t,s){const i=new t(this);if(this[s])throw new Error(`Whoops! The name "${s}" is already in use`);this[s]=i,this.ut[s]=i;for(const t in this.runners)this.runners[t].add(i);return this}yt(t,s){const i=s.reduce((t,s)=>(t[s.name]=s.value,t),{});t.forEach(t=>{const s=t.value,e=t.name,n=i[e];this.renderPipes[e]=new s(this,n?new n:null),this.runners.destroy.add(this.renderPipes[e])})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),Object.values(this.runners).forEach(t=>{t.destroy()}),(!0===t||"object"==typeof t&&t.releaseGlobalResources)&&l.L.release(),this.ut=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this.bt}ft(){if(!(0,o.f)())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};g.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let m=g},848:(t,s,i)=>{"use strict";i.d(s,{L:()=>n});var e=i(133);class n{constructor(){this.uid=(0,e.L)("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}destroy(){this.instructions.length=0,this.renderables.length=0,this.renderPipes=null,this.gcTick=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}},949:(t,s,i)=>{"use strict";i.d(s,{h:()=>h});var e=i(4486),n=i(133),r=i(1132);class h extends e.A{constructor(t){let{data:s,size:i}=t;const{usage:e,label:r,shrinkToFit:h}=t;super(),this.uid=(0,n.L)("buffer"),this._="buffer",this.D=(0,n.L)("resource"),this.O=0,this.xt=1,this.At=null,this.shrinkToFit=!0,this.destroyed=!1,s instanceof Array&&(s=new Float32Array(s)),this.Mt=s,i??(i=s?.byteLength);const o=!!s;this.descriptor={size:i,usage:e,mappedAtCreation:o,label:r},this.shrinkToFit=h??!0}get data(){return this.Mt}set data(t){this.setDataWithSize(t,t.length,!0)}get dataInt32(){return this.At||(this.At=new Int32Array(this.data.buffer)),this.At}get static(){return!!(this.descriptor.usage&r.S.STATIC)}set static(t){t?this.descriptor.usage|=r.S.STATIC:this.descriptor.usage&=~r.S.STATIC}setDataWithSize(t,s,i){if(this.xt++,this.kt=s*t.BYTES_PER_ELEMENT,this.Mt===t)return void(i&&this.emit("update",this));const e=this.Mt;this.Mt=t,this.At=null,e&&e.length===t.length||!this.shrinkToFit&&e&&t.byteLength<e.byteLength?i&&this.emit("update",this):(this.descriptor.size=t.byteLength,this.D=(0,n.L)("resource"),this.emit("change",this))}update(t){this.kt=t??this.kt,this.xt++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.Mt=null,this.descriptor=null,this.removeAllListeners()}}},990:(t,s,i)=>{"use strict";i.d(s,{T:()=>d,w:()=>u});var e=i(2577),n=i(5589),r=i(7276),h=i(2806);function o(t){return t instanceof h.m}function a(t){return t instanceof r.St}function c(t,s,i){return t.fill=s,t.color=16777215,t.texture=s.texture,t.matrix=s.transform,{...i,...t}}function l(t,s,i){return s.buildGradient(),t.fill=s,t.color=16777215,t.texture=s.texture,t.matrix=s.transform,t.textureSpace=s.textureSpace,{...i,...t}}function u(t,s){if(null==t)return null;const i={},r=t;return function(t){return e.Q.isColorLike(t)}(t)?function(t,s,i){const r=e.Q.shared.setValue(s??0);return t.color=r.toNumber(),t.alpha=1===r.alpha?i.alpha:r.alpha,t.texture=n.g.WHITE,{...i,...t}}(i,t,s):function(t){return t instanceof n.g}(t)?function(t,s,i){return t.texture=s,{...i,...t}}(i,t,s):o(t)?c(i,t,s):a(t)?l(i,t,s):r.fill&&o(r.fill)?c(r,r.fill,s):r.fill&&a(r.fill)?l(r,r.fill,s):function(t,s){const i={...s,...t},n=e.Q.shared.setValue(i.color);return i.alpha*=n.alpha,i.color=n.toNumber(),i}(r,s)}function d(t,s){const{width:i,alignment:e,miterLimit:n,cap:r,join:h,pixelLine:o,...a}=s,c=u(t,a);return c?{width:i,alignment:e,miterLimit:n,cap:r,join:h,pixelLine:o,...c}:null}},1132:(t,s,i)=>{"use strict";i.d(s,{S:()=>e});var e=(t=>(t[t.MAP_READ=1]="MAP_READ",t[t.MAP_WRITE=2]="MAP_WRITE",t[t.COPY_SRC=4]="COPY_SRC",t[t.COPY_DST=8]="COPY_DST",t[t.INDEX=16]="INDEX",t[t.VERTEX=32]="VERTEX",t[t.UNIFORM=64]="UNIFORM",t[t.STORAGE=128]="STORAGE",t[t.INDIRECT=256]="INDIRECT",t[t.QUERY_RESOLVE=512]="QUERY_RESOLVE",t[t.STATIC=1024]="STATIC",t))(e||{})},1173:(t,s,i)=>{"use strict";i.d(s,{x:()=>c});var e=i(268),n=i(2927),r=i(2406);function h(t,s,i,e,n){const r=s[i];for(let o=0;o<r.length;o++){const a=r[o];i<s.length-1?h(t.replace(e[i],a),s,i+1,e,n):n.push(t.replace(e[i],a))}}function o(t){const s=t.match(/\{(.*?)\}/g),i=[];if(s){const e=[];s.forEach(t=>{const s=t.substring(1,t.length-1).split(",");e.push(s)}),h(t,e,0,s,i)}else i.push(t);return i}var a=i(2217);class c{constructor(){this.Ct={connector:"-",createBundleAssetId:(t,s)=>`${t}${this.Tt}${s}`,extractAssetIdFromBundle:(t,s)=>s.replace(`${t}${this.Tt}`,"")},this.Tt=this.Ct.connector,this.$t=this.Ct.createBundleAssetId,this.Pt=this.Ct.extractAssetIdFromBundle,this.It={},this.Et=[],this.Bt=[],this.Rt={},this.zt={}}setBundleIdentifier(t){if(this.Tt=t.connector??this.Tt,this.$t=t.createBundleAssetId??this.$t,this.Pt=t.extractAssetIdFromBundle??this.Pt,"bar"!==this.Pt("foo",this.$t("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(t=>{this.Et.push(t),t.priority||(t.priority=Object.keys(t.params))}),this.Rt={}}set basePath(t){this.Gt=t}get basePath(){return this.Gt}set rootPath(t){this.Ft=t}get rootPath(){return this.Ft}get parsers(){return this.Bt}reset(){this.setBundleIdentifier(this.Ct),this.It={},this.Et=[],this.Rt={},this.Ft=null,this.Gt=null,this.jt=null,this.zt={},this._t=null}setDefaultSearchParams(t){if("string"==typeof t)this._t=t;else{const s=t;this._t=Object.keys(s).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(s[t])}`).join("&")}}getAlias(t){const{alias:s,src:i}=t;return(0,r.z)(s||i,t=>"string"==typeof t?t:Array.isArray(t)?t.map(t=>t?.src??t):t?.src?t.src:t,!0)}addManifest(t){this.jt&&(0,e.R)("[Resolver] Manifest already exists, this will be overwritten"),this.jt=t,t.bundles.forEach(t=>{this.addBundle(t.name,t.assets)})}addBundle(t,s){const i=[];let e=s;Array.isArray(s)||(e=Object.entries(s).map(([t,s])=>"string"==typeof s||Array.isArray(s)?{alias:t,src:s}:{alias:t,...s})),e.forEach(s=>{const e=s.src,n=s.alias;let r;if("string"==typeof n){const s=this.$t(t,n);i.push(s),r=[n,s]}else{const s=n.map(s=>this.$t(t,s));i.push(...s),r=[...n,...s]}this.add({...s,alias:r,src:e})}),this.zt[t]=i}add(t){const s=[];let i;Array.isArray(t)?s.push(...t):s.push(t),i=t=>{this.hasKey(t)&&(0,e.R)(`[Resolver] already has key: ${t} overwriting`)},(0,r.z)(s).forEach(t=>{const{src:s}=t;let{data:e,format:n,loadParser:h,parser:a}=t;const c=(0,r.z)(s).map(t=>"string"==typeof t?o(t):Array.isArray(t)?t:[t]),l=this.getAlias(t);Array.isArray(l)?l.forEach(i):i(l);const u=[];c.forEach(s=>{s.forEach(s=>{let i={};if("object"!=typeof s){i.src=s;for(let t=0;t<this.Bt.length;t++){const e=this.Bt[t];if(e.test(s)){i=e.parse(s);break}}}else e=s.data??e,n=s.format??n,(s.loadParser||s.parser)&&(h=s.loadParser??h,a=s.parser??a),i={...i,...s};if(!l)throw new Error(`[Resolver] alias is undefined for this asset: ${i.src}`);i=this.Ot(i,{aliases:l,data:e,format:n,loadParser:h,parser:a,progressSize:t.progressSize}),u.push(i)})}),l.forEach(t=>{this.It[t]=u})})}resolveBundle(t){const s=(0,a.a)(t);t=(0,r.z)(t);const i={};return t.forEach(t=>{const s=this.zt[t];if(s){const e=this.resolve(s),n={};for(const s in e){const i=e[s];n[this.Pt(t,s)]=i}i[t]=n}}),s?i[t[0]]:i}resolveUrl(t){const s=this.resolve(t);if("string"!=typeof t){const t={};for(const i in s)t[i]=s[i].src;return t}return s.src}resolve(t){const s=(0,a.a)(t);t=(0,r.z)(t);const i={};return t.forEach(t=>{if(!this.Rt[t])if(this.It[t]){let s=this.It[t];const i=this.Ut(s);i?.priority.forEach(t=>{i.params[t].forEach(i=>{const e=s.filter(s=>!!s[t]&&s[t]===i);e.length&&(s=e)})}),this.Rt[t]=s[0]}else this.Rt[t]=this.Ot({alias:[t],src:t},{});i[t]=this.Rt[t]}),s?i[t[0]]:i}hasKey(t){return!!this.It[t]}hasBundle(t){return!!this.zt[t]}Ut(t){for(let s=0;s<t.length;s++){const i=t[s],e=this.Et.find(t=>t.params.format.includes(i.format));if(e)return e}return this.Et[0]}Dt(t){return this._t?`${t}${/\?/.test(t)?"&":"?"}${this._t}`:t}Ot(t,s){const{aliases:i,data:e,loadParser:r,parser:h,format:o,progressSize:a}=s;return(this.Gt||this.Ft)&&(t.src=n.A.toAbsolute(t.src,this.Gt,this.Ft)),t.alias=i??t.alias??[t.src],t.src=this.Dt(t.src),t.data={...e||{},...t.data},t.loadParser=r??t.loadParser,t.parser=h??t.parser,t.format=o??t.format??t.src.split(".").pop().split("?").shift().split("#").shift(),void 0!==a&&(t.progressSize=a),t}}c.RETINA_PREFIX=/@([0-9\.]+)x/},1196:(t,s,i)=>{"use strict";i.d(s,{N:()=>r});var e=i(9313);const n=new e.u;class r{constructor(t,s){this.mapCoord=new e.u,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this.Wt=-1,this.xt=0,this.clampOffset=0,this.clampMargin=void 0===s?t.width<10?0:.5:s,this.isSimple=!1,this.texture=t}get texture(){return this.Nt}set texture(t){this.texture!==t&&(this.Nt?.removeListener("update",this.update,this),this.Nt=t,this.Nt.addListener("update",this.update,this),this.update())}multiplyUvs(t,s){void 0===s&&(s=t);const i=this.mapCoord;for(let e=0;e<t.length;e+=2){const n=t[e],r=t[e+1];s[e]=n*i.a+r*i.c+i.tx,s[e+1]=n*i.b+r*i.d+i.ty}return s}update(){const t=this.Nt;this.xt++;const s=t.uvs;this.mapCoord.set(s.x1-s.x0,s.y1-s.y0,s.x3-s.x0,s.y3-s.y0,s.x0,s.y0);const i=t.orig,e=t.trim;e&&(n.set(i.width/e.width,0,0,i.height/e.height,-e.x/e.width,-e.y/e.height),this.mapCoord.append(n));const r=t.source,h=this.uClampFrame,o=this.clampMargin/r.et,a=this.clampOffset/r.et;return h[0]=(t.frame.x+o+a)/r.width,h[1]=(t.frame.y+o+a)/r.height,h[2]=(t.frame.x+t.frame.width-o+a)/r.width,h[3]=(t.frame.y+t.frame.height-o+a)/r.height,this.uClampOffset[0]=this.clampOffset/r.pixelWidth,this.uClampOffset[1]=this.clampOffset/r.pixelHeight,this.isSimple=t.frame.width===r.width&&t.frame.height===r.height&&0===t.rotate,!0}}},1242:(t,s,i)=>{"use strict";i.d(s,{Z:()=>n});const e=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function n(t){const s="number"==typeof t.fontSize?`${t.fontSize}px`:t.fontSize;let i=t.fontFamily;Array.isArray(t.fontFamily)||(i=t.fontFamily.split(","));for(let t=i.length-1;t>=0;t--){let s=i[t].trim();/([\"\'])[^\'\"]+\1/.test(s)||e.includes(s)||(s=`"${s}"`),i[t]=s}return`${t.fontStyle} ${t.fontVariant} ${t.fontWeight} ${s} ${i.join(",")}`}},1257:(t,s,i)=>{"use strict";i.d(s,{u:()=>e});var e=(t=>(t[t.NONE=0]="NONE",t[t.COLOR=16384]="COLOR",t[t.STENCIL=1024]="STENCIL",t[t.DEPTH=256]="DEPTH",t[t.COLOR_DEPTH=16640]="COLOR_DEPTH",t[t.COLOR_STENCIL=17408]="COLOR_STENCIL",t[t.DEPTH_STENCIL=1280]="DEPTH_STENCIL",t[t.ALL=17664]="ALL",t))(e||{})},1312:(t,s,i)=>{"use strict";i.d(s,{c:()=>A});var e=i(5957),n=i(1979),r=i(4670),h=i(268),o=i(4016),a=i(8291),c=i(2577),l=i(9252),u=i(7608),d=i(8293),f=i(5589),p=i(218),g=i(1242),m=i(3548),y=i(1849);const b=class t extends y.v{constructor(s){super(),this.resolution=1,this.pages=[],this.Vt=0,this.Lt=Object.create(null),this.Ht=[],this.qt=0,this.Yt=0,this.Xt=0,this.Qt=-1,this.Zt=!1;const i={...t.defaultOptions,...s};this.Kt=i.textureSize,this.Jt=i.mipmap;const e=i.style.clone();i.overrideFill&&(e.ts.color=16777215,e.ts.alpha=1,e.ts.texture=f.g.WHITE,e.ts.fill=null),this.applyFillAsTint=i.overrideFill;const n=e.fontSize;e.fontSize=this.baseMeasurementFontSize;const r=(0,g.Z)(e);i.overrideSize?e.ss&&(e.ss.width*=this.baseRenderedFontSize/n):e.fontSize=this.baseRenderedFontSize=n,this.ot=e,this.Zt=i.skipKerning??!1,this.resolution=i.resolution??1,this.Vt=i.padding??4,i.textureStyle&&(this.es=i.textureStyle instanceof p.n?i.textureStyle:new p.n(i.textureStyle)),this.fontMetrics=o.P.measureFont(r),this.lineHeight=e.lineHeight||this.fontMetrics.fontSize||e.fontSize}ensureCharacters(t){const s=o.P.graphemeSegmenter(t).filter(t=>!this.Ht.includes(t)).filter((t,s,i)=>i.indexOf(t)===s);if(!s.length)return;let i;this.Ht=[...this.Ht,...s],i=-1===this.Qt?this.ns():this.pages[this.Qt];let{canvas:e,context:n}=i.canvasAndContext,r=i.texture.source;const h=this.ot;let a=this.qt,c=this.Yt,u=this.Xt;const d=this.baseRenderedFontSize/this.baseMeasurementFontSize,p=this.Vt*d;let g=!1;const m=e.width/this.resolution,y=e.height/this.resolution;for(let t=0;t<s.length;t++){const i=s[t],b=o.P.measureText(i,h,e,!1);b.lineHeight=b.height;const w=b.width*d,v=Math.ceil(("italic"===h.fontStyle?2:1)*w)+2*p,x=b.height*d+2*p;if(g=!1,"\n"!==i&&"\r"!==i&&"\t"!==i&&" "!==i&&(g=!0,u=Math.ceil(Math.max(x,u))),a+v>m&&(c+=u,u=x,a=0,c+u>y)){r.update();const t=this.ns();e=t.canvasAndContext.canvas,n=t.canvasAndContext.context,r=t.texture.source,a=0,c=0,u=0}const A=w/d-(h.dropShadow?.distance??0)-(h.ss?.width??0);if(this.chars[i]={id:i.codePointAt(0),xOffset:-this.Vt,yOffset:-this.Vt,xAdvance:A,kerning:{}},g){this.rs(n,b,a+p,c+p,d,h);const t=r.width*d,s=r.height*d,e=new l.M(a/t*r.width,c/s*r.height,v/t*r.width,x/s*r.height);this.chars[i].texture=new f.g({source:r,frame:e}),a+=Math.ceil(v)}}r.update(),this.qt=a,this.Yt=c,this.Xt=u,this.Zt&&this.hs(s,n)}get pageTextures(){return(0,r.t6)(r.lj,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}hs(t,s){const i=this.Lt;for(let e=0;e<t.length;e++){const n=t[e];for(let t=0;t<this.Ht.length;t++){const e=this.Ht[t];let r=i[n];r||(r=i[n]=s.measureText(n).width);let h=i[e];h||(h=i[e]=s.measureText(e).width);let o=s.measureText(n+e).width,a=o-(r+h);a&&(this.chars[n].kerning[e]=a),o=s.measureText(n+e).width,a=o-(r+h),a&&(this.chars[e].kerning[n]=a)}}}ns(){this.Qt++;const t=this.resolution,s=u.N.getOptimalCanvasAndContext(this.Kt,this.Kt,t);this.cs(s.context,this.ot,t);const i=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),e=new f.g({source:new d.b({resource:s.canvas,resolution:i,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this.Jt})});this.es&&(e.source.style=this.es);const n={canvasAndContext:s,texture:e};return this.pages[this.Qt]=n,n}cs(t,s,i){s.fontSize=this.baseRenderedFontSize,t.scale(i,i),t.font=(0,g.Z)(s),s.fontSize=this.baseMeasurementFontSize,t.textBaseline=s.textBaseline;const e=s.ss,n=e?.width??0;if(e&&(t.lineWidth=n,t.lineJoin=e.join,t.miterLimit=e.miterLimit,t.strokeStyle=(0,m.r)(e,t)),s.ts&&(t.fillStyle=(0,m.r)(s.ts,t)),s.dropShadow){const e=s.dropShadow,n=c.Q.shared.setValue(e.color).toArray(),r=e.blur*i,h=e.distance*i;t.shadowColor=`rgba(${255*n[0]},${255*n[1]},${255*n[2]},${e.alpha})`,t.shadowBlur=r,t.shadowOffsetX=Math.cos(e.angle)*h,t.shadowOffsetY=Math.sin(e.angle)*h}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}rs(t,s,i,e,n,r){const h=s.text,o=s.fontProperties,a=r.ss,c=(a?.width??0)*n,l=i+c/2,u=e-c/2,d=o.descent*n,f=s.lineHeight*n;let p=!1;r.stroke&&c&&(p=!0,t.strokeText(h,l,u+f-d));const{shadowBlur:g,shadowOffsetX:m,shadowOffsetY:y}=t;r.ts&&(p&&(t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),t.fillText(h,l,u+f-d)),p&&(t.shadowBlur=g,t.shadowOffsetX=m,t.shadowOffsetY=y)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{canvasAndContext:s,texture:i}=this.pages[t];u.N.returnCanvasAndContext(s),i.destroy(!0)}this.pages=null}};b.defaultOptions={textureSize:512,style:new a.x,mipmap:!0};let w=b;var v=i(2763);let x=0;const A=new class{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null},this.measureCache=(0,e.g)(1e3)}getFont(t,s){let i=`${s.fontFamily}-bitmap`,e=!0;if(s.ts.fill&&!s.ss?(i+=s.ts.fill.styleKey,e=!1):(s.ss||s.dropShadow)&&(i=`${s.styleKey}-bitmap`,e=!1),!n.l.has(i)){const t=Object.create(s);t.lineHeight=0;const r=new w({style:t,overrideFill:e,overrideSize:!0,...this.defaultOptions});x++,x>50&&(0,h.R)("BitmapText",`You have dynamically created ${x} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),r.once("destroy",()=>{x--,n.l.remove(i)}),n.l.set(i,r)}const r=n.l.get(i);return r.ensureCharacters?.(t),r}getLayout(t,s,i=!0){const e=this.getFont(t,s),n=`${t}-${s.styleKey}-${i}`;if(this.measureCache.has(n))return this.measureCache.get(n);const r=o.P.graphemeSegmenter(t),h=(0,v.Z)(r,s,e,i);return this.measureCache.set(n,h),h}measureText(t,s,i=!0){return this.getLayout(t,s,i)}install(...t){let s=t[0];"string"==typeof s&&(s={name:s,style:t[1],chars:t[2]?.chars,resolution:t[2]?.resolution,padding:t[2]?.padding,skipKerning:t[2]?.skipKerning},(0,r.t6)(r.lj,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const i=s?.name;if(!i)throw new Error("[BitmapFontManager] Property `name` is required.");s={...this.defaultOptions,...s};const e=s.style,h=e instanceof a.x?e:new a.x(e),o=s.dynamicFill??this.ls(h),c=new w({style:h,overrideFill:o,skipKerning:s.skipKerning,padding:s.padding,resolution:s.resolution,overrideSize:!1,textureStyle:s.textureStyle}),l=function(t){if(""===t)return[];"string"==typeof t&&(t=[t]);const s=[];for(let i=0,e=t.length;i<e;i++){const e=t[i];if(Array.isArray(e)){if(2!==e.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${e.length}.`);if(0===e[0].length||0===e[1].length)throw new Error("[BitmapFont]: Invalid character delimiter.");const t=e[0].charCodeAt(0),i=e[1].charCodeAt(0);if(i<t)throw new Error("[BitmapFont]: Invalid character range.");for(let e=t,n=i;e<=n;e++)s.push(String.fromCharCode(e))}else s.push(...Array.from(e))}if(0===s.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return s}(s.chars);return c.ensureCharacters(l.join("")),n.l.set(`${i}-bitmap`,c),c.once("destroy",()=>n.l.remove(`${i}-bitmap`)),c}uninstall(t){const s=`${t}-bitmap`,i=n.l.get(s);i&&i.destroy()}ls(t){return!(t.ss||t.dropShadow&&0!==t.dropShadow.color||t.ts.fill||16777215!==t.ts.color)}}},1460:(t,s,i)=>{"use strict";i.d(s,{u:()=>e});class e{constructor(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this.us||(this.us=new Int8Array(this.rawBinaryData)),this.us}get uint8View(){return this.ds||(this.ds=new Uint8Array(this.rawBinaryData)),this.ds}get int16View(){return this.fs||(this.fs=new Int16Array(this.rawBinaryData)),this.fs}get int32View(){return this.ps||(this.ps=new Int32Array(this.rawBinaryData)),this.ps}get float64View(){return this.gs||(this.gs=new Float64Array(this.rawBinaryData)),this.gs}get bigUint64View(){return this.ys||(this.ys=new BigUint64Array(this.rawBinaryData)),this.ys}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this.us=null,this.ds=null,this.fs=null,this.uint16View=null,this.ps=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}},1652:(t,s,i)=>{"use strict";i.d(s,{TO:()=>e,Td:()=>r,bO:()=>n});const e=2*Math.PI,n=180/Math.PI,r=Math.PI/180},1761:(t,s,i)=>{"use strict";i.d(s,{e:()=>n});let e={createCanvas:(t,s)=>{const i=document.createElement("canvas");return i.width=t,i.height=s,i},createImage:()=>new Image,getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,s)=>fetch(t,s),parseXML:t=>(new DOMParser).parseFromString(t,"text/xml")};const n={get:()=>e,set(t){e=t}}},1849:(t,s,i)=>{"use strict";i.d(s,{v:()=>r});var e=i(4486),n=i(4670);class r extends e.A{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return(0,n.t6)(n.lj,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return(0,n.t6)(n.lj,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return(0,n.t6)(n.lj,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return(0,n.t6)(n.lj,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return(0,n.t6)(n.lj,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners();for(const t in this.chars)this.chars[t].texture?.destroy();this.chars=null,t&&(this.pages.forEach(t=>t.texture.destroy(!0)),this.pages=null)}}},1957:(t,s,i)=>{"use strict";i.d(s,{K:()=>n,Q:()=>e});const e={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var n=(t=>(t[t.DISABLED=0]="DISABLED",t[t.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",t[t.MASK_ACTIVE=2]="MASK_ACTIVE",t[t.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",t[t.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",t[t.NONE=5]="NONE",t))(n||{})},1979:(t,s,i)=>{"use strict";i.d(s,{l:()=>r});var e=i(268),n=i(2406);const r=new class{constructor(){this.Bt=[],this.bs=new Map,this.ws=new Map}reset(){this.ws.clear(),this.bs.clear()}has(t){return this.bs.has(t)}get(t){const s=this.bs.get(t);return s||(0,e.R)(`[Assets] Asset id ${t} was not found in the Cache`),s}set(t,s){const i=(0,n.z)(t);let r;for(let t=0;t<this.parsers.length;t++){const e=this.parsers[t];if(e.test(s)){r=e.getCacheableAssets(i,s);break}}const h=new Map(Object.entries(r||{}));r||i.forEach(t=>{h.set(t,s)});const o=[...h.keys()],a={cacheKeys:o,keys:i};i.forEach(t=>{this.ws.set(t,a)}),o.forEach(t=>{const i=r?r[t]:s;this.bs.has(t)&&this.bs.get(t)!==i&&(0,e.R)("[Cache] already has key:",t),this.bs.set(t,h.get(t))})}remove(t){if(!this.ws.has(t))return void(0,e.R)(`[Assets] Asset id ${t} was not found in the Cache`);const s=this.ws.get(t);s.cacheKeys.forEach(t=>{this.bs.delete(t)}),s.keys.forEach(t=>{this.ws.delete(t)})}get parsers(){return this.Bt}}},2048:(t,s,i)=>{"use strict";function e(t,s,i){const{width:e,height:n}=i.orig,r=i.trim;if(r){const i=r.width,h=r.height;t.minX=r.x-s.vs*e,t.maxX=t.minX+i,t.minY=r.y-s.xs*n,t.maxY=t.minY+h}else t.minX=-s.vs*e,t.maxX=t.minX+e,t.minY=-s.xs*n,t.maxY=t.minY+n}i.d(s,{y:()=>e})},2079:(t,s,i)=>{"use strict";i.d(s,{E:()=>u});var e=i(9313);const n=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],r=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],h=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],o=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],a=[],c=[],l=Math.sign;!function(){for(let t=0;t<16;t++){const s=[];a.push(s);for(let i=0;i<16;i++){const e=l(n[t]*n[i]+h[t]*r[i]),a=l(r[t]*n[i]+o[t]*r[i]),c=l(n[t]*h[i]+h[t]*o[i]),u=l(r[t]*h[i]+o[t]*o[i]);for(let t=0;t<16;t++)if(n[t]===e&&r[t]===a&&h[t]===c&&o[t]===u){s.push(t);break}}}for(let t=0;t<16;t++){const s=new e.u;s.set(n[t],r[t],h[t],o[t],0,0),c.push(s)}}();const u={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>n[t],uY:t=>r[t],vX:t=>h[t],vY:t=>o[t],inv:t=>8&t?15&t:7&-t,add:(t,s)=>a[t][s],sub:(t,s)=>a[t][u.inv(s)],rotate180:t=>4^t,isVertical:t=>2==(3&t),byDirection:(t,s)=>2*Math.abs(t)<=Math.abs(s)?s>=0?u.S:u.N:2*Math.abs(s)<=Math.abs(t)?t>0?u.E:u.W:s>0?t>0?u.SE:u.SW:t>0?u.NE:u.NW,matrixAppendRotationInv:(t,s,i=0,e=0)=>{const n=c[u.inv(s)];n.tx=i,n.ty=e,t.append(n)},transformRectCoords:(t,s,i,e)=>{const{x:n,y:r,width:h,height:o}=t,{x:a,y:c,width:l,height:d}=s;return i===u.E?(e.set(n+a,r+c,h,o),e):i===u.S?e.set(l-r-o+a,n+c,o,h):i===u.W?e.set(l-n-h+a,d-r-o+c,h,o):i===u.N?e.set(r+a,d-n-h+c,o,h):e.set(n+a,r+c,h,o)}}},2208:(t,s,i)=>{"use strict";i.d(s,{o:()=>o,u:()=>h});var e=i(9313),n=i(8655),r=i(9636);const h=n.Z.getPool(e.u),o=n.Z.getPool(r.c)},2217:(t,s,i)=>{"use strict";i.d(s,{a:()=>e});const e=t=>!Array.isArray(t)},2233:(t,s,i)=>{"use strict";i.d(s,{Y:()=>e});const e=(t,s)=>{const i=s.split("?")[1];return i&&(t+=`?${i}`),t}},2406:(t,s,i)=>{"use strict";i.d(s,{z:()=>e});const e=(t,s,i=!1)=>(Array.isArray(t)||(t=[t]),s?t.map(t=>"string"==typeof t||i?s(t):t):t)},2437:(t,s,i)=>{"use strict";i.d(s,{W:()=>c});var e=i(9939),n=i(6083),r=i(583),h=i(5589),o=i(218);let a=0;const c=new class{constructor(t){this.As=Object.create(null),this.Ms={},this.textureOptions=t||{},this.enableFullScreen=!1,this.textureStyle=new o.n(this.textureOptions)}createTexture(t,s,i){const e=new r.v({...this.textureOptions,width:t,height:s,resolution:1,antialias:i,autoGarbageCollect:!1});return new h.g({source:e,label:"texturePool_"+a++})}getOptimalTexture(t,s,i=1,n){let r=Math.ceil(t*i-1e-6),h=Math.ceil(s*i-1e-6);r=(0,e.U5)(r),h=(0,e.U5)(h);const o=(r<<17)+(h<<1)+(n?1:0);this.Ms[o]||(this.Ms[o]=[]);let a=this.Ms[o].pop();return a||(a=this.createTexture(r,h,n)),a.source.et=i,a.source.width=r/i,a.source.height=h/i,a.source.pixelWidth=r,a.source.pixelHeight=h,a.frame.x=0,a.frame.y=0,a.frame.width=t,a.frame.height=s,a.updateUvs(),this.As[a.uid]=o,a}getSameSizeTexture(t,s=!1){const i=t.source;return this.getOptimalTexture(t.width,t.height,i.et,s)}returnTexture(t,s=!1){const i=this.As[t.uid];s&&(t.source.style=this.textureStyle),this.Ms[i].push(t)}clear(t){if(t=!1!==t)for(const t in this.Ms){const s=this.Ms[t];if(s)for(let t=0;t<s.length;t++)s[t].destroy(!0)}this.Ms={}}};n.L.register(c)},2571:(t,s,i)=>{"use strict";i.d(s,{xv:()=>e}),i(4486);const e="8.14.1"},2577:(t,s,i)=>{"use strict";i.d(s,{Q:()=>E});var e={grad:.9,turn:360,rad:360/(2*Math.PI)},n=function(t){return"string"==typeof t?t.length>0:"number"==typeof t},r=function(t,s,i){return void 0===s&&(s=0),void 0===i&&(i=Math.pow(10,s)),Math.round(i*t)/i+0},h=function(t,s,i){return void 0===s&&(s=0),void 0===i&&(i=1),t>i?i:t>s?t:s},o=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},a=function(t){return{r:h(t.r,0,255),g:h(t.g,0,255),b:h(t.b,0,255),a:h(t.a)}},c=function(t){return{r:r(t.r),g:r(t.g),b:r(t.b),a:r(t.a,3)}},l=/^#([0-9a-f]{3,8})$/i,u=function(t){var s=t.toString(16);return s.length<2?"0"+s:s},d=function(t){var s=t.r,i=t.g,e=t.b,n=t.a,r=Math.max(s,i,e),h=r-Math.min(s,i,e),o=h?r===s?(i-e)/h:r===i?2+(e-s)/h:4+(s-i)/h:0;return{h:60*(o<0?o+6:o),s:r?h/r*100:0,v:r/255*100,a:n}},f=function(t){var s=t.h,i=t.s,e=t.v,n=t.a;s=s/360*6,i/=100,e/=100;var r=Math.floor(s),h=e*(1-i),o=e*(1-(s-r)*i),a=e*(1-(1-s+r)*i),c=r%6;return{r:255*[e,o,h,h,a,e][c],g:255*[a,e,e,o,h,h][c],b:255*[h,h,a,e,e,o][c],a:n}},p=function(t){return{h:o(t.h),s:h(t.s,0,100),l:h(t.l,0,100),a:h(t.a)}},g=function(t){return{h:r(t.h),s:r(t.s),l:r(t.l),a:r(t.a,3)}},m=function(t){return f((i=(s=t).s,{h:s.h,s:(i*=((e=s.l)<50?e:100-e)/100)>0?2*i/(e+i)*100:0,v:e+i,a:s.a}));var s,i,e},y=function(t){return{h:(s=d(t)).h,s:(n=(200-(i=s.s))*(e=s.v)/100)>0&&n<200?i*e/100/(n<=100?n:200-n)*100:0,l:n/2,a:s.a};var s,i,e,n},b=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,w=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,x=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,A={string:[[function(t){var s=l.exec(t);return s?(t=s[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:4===t.length?r(parseInt(t[3]+t[3],16)/255,2):1}:6===t.length||8===t.length?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:8===t.length?r(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var s=v.exec(t)||x.exec(t);return s?s[2]!==s[4]||s[4]!==s[6]?null:a({r:Number(s[1])/(s[2]?100/255:1),g:Number(s[3])/(s[4]?100/255:1),b:Number(s[5])/(s[6]?100/255:1),a:void 0===s[7]?1:Number(s[7])/(s[8]?100:1)}):null},"rgb"],[function(t){var s=b.exec(t)||w.exec(t);if(!s)return null;var i,n,r=p({h:(i=s[1],n=s[2],void 0===n&&(n="deg"),Number(i)*(e[n]||1)),s:Number(s[3]),l:Number(s[4]),a:void 0===s[5]?1:Number(s[5])/(s[6]?100:1)});return m(r)},"hsl"]],object:[[function(t){var s=t.r,i=t.g,e=t.b,r=t.a,h=void 0===r?1:r;return n(s)&&n(i)&&n(e)?a({r:Number(s),g:Number(i),b:Number(e),a:Number(h)}):null},"rgb"],[function(t){var s=t.h,i=t.s,e=t.l,r=t.a,h=void 0===r?1:r;if(!n(s)||!n(i)||!n(e))return null;var o=p({h:Number(s),s:Number(i),l:Number(e),a:Number(h)});return m(o)},"hsl"],[function(t){var s=t.h,i=t.s,e=t.v,r=t.a,a=void 0===r?1:r;if(!n(s)||!n(i)||!n(e))return null;var c=function(t){return{h:o(t.h),s:h(t.s,0,100),v:h(t.v,0,100),a:h(t.a)}}({h:Number(s),s:Number(i),v:Number(e),a:Number(a)});return f(c)},"hsv"]]},M=function(t,s){for(var i=0;i<s.length;i++){var e=s[i][0](t);if(e)return[e,s[i][1]]}return[null,void 0]},k=function(t,s){var i=y(t);return{h:i.h,s:h(i.s+100*s,0,100),l:i.l,a:i.a}},S=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},C=function(t,s){var i=y(t);return{h:i.h,s:i.s,l:h(i.l+100*s,0,100),a:i.a}},T=function(){function t(t){this.parsed=function(t){return"string"==typeof t?M(t.trim(),A.string):"object"==typeof t&&null!==t?M(t,A.object):[null,void 0]}(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return null!==this.parsed},t.prototype.brightness=function(){return r(S(this.rgba),2)},t.prototype.isDark=function(){return S(this.rgba)<.5},t.prototype.isLight=function(){return S(this.rgba)>=.5},t.prototype.toHex=function(){return s=(t=c(this.rgba)).r,i=t.g,e=t.b,h=(n=t.a)<1?u(r(255*n)):"","#"+u(s)+u(i)+u(e)+h;var t,s,i,e,n,h},t.prototype.toRgb=function(){return c(this.rgba)},t.prototype.toRgbString=function(){return s=(t=c(this.rgba)).r,i=t.g,e=t.b,(n=t.a)<1?"rgba("+s+", "+i+", "+e+", "+n+")":"rgb("+s+", "+i+", "+e+")";var t,s,i,e,n},t.prototype.toHsl=function(){return g(y(this.rgba))},t.prototype.toHslString=function(){return s=(t=g(y(this.rgba))).h,i=t.s,e=t.l,(n=t.a)<1?"hsla("+s+", "+i+"%, "+e+"%, "+n+")":"hsl("+s+", "+i+"%, "+e+"%)";var t,s,i,e,n},t.prototype.toHsv=function(){return t=d(this.rgba),{h:r(t.h),s:r(t.s),v:r(t.v),a:r(t.a,3)};var t},t.prototype.invert=function(){return $({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},t.prototype.saturate=function(t){return void 0===t&&(t=.1),$(k(this.rgba,t))},t.prototype.desaturate=function(t){return void 0===t&&(t=.1),$(k(this.rgba,-t))},t.prototype.grayscale=function(){return $(k(this.rgba,-1))},t.prototype.lighten=function(t){return void 0===t&&(t=.1),$(C(this.rgba,t))},t.prototype.darken=function(t){return void 0===t&&(t=.1),$(C(this.rgba,-t))},t.prototype.rotate=function(t){return void 0===t&&(t=15),this.hue(this.hue()+t)},t.prototype.alpha=function(t){return"number"==typeof t?$({r:(s=this.rgba).r,g:s.g,b:s.b,a:t}):r(this.rgba.a,3);var s},t.prototype.hue=function(t){var s=y(this.rgba);return"number"==typeof t?$({h:t,s:s.s,l:s.l,a:s.a}):r(s.h)},t.prototype.isEqual=function(t){return this.toHex()===$(t).toHex()},t}(),$=function(t){return t instanceof T?t:new T(t)},P=[];!function(t){t.forEach(function(t){P.indexOf(t)<0&&(t(T,A),P.push(t))})}([function(t,s){var i={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},e={};for(var n in i)e[i[n]]=n;var r={};t.prototype.toName=function(s){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var n,h,o=e[this.toHex()];if(o)return o;if(null==s?void 0:s.closest){var a=this.toRgb(),c=1/0,l="black";if(!r.length)for(var u in i)r[u]=new t(i[u]).toRgb();for(var d in i){var f=(n=a,h=r[d],Math.pow(n.r-h.r,2)+Math.pow(n.g-h.g,2)+Math.pow(n.b-h.b,2));f<c&&(c=f,l=d)}return l}},s.string.push([function(s){var e=s.toLowerCase(),n="transparent"===e?"#0000":i[e];return n?new t(n).toRgb():null},"name"])}]);const I=class t{constructor(t=16777215){this.ks=null,this.Ss=new Float32Array(4),this.Ss.fill(1),this.Cs=16777215,this.value=t}get red(){return this.Ss[0]}get green(){return this.Ss[1]}get blue(){return this.Ss[2]}get alpha(){return this.Ss[3]}setValue(t){return this.value=t,this}set value(s){if(s instanceof t)this.ks=this.Ts(s.ks),this.Cs=s.Cs,this.Ss.set(s.Ss);else{if(null===s)throw new Error("Cannot set Color#value to null");null!==this.ks&&this.$s(this.ks,s)||(this.ks=this.Ts(s),this.Ps(this.ks))}}get value(){return this.ks}Ts(t){return"string"==typeof t||"number"==typeof t||t instanceof Number||null===t?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):"object"==typeof t&&null!==t?{...t}:t}$s(t,s){const i=typeof t;if(i!==typeof s)return!1;if("number"===i||"string"===i||t instanceof Number)return t===s;if(Array.isArray(t)&&Array.isArray(s)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(s))return t.length===s.length&&t.every((t,i)=>t===s[i]);if(null!==t&&null!==s){const i=Object.keys(t),e=Object.keys(s);return i.length===e.length&&i.every(i=>t[i]===s[i])}return t===s}toRgba(){const[t,s,i,e]=this.Ss;return{r:t,g:s,b:i,a:e}}toRgb(){const[t,s,i]=this.Ss;return{r:t,g:s,b:i}}toRgbaString(){const[t,s,i]=this.toUint8RgbArray();return`rgba(${t},${s},${i},${this.alpha})`}toUint8RgbArray(t){const[s,i,e]=this.Ss;return this.Is||(this.Is=[]),t||(t=this.Is),t[0]=Math.round(255*s),t[1]=Math.round(255*i),t[2]=Math.round(255*e),t}toArray(t){this.Es||(this.Es=[]),t||(t=this.Es);const[s,i,e,n]=this.Ss;return t[0]=s,t[1]=i,t[2]=e,t[3]=n,t}toRgbArray(t){this.Is||(this.Is=[]),t||(t=this.Is);const[s,i,e]=this.Ss;return t[0]=s,t[1]=i,t[2]=e,t}toNumber(){return this.Cs}toBgrNumber(){const[t,s,i]=this.toUint8RgbArray();return(i<<16)+(s<<8)+t}toLittleEndianNumber(){const t=this.Cs;return(t>>16)+(65280&t)+((255&t)<<16)}multiply(s){const[i,e,n,r]=t.Bs.setValue(s).Ss;return this.Ss[0]*=i,this.Ss[1]*=e,this.Ss[2]*=n,this.Ss[3]*=r,this.Rs(),this.ks=null,this}premultiply(t,s=!0){return s&&(this.Ss[0]*=t,this.Ss[1]*=t,this.Ss[2]*=t),this.Ss[3]=t,this.Rs(),this.ks=null,this}toPremultiplied(t,s=!0){if(1===t)return(255<<24)+this.Cs;if(0===t)return s?0:this.Cs;let i=this.Cs>>16&255,e=this.Cs>>8&255,n=255&this.Cs;return s&&(i=i*t+.5|0,e=e*t+.5|0,n=n*t+.5|0),(255*t<<24)+(i<<16)+(e<<8)+n}toHex(){const t=this.Cs.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(255*this.Ss[3]).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this.Ss[3]=this.zs(t),this}Ps(s){let i,e,n,r;if(("number"==typeof s||s instanceof Number)&&s>=0&&s<=16777215)i=(s>>16&255)/255,e=(s>>8&255)/255,n=(255&s)/255,r=1;else if((Array.isArray(s)||s instanceof Float32Array)&&s.length>=3&&s.length<=4)s=this.zs(s),[i,e,n,r=1]=s;else if((s instanceof Uint8Array||s instanceof Uint8ClampedArray)&&s.length>=3&&s.length<=4)s=this.zs(s,0,255),[i,e,n,r=255]=s,i/=255,e/=255,n/=255,r/=255;else if("string"==typeof s||"object"==typeof s){if("string"==typeof s){const i=t.HEX_PATTERN.exec(s);i&&(s=`#${i[2]}`)}const h=$(s);h.isValid()&&(({r:i,g:e,b:n,a:r}=h.rgba),i/=255,e/=255,n/=255)}if(void 0===i)throw new Error(`Unable to convert color ${s}`);this.Ss[0]=i,this.Ss[1]=e,this.Ss[2]=n,this.Ss[3]=r,this.Rs()}Rs(){this.zs(this.Ss);const[t,s,i]=this.Ss;this.Cs=(255*t<<16)+(255*s<<8)+(255*i|0)}zs(t,s=0,i=1){return"number"==typeof t?Math.min(Math.max(t,s),i):(t.forEach((e,n)=>{t[n]=Math.min(Math.max(e,s),i)}),t)}static isColorLike(s){return"number"==typeof s||"string"==typeof s||s instanceof Number||s instanceof t||Array.isArray(s)||s instanceof Uint8Array||s instanceof Uint8ClampedArray||s instanceof Float32Array||void 0!==s.r&&void 0!==s.g&&void 0!==s.b||void 0!==s.r&&void 0!==s.g&&void 0!==s.b&&void 0!==s.a||void 0!==s.h&&void 0!==s.s&&void 0!==s.l||void 0!==s.h&&void 0!==s.s&&void 0!==s.l&&void 0!==s.a||void 0!==s.h&&void 0!==s.s&&void 0!==s.v||void 0!==s.h&&void 0!==s.s&&void 0!==s.v&&void 0!==s.a}};I.shared=new I,I.Bs=new I,I.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let E=I},2698:(t,s,i)=>{"use strict";function e(t){const s={};for(const i in t)void 0!==t[i]&&(s[i]=t[i]);return s}i.d(s,{S:()=>e})},2763:(t,s,i)=>{"use strict";function e(t,s,i,e){const n={width:0,height:0,offsetY:0,scale:s.fontSize/i.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};n.offsetY=i.baseLineOffset;let r=n.lines[0],h=null,o=!0;const a={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},c=i.baseMeasurementFontSize/s.fontSize,l=s.letterSpacing*c,u=s.wordWrapWidth*c,d=s.lineHeight?s.lineHeight*c:i.lineHeight,f=s.wordWrap&&s.breakWords,p=t=>{const s=r.width;for(let i=0;i<a.index;i++){const e=t.positions[i];r.chars.push(t.chars[i]),r.charPositions.push(e+s)}r.width+=t.width,o=!1,a.width=0,a.index=0,a.chars.length=0},g=()=>{let t=r.chars.length-1;if(e){let s=r.chars[t];for(;" "===s;)r.width-=i.chars[s].xAdvance,s=r.chars[--t]}n.width=Math.max(n.width,r.width),r={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},o=!0,n.lines.push(r),n.height+=d},m=t=>t-l>u;for(let e=0;e<t.length+1;e++){let n;const c=e===t.length;c||(n=t[e]);const u=i.chars[n]||i.chars[" "];if(/(?:\s)/.test(n)||"\r"===n||"\n"===n||c){if(!o&&s.wordWrap&&m(r.width+a.width)?(g(),p(a),c||r.charPositions.push(0)):(a.start=r.width,p(a),c||r.charPositions.push(0)),"\r"===n||"\n"===n)g();else if(!c){const t=u.xAdvance+(u.kerning[h]||0)+l;r.width+=t,r.spaceWidth=t,r.spacesIndex.push(r.charPositions.length),r.chars.push(n)}}else{const t=u.kerning[h]||0,s=u.xAdvance+t+l;f&&m(r.width+a.width+s)&&(p(a),g()),a.positions[a.index++]=a.width+t,a.chars.push(n),a.width+=s}h=n}return g(),"center"===s.align?function(t){for(let s=0;s<t.lines.length;s++){const i=t.lines[s],e=t.width/2-i.width/2;for(let t=0;t<i.charPositions.length;t++)i.charPositions[t]+=e}}(n):"right"===s.align?function(t){for(let s=0;s<t.lines.length;s++){const i=t.lines[s],e=t.width-i.width;for(let t=0;t<i.charPositions.length;t++)i.charPositions[t]+=e}}(n):"justify"===s.align&&function(t){const s=t.width;for(let i=0;i<t.lines.length;i++){const e=t.lines[i];let n=0,r=e.spacesIndex[n++],h=0;const o=e.spacesIndex.length,a=(s-e.width)/o;for(let t=0;t<e.charPositions.length;t++)t===r&&(r=e.spacesIndex[n++],h+=a),e.charPositions[t]+=h}}(n),n}i.d(s,{Z:()=>e})},2806:(t,s,i)=>{"use strict";i.d(s,{m:()=>h});var e=i(9313),n=i(133);const r={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class h{constructor(t,s){this.uid=(0,n.L)("fillPattern"),this.Gs=0,this.transform=new e.u,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),s&&(t.source.style.addressModeU=r[s].addressModeU,t.source.style.addressModeV=r[s].addressModeV)}setTransform(t){const s=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/s.frame.width,1/s.frame.height),this.Gs++}get texture(){return this.Nt}set texture(t){this.Nt!==t&&(this.Nt=t,this.Gs++)}get styleKey(){return`fill-pattern-${this.uid}-${this.Gs}`}destroy(){this.texture.destroy(!0),this.texture=null}}},2812:(t,s,i)=>{"use strict";i.d(s,{o:()=>e});class e{constructor(t,s,i){this.vs=s||0,this.xs=i||0,this.Fs=t}clone(t){return new e(t??this.Fs,this.vs,this.xs)}set(t=0,s=t){return this.vs===t&&this.xs===s||(this.vs=t,this.xs=s,this.Fs.js(this)),this}copyFrom(t){return this.vs===t.x&&this.xs===t.y||(this.vs=t.x,this.xs=t.y,this.Fs.js(this)),this}copyTo(t){return t.set(this.vs,this.xs),t}equals(t){return t.x===this.vs&&t.y===this.xs}toString(){return`[pixi.js/math:ObservablePoint x=${this.vs} y=${this.xs} scope=${this.Fs}]`}get x(){return this.vs}set x(t){this.vs!==t&&(this.vs=t,this.Fs.js(this))}get y(){return this.xs}set y(t){this.xs!==t&&(this.xs=t,this.Fs.js(this))}}},2927:(t,s,i)=>{"use strict";i.d(s,{A:()=>h});var e=i(1761);function n(t){if("string"!=typeof t)throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function r(t){return t.split("?")[0].split("#")[0]}const h={toPosix:t=>t.replace(new RegExp("\\".replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),"/"),isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl:t=>/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t),isBlobUrl:t=>t.startsWith("blob:"),hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){n(t),t=this.toPosix(t);const s=/^file:\/\/\//.exec(t);if(s)return s[0];const i=/^[^/:]+:\/{0,2}/.exec(t);return i?i[0]:""},toAbsolute(t,s,i){if(n(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const o=r(this.toPosix(s??e.e.get().getBaseUrl())),a=r(this.toPosix(i??this.rootname(o)));return(t=this.toPosix(t)).startsWith("/")?h.join(a,t.slice(1)):this.isAbsolute(t)?t:this.join(o,t)},normalize(t){if(n(t),0===t.length)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;let s="";const i=(t=this.toPosix(t)).startsWith("/");this.hasProtocol(t)&&(s=this.rootname(t),t=t.slice(s.length));const e=t.endsWith("/");return(t=function(t){let s="",i=0,e=-1,n=0,r=-1;for(let h=0;h<=t.length;++h){if(h<t.length)r=t.charCodeAt(h);else{if(47===r)break;r=47}if(47===r){if(e===h-1||1===n);else if(e!==h-1&&2===n){if(s.length<2||2!==i||46!==s.charCodeAt(s.length-1)||46!==s.charCodeAt(s.length-2))if(s.length>2){const t=s.lastIndexOf("/");if(t!==s.length-1){-1===t?(s="",i=0):(s=s.slice(0,t),i=s.length-1-s.lastIndexOf("/")),e=h,n=0;continue}}else if(2===s.length||1===s.length){s="",i=0,e=h,n=0;continue}}else s.length>0?s+=`/${t.slice(e+1,h)}`:s=t.slice(e+1,h),i=h-e-1;e=h,n=0}else 46===r&&-1!==n?++n:n=-1}return s}(t)).length>0&&e&&(t+="/"),i?`/${t}`:s+t},isAbsolute(t){return n(t),t=this.toPosix(t),!!this.hasProtocol(t)||t.startsWith("/")},join(...t){if(0===t.length)return".";let s;for(let i=0;i<t.length;++i){const e=t[i];if(n(e),e.length>0)if(void 0===s)s=e;else{const n=t[i-1]??"";this.joinExtensions.includes(this.extname(n).toLowerCase())?s+=`/../${e}`:s+=`/${e}`}}return void 0===s?".":this.normalize(s)},dirname(t){if(n(t),0===t.length)return".";let s=(t=this.toPosix(t)).charCodeAt(0);const i=47===s;let e=-1,r=!0;const h=this.getProtocol(t),o=t;for(let i=(t=t.slice(h.length)).length-1;i>=1;--i)if(s=t.charCodeAt(i),47===s){if(!r){e=i;break}}else r=!1;return-1===e?i?"/":this.isUrl(o)?h+t:h:i&&1===e?"//":h+t.slice(0,e)},rootname(t){n(t);let s="";if(s=(t=this.toPosix(t)).startsWith("/")?"/":this.getProtocol(t),this.isUrl(t)){const i=t.indexOf("/",s.length);s=-1!==i?t.slice(0,i):t,s.endsWith("/")||(s+="/")}return s},basename(t,s){n(t),s&&n(s),t=r(this.toPosix(t));let i,e=0,h=-1,o=!0;if(void 0!==s&&s.length>0&&s.length<=t.length){if(s.length===t.length&&s===t)return"";let n=s.length-1,r=-1;for(i=t.length-1;i>=0;--i){const a=t.charCodeAt(i);if(47===a){if(!o){e=i+1;break}}else-1===r&&(o=!1,r=i+1),n>=0&&(a===s.charCodeAt(n)?-1===--n&&(h=i):(n=-1,h=r))}return e===h?h=r:-1===h&&(h=t.length),t.slice(e,h)}for(i=t.length-1;i>=0;--i)if(47===t.charCodeAt(i)){if(!o){e=i+1;break}}else-1===h&&(o=!1,h=i+1);return-1===h?"":t.slice(e,h)},extname(t){n(t);let s=-1,i=0,e=-1,h=!0,o=0;for(let n=(t=r(this.toPosix(t))).length-1;n>=0;--n){const r=t.charCodeAt(n);if(47!==r)-1===e&&(h=!1,e=n+1),46===r?-1===s?s=n:1!==o&&(o=1):-1!==s&&(o=-1);else if(!h){i=n+1;break}}return-1===s||-1===e||0===o||1===o&&s===e-1&&s===i+1?"":t.slice(s,e)},parse(t){n(t);const s={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return s;let i=(t=r(this.toPosix(t))).charCodeAt(0);const e=this.isAbsolute(t);let h;s.root=this.rootname(t),h=e||this.hasProtocol(t)?1:0;let o=-1,a=0,c=-1,l=!0,u=t.length-1,d=0;for(;u>=h;--u)if(i=t.charCodeAt(u),47!==i)-1===c&&(l=!1,c=u+1),46===i?-1===o?o=u:1!==d&&(d=1):-1!==o&&(d=-1);else if(!l){a=u+1;break}return-1===o||-1===c||0===d||1===d&&o===c-1&&o===a+1?-1!==c&&(s.base=s.name=0===a&&e?t.slice(1,c):t.slice(a,c)):(0===a&&e?(s.name=t.slice(1,o),s.base=t.slice(1,c)):(s.name=t.slice(a,o),s.base=t.slice(a,c)),s.ext=t.slice(o,c)),s.dir=this.dirname(t),s},sep:"/",delimiter:":",joinExtensions:[".html"]}},3012:(t,s,i)=>{"use strict";i.d(s,{B:()=>c});var e=i(7952),n=i(8306);const r={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function h(t){const s=/@group\((\d+)\)/,i=/@binding\((\d+)\)/,e=/var(<[^>]+>)? (\w+)/,n=/:\s*(\w+)/,r=/(\w+)\s*:\s*([\w\<\>]+)/g,h=/struct\s+(\w+)/,o=t.match(/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g)?.map(t=>({group:parseInt(t.match(s)[1],10),binding:parseInt(t.match(i)[1],10),name:t.match(e)[2],isUniform:"<uniform>"===t.match(e)[1],type:t.match(n)[1]}));if(!o)return{groups:[],structs:[]};const a=t.match(/struct\s+(\w+)\s*{([^}]+)}/g)?.map(t=>{const s=t.match(h)[1],i=t.match(r).reduce((t,s)=>{const[i,e]=s.split(":");return t[i.trim()]=e.trim(),t},{});return i?{name:s,members:i}:null}).filter(({name:t})=>o.some(s=>s.type===t))??[];return{groups:o,structs:a}}var o=(t=>(t[t.VERTEX=1]="VERTEX",t[t.FRAGMENT=2]="FRAGMENT",t[t.COMPUTE=4]="COMPUTE",t))(o||{});const a=Object.create(null);class c{constructor(t){this._s=0,this.Os=0;const{fragment:s,vertex:i,layout:e,gpuLayout:n,name:r}=t;if(this.name=r,this.fragment=s,this.vertex=i,s.source===i.source){const t=h(s.source);this.structsAndGroups=t}else{const t=h(i.source),e=h(s.source);this.structsAndGroups=function(t,s){const i=new Set,e=new Set;return{structs:[...t.structs,...s.structs].filter(t=>!i.has(t.name)&&(i.add(t.name),!0)),groups:[...t.groups,...s.groups].filter(t=>{const s=`${t.name}-${t.binding}`;return!e.has(s)&&(e.add(s),!0)})}}(t,e)}this.layout=e??function({groups:t}){const s=[];for(let i=0;i<t.length;i++){const e=t[i];s[e.group]||(s[e.group]={}),s[e.group][e.name]=e.binding}return s}(this.structsAndGroups),this.gpuLayout=n??function({groups:t}){const s=[];for(let i=0;i<t.length;i++){const e=t[i];s[e.group]||(s[e.group]=[]),e.isUniform?s[e.group].push({binding:e.binding,visibility:o.VERTEX|o.FRAGMENT,buffer:{type:"uniform"}}):"sampler"===e.type?s[e.group].push({binding:e.binding,visibility:o.FRAGMENT,sampler:{type:"filtering"}}):"texture_2d"===e.type&&s[e.group].push({binding:e.binding,visibility:o.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return s}(this.structsAndGroups),this.autoAssignGlobalUniforms=!(void 0===this.layout[0]?.globalUniforms),this.autoAssignLocalUniforms=!(void 0===this.layout[1]?.localUniforms),this.Us()}Us(){const{vertex:t,fragment:s}=this,i=t.source+s.source+t.entryPoint+s.entryPoint;this._s=(0,e.X)(i,"program")}get attributeData(){return this.Ds??(this.Ds=function({source:t,entryPoint:s}){const i={},e=t.indexOf(`fn ${s}`);if(-1!==e){const s=t.indexOf("->",e);if(-1!==s){const h=t.substring(e,s),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let a;for(;null!==(a=o.exec(h));){const t=r[a[3]]??"float32";i[a[2]]={location:parseInt(a[1],10),format:t,stride:(0,n.m)(t).stride,offset:0,instance:!1,start:0}}}}return i}(this.vertex)),this.Ds}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,a[this.Ws]=null}static from(t){const s=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return a[s]||(a[s]=new c(t),a[s].Ws=s),a[s]}}},3284:(t,s,i)=>{"use strict";i.d(s,{m:()=>h});var e=i(9313),n=i(848),r=i(2437);class h{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new e.u,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new n.L,this.Ns=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this.Vs=7}init(t){this.root=t,t.Ls&&this.addOnRender(t),t.didChange=!0;const s=t.children;for(let t=0;t<s.length;t++){const i=s[t];i.Hs=15,this.addChild(i)}}enableCacheAsTexture(t={}){this.textureOptions=t,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(r.W.returnTexture(this.texture,!0),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0;const t=this.qs;t&&!t.textureNeedsUpdate&&t.updateCacheTexture()}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const s=this.childrenToUpdate[t];s.list.fill(null),s.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this.Ns.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent.Ys(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}Ys(t){const s=this.renderGroupChildren.indexOf(t);s>-1&&this.renderGroupChildren.splice(s,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup)return void this.addRenderGroupChild(t.renderGroup);t.Ls&&this.addOnRender(t);const s=t.children;for(let t=0;t<s.length;t++)this.addChild(s[t])}removeChild(t){if(this.structureDidChange=!0,t.Ls&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup)return void this.Ys(t.renderGroup);const s=t.children;for(let t=0;t<s.length;t++)this.removeChild(s[t])}removeChildren(t){for(let s=0;s<t.length;s++)this.removeChild(t[s])}onChildUpdate(t){let s=this.childrenToUpdate[t.relativeRenderGroupDepth];s||(s=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),s.list[s.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return 7===this.root.localDisplayStatus&&this.worldAlpha>0}addOnRender(t){this.Ns.push(t)}removeOnRender(t){this.Ns.splice(this.Ns.indexOf(t),1)}runOnRender(t){for(let s=0;s<this.Ns.length;s++)this.Ns[s].Ls(t)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this.Ns=null,this.instructionSet=null}getChildren(t=[]){const s=this.root.children;for(let i=0;i<s.length;i++)this.Xs(s[i],t);return t}Xs(t,s=[]){if(s.push(t),t.renderGroup)return s;const i=t.children;for(let t=0;t<i.length;t++)this.Xs(i[t],s);return s}invalidateMatrices(){this.Vs=7}get inverseWorldTransform(){return 1&this.Vs?(this.Vs&=-2,this.Qs||(this.Qs=new e.u),this.Qs.copyFrom(this.worldTransform).invert()):this.Qs}get textureOffsetInverseTransform(){return 2&this.Vs?(this.Vs&=-3,this.Zs||(this.Zs=new e.u),this.Zs.copyFrom(this.inverseWorldTransform).translate(-this.Ks.x,-this.Ks.y)):this.Zs}get inverseParentTextureTransform(){if(!(4&this.Vs))return this.Js;this.Vs&=-5;const t=this.qs;return t?(this.Js||(this.Js=new e.u),this.Js.copyFrom(this.worldTransform).prepend(t.inverseWorldTransform).translate(-t.Ks.x,-t.Ks.y)):this.worldTransform}get cacheToLocalTransform(){return this.isCachedAsTexture?this.textureOffsetInverseTransform:this.qs?this.qs.textureOffsetInverseTransform:null}}},3513:(t,s,i)=>{"use strict";i.d(s,{T:()=>e});class e{constructor(t){this.resources=Object.create(null),this.ti=!0;let s=0;for(const i in t){const e=t[i];this.setResource(e,s++)}this.si()}si(){if(!this.ti)return;this.ti=!1;const t=[];let s=0;for(const i in this.resources)t[s++]=this.resources[i].D;this.ii=t.join("|")}setResource(t,s){const i=this.resources[s];t!==i&&(i&&t.off?.("change",this.onResourceChange,this),t.on?.("change",this.onResourceChange,this),this.resources[s]=t,this.ti=!0)}getResource(t){return this.resources[t]}ei(t){const s=this.resources;for(const i in s)s[i].O=t}destroy(){const t=this.resources;for(const s in t){const i=t[s];i?.off?.("change",this.onResourceChange,this)}this.resources=null}onResourceChange(t){if(this.ti=!0,t.destroyed){const s=this.resources;for(const i in s)s[i]===t&&(s[i]=null)}else this.si()}}},3548:(t,s,i)=>{"use strict";i.d(s,{r:()=>l});var e=i(2577),n=i(9313),r=i(5589),h=i(268),o=i(7276),a=i(2806);const c=1e5;function l(t,s,i,l=0){if(t.texture===r.g.WHITE&&!t.fill)return e.Q.shared.setValue(t.color).setAlpha(t.alpha??1).toHexa();if(!t.fill){const i=s.createPattern(t.texture.source.resource,"repeat"),e=t.matrix.copyTo(n.u.shared);return e.scale(t.texture.frame.width,t.texture.frame.height),i.setTransform(e),i}if(t.fill instanceof a.m){const i=t.fill,e=s.createPattern(i.texture.source.resource,"repeat"),r=i.transform.copyTo(n.u.shared);return r.scale(i.texture.frame.width,i.texture.frame.height),e.setTransform(r),e}if(t.fill instanceof o.St){const n=t.fill,r="linear"===n.type,h="local"===n.textureSpace;let o,a=1,u=1;h&&i&&(a=i.width+l,u=i.height+l);let d=!1;if(r){const{start:t,end:i}=n;o=s.createLinearGradient(t.x*a,t.y*u,i.x*a,i.y*u),d=Math.abs(i.x-t.x)<Math.abs(.1*(i.y-t.y))}else{const{center:t,innerRadius:i,outerCenter:e,outerRadius:r}=n;o=s.createRadialGradient(t.x*a,t.y*u,i*a,e.x*a,e.y*u,r*a)}if(d&&h&&i){const t=i.lineHeight/u;for(let s=0;s<i.lines.length;s++){const r=(s*i.lineHeight+l/2)/u;n.colorStops.forEach(s=>{const i=r+s.offset*t;o.addColorStop(Math.floor(i*c)/c,e.Q.shared.setValue(s.color).toHex())})}}else n.colorStops.forEach(t=>{o.addColorStop(t.offset,e.Q.shared.setValue(t.color).toHex())});return o}return(0,h.R)("FillStyle not recognised",t),"red"}},3721:(t,s,i)=>{"use strict";i.d(s,{J:()=>j});var e=i(8507),n=i(133),r=i(1460),h=i(4670),o=i(6083),a=i(6736),c=i(8639),l=i(3804),u=i(6512);let d=null;class f{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const s=this.textures[t];this.textures[t]=null,this.ids[s.uid]=null}this.count=0}}class p{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new f,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const g=[];let m=0;function y(){return m>0?g[--m]:new p}function b(t){g[m++]=t}o.L.register({clear:()=>{if(g.length>0)for(const t of g)t&&t.destroy();g.length=0,m=0}});let w=0;const v=class t{constructor(s){this.uid=(0,n.L)("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this.ni=[],(s={...t.defaultOptions,...s}).maxTextures||((0,h.t6)("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),s.maxTextures=function(){if(d)return d;const t=(0,l.W)();return d=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),d=(0,u.u)(d,t),t.getExtension("WEBGL_lose_context")?.loseContext(),d}());const{maxTextures:i,attributesInitialSize:e,indicesInitialSize:o}=s;this.attributeBuffer=new r.u(4*e),this.indexBuffer=new Uint16Array(o),this.maxTextures=i}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)b(this.batches[t]);this.batchIndex=0,this.ri=0,this.hi=0,this.dirty=!0}add(t){this.ni[this.elementSize++]=t,t.oi=this.indexSize,t.ai=this.attributeSize,t.ci=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,s){const i=t.li.textures.ids[s.ui.uid];return!(!i&&0!==i||(t.di=i,t.texture=s,0))}updateElement(t){this.dirty=!0;const s=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,s.float32View,s.uint32View,t.ai,t.di):this.packAttributes(t,s.float32View,s.uint32View,t.ai,t.di)}break(t){const s=this.ni;if(!s[this.elementStart])return;let i=y(),e=i.textures;e.clear();const n=s[this.elementStart];let r=(0,c.i)(n.blendMode,n.texture.ui),h=n.topology;4*this.attributeSize>this.attributeBuffer.size&&this.fi(4*this.attributeSize),this.indexSize>this.indexBuffer.length&&this.pi(this.indexSize);const o=this.attributeBuffer.float32View,a=this.attributeBuffer.uint32View,l=this.indexBuffer;let u=this.hi,d=this.ri,f="startBatch";const p=this.maxTextures;for(let n=this.elementStart;n<this.elementSize;++n){const g=s[n];s[n]=null;const m=g.texture.ui,b=(0,c.i)(g.blendMode,m),v=r!==b||h!==g.topology;m.nt!==w||v?(m.nt=w,(e.count>=p||v)&&(this.gi(i,d,u-d,e,r,h,t,f),f="renderBatch",d=u,r=b,h=g.topology,i=y(),e=i.textures,e.clear(),++w),g.di=m.rt=e.count,e.ids[m.uid]=e.count,e.textures[e.count++]=m,g.li=i,u+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,o,a,g.ai,g.di),this.packQuadIndex(l,g.oi,g.ai/this.vertexSize)):(this.packAttributes(g,o,a,g.ai,g.di),this.packIndex(g,l,g.oi,g.ai/this.vertexSize))):(g.di=m.rt,u+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,o,a,g.ai,g.di),this.packQuadIndex(l,g.oi,g.ai/this.vertexSize)):(this.packAttributes(g,o,a,g.ai,g.di),this.packIndex(g,l,g.oi,g.ai/this.vertexSize)),g.li=i)}e.count>0&&(this.gi(i,d,u-d,e,r,h,t,f),d=u,++w),this.elementStart=this.elementSize,this.ri=d,this.hi=u}gi(t,s,i,e,n,r,h,o){t.gpuBindGroup=null,t.bindGroup=null,t.action=o,t.batcher=this,t.textures=e,t.blendMode=n,t.topology=r,t.start=s,t.size=i,++w,this.batches[this.batchIndex++]=t,h.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){4*t<=this.attributeBuffer.size||this.fi(4*t)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this.pi(t)}fi(t){const s=Math.max(t,2*this.attributeBuffer.size),i=new r.u(s);(0,a.W)(this.attributeBuffer.rawBinaryData,i.rawBinaryData),this.attributeBuffer=i}pi(t){const s=this.indexBuffer;let i=Math.max(t,1.5*s.length);i+=i%2;const e=i>65535?new Uint32Array(i):new Uint16Array(i);if(e.BYTES_PER_ELEMENT!==s.BYTES_PER_ELEMENT)for(let t=0;t<s.length;t++)e[t]=s[t];else(0,a.W)(s.buffer,e.buffer);this.indexBuffer=e}packQuadIndex(t,s,i){t[s]=i+0,t[s+1]=i+1,t[s+2]=i+2,t[s+3]=i+0,t[s+4]=i+2,t[s+5]=i+3}packIndex(t,s,i,e){const n=t.indices,r=t.indexSize,h=t.indexOffset,o=t.attributeOffset;for(let t=0;t<r;t++)s[i++]=e+n[t+h]-o}destroy(){if(null!==this.batches){for(let t=0;t<this.batches.length;t++)b(this.batches[t]);this.batches=null;for(let t=0;t<this.ni.length;t++)this.ni[t]&&(this.ni[t].li=null);this.ni=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}};v.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let x=v;var A=i(949),M=i(1132),k=i(6011);const S=new Float32Array(1),C=new Uint32Array(1);class T extends k.V{constructor(){const t=new A.h({data:S,label:"attribute-batch-buffer",usage:M.S.VERTEX|M.S.COPY_DST,shrinkToFit:!1});super({attributes:{aPosition:{buffer:t,format:"float32x2",stride:24,offset:0},aUV:{buffer:t,format:"float32x2",stride:24,offset:8},aColor:{buffer:t,format:"unorm8x4",stride:24,offset:16},aTextureIdAndRound:{buffer:t,format:"uint16x2",stride:24,offset:20}},indexBuffer:new A.h({data:C,label:"index-batch-buffer",usage:M.S.INDEX|M.S.COPY_DST,shrinkToFit:!1})})}}var $=i(5611),P=i(4459),I=i(4e3),E=i(6665),B=i(6040),R=i(8475);class z extends R.M{constructor(t){super({glProgram:(0,$.I)({name:"batch",bits:[P.a,(0,I.P)(t),E.m]}),gpuProgram:(0,$.v)({name:"batch",bits:[P.F,(0,I.St)(t),E.b]}),resources:{batchSamplers:(0,B.n)(t)}})}}let G=null;const F=class t extends x{constructor(s){super(s),this.geometry=new T,this.name=t.extension.name,this.vertexSize=6,G??(G=new z(s.maxTextures)),this.shader=G}packAttributes(t,s,i,e,n){const r=n<<16|65535&t.roundPixels,h=t.transform,o=h.a,a=h.b,c=h.c,l=h.d,u=h.tx,d=h.ty,{positions:f,uvs:p}=t,g=t.color,m=t.attributeOffset,y=m+t.attributeSize;for(let t=m;t<y;t++){const n=2*t,h=f[n],m=f[n+1];s[e++]=o*h+c*m+u,s[e++]=l*m+a*h+d,s[e++]=p[n],s[e++]=p[n+1],i[e++]=g,i[e++]=r}}packQuadAttributes(t,s,i,e,n){const r=t.texture,h=t.transform,o=h.a,a=h.b,c=h.c,l=h.d,u=h.tx,d=h.ty,f=t.bounds,p=f.maxX,g=f.minX,m=f.maxY,y=f.minY,b=r.uvs,w=t.color,v=n<<16|65535&t.roundPixels;s[e+0]=o*g+c*y+u,s[e+1]=l*y+a*g+d,s[e+2]=b.x0,s[e+3]=b.y0,i[e+4]=w,i[e+5]=v,s[e+6]=o*p+c*y+u,s[e+7]=l*y+a*p+d,s[e+8]=b.x1,s[e+9]=b.y1,i[e+10]=w,i[e+11]=v,s[e+12]=o*p+c*m+u,s[e+13]=l*m+a*p+d,s[e+14]=b.x2,s[e+15]=b.y2,i[e+16]=w,i[e+17]=v,s[e+18]=o*g+c*m+u,s[e+19]=l*m+a*g+d,s[e+20]=b.x3,s[e+21]=b.y3,i[e+22]=w,i[e+23]=v}};F.extension={type:[e.Ag.Batcher],name:"default"};let j=F},3804:(t,s,i)=>{"use strict";i.d(s,{W:()=>r});var e=i(1761);let n;function r(){if(!n||n?.isContextLost()){const t=e.e.get().createCanvas();n=t.getContext("webgl",{})}return n}},4e3:(t,s,i)=>{"use strict";i.d(s,{P:()=>c,St:()=>h});const e={};function n(t){const s=[];if(1===t)s.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),s.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let i=0;for(let e=0;e<t;e++)s.push(`@group(1) @binding(${i++}) var textureSource${e+1}: texture_2d<f32>;`),s.push(`@group(1) @binding(${i++}) var textureSampler${e+1}: sampler;`)}return s.join("\n")}function r(t){const s=[];if(1===t)s.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{s.push("switch vTextureId {");for(let i=0;i<t;i++)i===t-1?s.push("  default:{"):s.push(`  case ${i}:{`),s.push(`      outColor = textureSampleGrad(textureSource${i+1}, textureSampler${i+1}, vUV, uvDx, uvDy);`),s.push("      break;}");s.push("}")}return s.join("\n")}function h(t){return e[t]||(e[t]={name:"texture-batch-bit",vertex:{header:"\n                @in aTextureIdAndRound: vec2<u32>;\n                @out @interpolate(flat) vTextureId : u32;\n            ",main:"\n                vTextureId = aTextureIdAndRound.y;\n            ",end:"\n                if(aTextureIdAndRound.x == 1)\n                {\n                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n                }\n            "},fragment:{header:`\n                @in @interpolate(flat) vTextureId: u32;\n\n                ${n(t)}\n            `,main:`\n                var uvDx = dpdx(vUV);\n                var uvDy = dpdy(vUV);\n\n                ${r(t)}\n            `}}),e[t]}const o={};function a(t){const s=[];for(let i=0;i<t;i++)i>0&&s.push("else"),i<t-1&&s.push(`if(vTextureId < ${i}.5)`),s.push("{"),s.push(`\toutColor = texture(uTextures[${i}], vUV);`),s.push("}");return s.join("\n")}function c(t){return o[t]||(o[t]={name:"texture-batch-bit",vertex:{header:"\n                in vec2 aTextureIdAndRound;\n                out float vTextureId;\n\n            ",main:"\n                vTextureId = aTextureIdAndRound.y;\n            ",end:"\n                if(aTextureIdAndRound.x == 1.)\n                {\n                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n                }\n            "},fragment:{header:`\n                in float vTextureId;\n\n                uniform sampler2D uTextures[${t}];\n\n            `,main:`\n\n                ${a(t)}\n            `}}),o[t]}},4016:(t,s,i)=>{"use strict";i.d(s,{P:()=>a});var e=i(5957),n=i(1761),r=i(1242);const h={willReadFrequently:!0},o=class t{static get experimentalLetterSpacingSupported(){let s=t.mi;if(void 0===s){const i=n.e.get().getCanvasRenderingContext2D().prototype;s=t.mi="letterSpacing"in i||"textLetterSpacing"in i}return s}constructor(t,s,i,e,n,r,h,o,a){this.text=t,this.style=s,this.width=i,this.height=e,this.lines=n,this.lineWidths=r,this.lineHeight=h,this.maxLineWidth=o,this.fontProperties=a}static measureText(s=" ",i,e=t.yi,n=i.wordWrap){const h=`${s}-${i.styleKey}-wordWrap-${n}`;if(t.bi.has(h))return t.bi.get(h);const o=(0,r.Z)(i),a=t.measureFont(o);0===a.fontSize&&(a.fontSize=i.fontSize,a.ascent=i.fontSize);const c=t.wi;c.font=o;const l=(n?t.xi(s,i,e):s).split(/(?:\r\n|\r|\n)/),u=new Array(l.length);let d=0;for(let s=0;s<l.length;s++){const e=t.Ai(l[s],i.letterSpacing,c);u[s]=e,d=Math.max(d,e)}const f=i.ss?.width||0;let p=d+f;i.dropShadow&&(p+=i.dropShadow.distance);const g=i.lineHeight||a.fontSize;let m=Math.max(g,a.fontSize+f)+(l.length-1)*(g+i.leading);i.dropShadow&&(m+=i.dropShadow.distance);const y=new t(s,i,p,m,l,u,g+i.leading,d,a);return t.bi.set(h,y),y}static Ai(s,i,e){let n=!1;t.experimentalLetterSpacingSupported&&(t.experimentalLetterSpacing?(e.letterSpacing=`${i}px`,e.textLetterSpacing=`${i}px`,n=!0):(e.letterSpacing="0px",e.textLetterSpacing="0px"));const r=e.measureText(s);let h=r.width;const o=-r.actualBoundingBoxLeft;let a=r.actualBoundingBoxRight-o;if(h>0)if(n)h-=i,a-=i;else{const e=(t.graphemeSegmenter(s).length-1)*i;h+=e,a+=e}return Math.max(h,a)}static xi(s,i,e=t.yi){const n=e.getContext("2d",h);let r=0,o="",a="";const c=Object.create(null),{letterSpacing:l,whiteSpace:u}=i,d=t.Mi(u),f=t.ki(u);let p=!d;const g=i.wordWrapWidth+l,m=t.Si(s);for(let s=0;s<m.length;s++){let e=m[s];if(t.Ci(e)){if(!f){a+=t.Ti(o),p=!d,o="",r=0;continue}e=" "}if(d){const s=t.isBreakingSpace(e),i=t.isBreakingSpace(o[o.length-1]);if(s&&i)continue}const h=t.$i(e,l,c,n);if(h>g)if(""!==o&&(a+=t.Ti(o),o="",r=0),t.canBreakWords(e,i.breakWords)){const s=t.wordWrapSplit(e);for(let h=0;h<s.length;h++){let u=s[h],d=u,f=1;for(;s[h+f];){const n=s[h+f];if(t.canBreakChars(d,n,e,h,i.breakWords))break;u+=n,d=n,f++}h+=f-1;const m=t.$i(u,l,c,n);m+r>g&&(a+=t.Ti(o),p=!1,o="",r=0),o+=u,r+=m}}else{o.length>0&&(a+=t.Ti(o),o="",r=0);const i=s===m.length-1;a+=t.Ti(e,!i),p=!1,o="",r=0}else h+r>g&&(p=!1,a+=t.Ti(o),o="",r=0),(o.length>0||!t.isBreakingSpace(e)||p)&&(o+=e,r+=h)}return a+=t.Ti(o,!1),a}static Ti(s,i=!0){return s=t.Pi(s),i?`${s}\n`:s}static $i(s,i,e,n){let r=e[s];return"number"!=typeof r&&(r=t.Ai(s,i,n)+i,e[s]=r),r}static Mi(t){return"normal"===t||"pre-line"===t}static ki(t){return"normal"===t}static Pi(s){if("string"!=typeof s)return"";for(let i=s.length-1;i>=0;i--){const e=s[i];if(!t.isBreakingSpace(e))break;s=s.slice(0,-1)}return s}static Ci(s){return"string"==typeof s&&t.Ii.includes(s.charCodeAt(0))}static isBreakingSpace(s,i){return"string"==typeof s&&t.Ei.includes(s.charCodeAt(0))}static Si(s){const i=[];let e="";if("string"!=typeof s)return i;for(let n=0;n<s.length;n++){const r=s[n],h=s[n+1];t.isBreakingSpace(r,h)||t.Ci(r)?(""!==e&&(i.push(e),e=""),"\r"===r&&"\n"===h?(i.push("\r\n"),n++):i.push(r)):e+=r}return""!==e&&i.push(e),i}static canBreakWords(t,s){return s}static canBreakChars(t,s,i,e,n){return!0}static wordWrapSplit(s){return t.graphemeSegmenter(s)}static measureFont(s){if(t.Bi[s])return t.Bi[s];const i=t.Ri;i.font=s;const e=i.measureText(t.METRICS_STRING+t.BASELINE_SYMBOL),n={ascent:e.actualBoundingBoxAscent,descent:e.actualBoundingBoxDescent,fontSize:e.actualBoundingBoxAscent+e.actualBoundingBoxDescent};return t.Bi[s]=n,n}static clearMetrics(s=""){s?delete t.Bi[s]:t.Bi={}}static get yi(){if(!t.zi){let s;try{const i=new OffscreenCanvas(0,0),e=i.getContext("2d",h);if(e?.measureText)return t.zi=i,i;s=n.e.get().createCanvas()}catch(t){s=n.e.get().createCanvas()}s.width=s.height=10,t.zi=s}return t.zi}static get Ri(){return t.wi||(t.wi=t.yi.getContext("2d",h)),t.wi}};o.METRICS_STRING="|q",o.BASELINE_SYMBOL="M",o.BASELINE_MULTIPLIER=1.4,o.HEIGHT_MULTIPLIER=2,o.graphemeSegmenter=(()=>{if("function"==typeof Intl?.Segmenter){const t=new Intl.Segmenter;return s=>{const i=t.segment(s),e=[];let n=0;for(const t of i)e[n++]=t.segment;return e}}return t=>[...t]})(),o.experimentalLetterSpacing=!1,o.Bi={},o.Ii=[10,13],o.Ei=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288],o.bi=(0,e.g)(1e3);let a=o},4195:(t,s,i)=>{"use strict";i.d(s,{P:()=>r});var e=i(8507),n=i(583);class r extends n.v{constructor(t){const s=t.resource||new Float32Array(t.width*t.height*4);let i=t.format;i||(i=s instanceof Float32Array?"rgba32float":s instanceof Int32Array||s instanceof Uint32Array?"rgba32uint":s instanceof Int16Array||s instanceof Uint16Array?"rgba16uint":(Int8Array,"bgra8unorm")),super({...t,resource:s,format:i}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}r.extension=e.Ag.TextureSource},4458:(t,s,i)=>{"use strict";i.d(s,{d:()=>e});var e=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(e||{})},4459:(t,s,i)=>{"use strict";i.d(s,{F:()=>e,a:()=>n});const e={name:"color-bit",vertex:{header:"\n            @in aColor: vec4<f32>;\n        ",main:"\n            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);\n        "}},n={name:"color-bit",vertex:{header:"\n            in vec4 aColor;\n        ",main:"\n            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);\n        "}}},4486:(t,s,i)=>{"use strict";i.d(s,{A:()=>e});const e=i(228)},4577:(t,s,i)=>{"use strict";let e;function n(){if("boolean"==typeof e)return e;try{const t=new Function("param1","param2","param3","return param1[param2] === param3;");e=!0===t({a:"b"},"a","b")}catch(t){e=!1}return e}i.d(s,{f:()=>n})},4589:(t,s,i)=>{"use strict";i.d(s,{T:()=>e});var e=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(e||{})},4670:(t,s,i)=>{"use strict";i.d(s,{Ek:()=>r,lj:()=>n,t6:()=>o});const e=new Set,n="8.0.0",r="8.3.4",h={quiet:!1,noColor:!1},o=(t,s,i=3)=>{if(h.quiet||e.has(s))return;let n=(new Error).stack;const r=`${s}\nDeprecated since v${t}`,o="function"==typeof console.groupCollapsed&&!h.noColor;void 0===n?console.warn("PixiJS Deprecation Warning: ",r):(n=n.split("\n").splice(i).join("\n"),o?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",r),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",r),console.warn(n))),e.add(s)};Object.defineProperties(o,{quiet:{get:()=>h.quiet,set:t=>{h.quiet=t},enumerable:!0,configurable:!1},noColor:{get:()=>h.noColor,set:t=>{h.noColor=t},enumerable:!0,configurable:!1}})},4676:(t,s,i)=>{"use strict";function e(t,s){return 16777215!==t&&s?16777215!==s&&t?((t>>16&255)*(s>>16&255)/255<<16)+((t>>8&255)*(s>>8&255)/255<<8)+((255&t)*(255&s)/255|0):t:s}i.d(s,{u:()=>e})},4884:(t,s,i)=>{"use strict";i.d(s,{q:()=>h});var e=i(1761),n=i(8507),r=i(583);class h extends r.v{constructor(t){t.resource||(t.resource=e.e.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),this.resource.width===this.pixelWidth&&this.resource.height===this.pixelHeight||(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,s=this.height,i=this.et){const e=super.resize(t,s,i);return e&&this.resizeCanvas(),e}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this.Gi||(this.Gi=this.resource.getContext("2d"))}}h.extension=n.Ag.TextureSource},4985:(t,s,i)=>{"use strict";i.d(s,{l:()=>r});var e=i(9636),n=i(7457);class r extends n.mc{constructor(t){super(t),this.canBundle=!0,this.allowChildren=!1,this.bt=0,this.Fi=-1,this.ji=Object.create(null),this._i=new e.c(0,1,0,0),this.Oi=!0}get bounds(){return this.Oi?(this.updateBounds(),this.Oi=!1,this._i):this._i}get roundPixels(){return!!this.bt}set roundPixels(t){this.bt=t?1:0}containsPoint(t){const s=this.bounds,{x:i,y:e}=t;return i>=s.minX&&i<=s.maxX&&e>=s.minY&&e<=s.maxY}onViewUpdate(){if(this.Ui++,this.Oi=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){super.destroy(t),this._i=null;for(const t in this.ji)this.ji[t].destroy?.();this.ji=null}collectRenderablesSimple(t,s,i){const{renderPipes:e}=s;e.blendMode.pushBlendMode(this,this.groupBlendMode,t),e[this.renderPipeId].addRenderable(this,t),this.didViewUpdate=!1;const n=this.children,r=n.length;for(let e=0;e<r;e++)n[e].collectRenderables(t,s,i);e.blendMode.popBlendMode(t)}}},5099:(t,s,i)=>{"use strict";i.d(s,{W:()=>e});var e=(t=>(t[t.WEBGL=1]="WEBGL",t[t.WEBGPU=2]="WEBGPU",t[t.BOTH=3]="BOTH",t))(e||{})},5101:(t,s,i)=>{"use strict";i.d(s,{b:()=>e});class e{constructor(t=0,s=0){this.x=0,this.y=0,this.x=t,this.y=s}clone(){return new e(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,s=t){return this.x=t,this.y=s,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return n.x=0,n.y=0,n}}const n=new e},5589:(t,s,i)=>{"use strict";i.d(s,{g:()=>d});var e=i(4486),n=i(2079),r=i(9252),h=i(133),o=i(4670);const a=()=>{};var c=i(4195),l=i(583),u=i(1196);class d extends e.A{constructor({source:t,label:s,frame:i,orig:e,trim:n,defaultAnchor:o,defaultBorders:a,rotate:c,dynamic:u}={}){if(super(),this.uid=(0,h.L)("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new r.M,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=s,this.source=t?.source??new l.v,this.noFrame=!i,i)this.frame.copyFrom(i);else{const{width:t,height:s}=this.ui;this.frame.width=t,this.frame.height=s}this.orig=e||this.frame,this.trim=n,this.rotate=c??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=u||!1,this.updateUvs()}set source(t){this.ui&&this.ui.off("resize",this.update,this),this.ui=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this.ui}get textureMatrix(){return this.Di||(this.Di=new u.N(this)),this.Di}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:s}=this,{width:i,height:e}=this.ui,r=s.x/i,h=s.y/e,o=s.width/i,a=s.height/e;let c=this.rotate;if(c){const s=o/2,i=a/2,e=r+s,l=h+i;c=n.E.add(c,n.E.NW),t.x0=e+s*n.E.uX(c),t.y0=l+i*n.E.uY(c),c=n.E.add(c,2),t.x1=e+s*n.E.uX(c),t.y1=l+i*n.E.uY(c),c=n.E.add(c,2),t.x2=e+s*n.E.uX(c),t.y2=l+i*n.E.uY(c),c=n.E.add(c,2),t.x3=e+s*n.E.uX(c),t.y3=l+i*n.E.uY(c)}else t.x0=r,t.y0=h,t.x1=r+o,t.y1=h,t.x2=r+o,t.y2=h+a,t.x3=r,t.y3=h+a}destroy(t=!1){this.ui&&t&&(this.ui.destroy(),this.ui=null),this.Di=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this.ui.width,this.frame.height=this.ui.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return(0,o.t6)(o.lj,"Texture.baseTexture is now Texture.source"),this.ui}}d.EMPTY=new d({label:"EMPTY",source:new l.v({label:"EMPTY"})}),d.EMPTY.destroy=a,d.WHITE=new d({source:new c.P({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"}),d.WHITE.destroy=a},5611:(t,s,i)=>{"use strict";i.d(s,{I:()=>C,v:()=>S});var e=i(9113),n=i(3012),r=i(268);function h(t,s,i){if(t)for(const e in t){const n=s[e.toLocaleLowerCase()];if(n){let s=t[e];"header"===e&&(s=s.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),i&&n.push(`//----${i}----//`),n.push(s)}else(0,r.R)(`${e} placement hook does not exist in shader`)}}const o=/\{\{(.*?)\}\}/g;function a(t){const s={};return(t.match(o)?.map(t=>t.replace(/[{()}]/g,""))??[]).forEach(t=>{s[t]=[]}),s}function c(t,s){let i;const e=/@in\s+([^;]+);/g;for(;null!==(i=e.exec(t));)s.push(i[1])}function l(t,s,i=!1){const e=[];c(s,e),t.forEach(t=>{t.header&&c(t.header,e)});const n=e;i&&n.sort();const r=n.map((t,s)=>`       @location(${s}) ${t},`).join("\n");let h=s.replace(/@in\s+[^;]+;\s*/g,"");return h=h.replace("{{in}}",`\n${r}\n`),h}function u(t,s){let i;const e=/@out\s+([^;]+);/g;for(;null!==(i=e.exec(t));)s.push(i[1])}function d(t,s){let i=t;for(const t in s){const e=s[t];i=e.join("\n").length?i.replace(`{{${t}}}`,`//-----${t} START-----//\n${e.join("\n")}\n//----${t} FINISH----//`):i.replace(`{{${t}}}`,"")}return i}const f=Object.create(null),p=new Map;let g=0;function m({template:t,bits:s}){const i=y(t,s);return f[i]||(f[i]=b(t.vertex,t.fragment,s)),f[i]}function y(t,s){return s.map(t=>(p.has(t)||p.set(t,g++),p.get(t))).sort((t,s)=>t-s).join("-")+t.vertex+t.fragment}function b(t,s,i){const e=a(t),n=a(s);return i.forEach(t=>{h(t.vertex,e,t.name),h(t.fragment,n,t.name)}),{vertex:d(t,e),fragment:d(s,n)}}const w="\n    @in aPosition: vec2<f32>;\n    @in aUV: vec2<f32>;\n\n    @out @builtin(position) vPosition: vec4<f32>;\n    @out vUV : vec2<f32>;\n    @out vColor : vec4<f32>;\n\n    {{header}}\n\n    struct VSOutput {\n        {{struct}}\n    };\n\n    @vertex\n    fn main( {{in}} ) -> VSOutput {\n\n        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;\n        var modelMatrix = mat3x3<f32>(\n            1.0, 0.0, 0.0,\n            0.0, 1.0, 0.0,\n            0.0, 0.0, 1.0\n          );\n        var position = aPosition;\n        var uv = aUV;\n\n        {{start}}\n\n        vColor = vec4<f32>(1., 1., 1., 1.);\n\n        {{main}}\n\n        vUV = uv;\n\n        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;\n\n        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);\n\n        vColor *= globalUniforms.uWorldColorAlpha;\n\n        {{end}}\n\n        {{return}}\n    };\n",v="\n    @in vUV : vec2<f32>;\n    @in vColor : vec4<f32>;\n\n    {{header}}\n\n    @fragment\n    fn main(\n        {{in}}\n      ) -> @location(0) vec4<f32> {\n\n        {{start}}\n\n        var outColor:vec4<f32>;\n\n        {{main}}\n\n        var finalColor:vec4<f32> = outColor * vColor;\n\n        {{end}}\n\n        return finalColor;\n      };\n",x="\n    in vec2 aPosition;\n    in vec2 aUV;\n\n    out vec4 vColor;\n    out vec2 vUV;\n\n    {{header}}\n\n    void main(void){\n\n        mat3 worldTransformMatrix = uWorldTransformMatrix;\n        mat3 modelMatrix = mat3(\n            1.0, 0.0, 0.0,\n            0.0, 1.0, 0.0,\n            0.0, 0.0, 1.0\n          );\n        vec2 position = aPosition;\n        vec2 uv = aUV;\n\n        {{start}}\n\n        vColor = vec4(1.);\n\n        {{main}}\n\n        vUV = uv;\n\n        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;\n\n        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n\n        vColor *= uWorldColorAlpha;\n\n        {{end}}\n    }\n",A="\n\n    in vec4 vColor;\n    in vec2 vUV;\n\n    out vec4 finalColor;\n\n    {{header}}\n\n    void main(void) {\n\n        {{start}}\n\n        vec4 outColor;\n\n        {{main}}\n\n        finalColor = outColor * vColor;\n\n        {{end}}\n    }\n",M={name:"global-uniforms-bit",vertex:{header:"\n        struct GlobalUniforms {\n            uProjectionMatrix:mat3x3<f32>,\n            uWorldTransformMatrix:mat3x3<f32>,\n            uWorldColorAlpha: vec4<f32>,\n            uResolution: vec2<f32>,\n        }\n\n        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;\n        "}},k={name:"global-uniforms-bit",vertex:{header:"\n          uniform mat3 uProjectionMatrix;\n          uniform mat3 uWorldTransformMatrix;\n          uniform vec4 uWorldColorAlpha;\n          uniform vec2 uResolution;\n        "}};function S({bits:t,name:s}){const i=function({template:t,bits:s}){const i=y(t,s);if(f[i])return f[i];const{vertex:e,fragment:n}=function(t,s){const i=s.map(t=>t.vertex).filter(t=>!!t),e=s.map(t=>t.fragment).filter(t=>!!t);let n=l(i,t.vertex,!0);return n=function(t,s){const i=[];u(s,i),t.forEach(t=>{t.header&&u(t.header,i)});let e=0;const n=i.sort().map(t=>t.indexOf("builtin")>-1?t:`@location(${e++}) ${t}`).join(",\n"),r=i.sort().map(t=>{return`       var ${s=t,s.replace(/@.*?\s+/g,"")};`;var s}).join("\n"),h=`return VSOutput(\n            ${i.sort().map(t=>` ${function(t){const s=/\b(\w+)\s*:/g.exec(t);return s?s[1]:""}(t)}`).join(",\n")});`;let o=s.replace(/@out\s+[^;]+;\s*/g,"");return o=o.replace("{{struct}}",`\n${n}\n`),o=o.replace("{{start}}",`\n${r}\n`),o=o.replace("{{return}}",`\n${h}\n`),o}(i,n),{vertex:n,fragment:l(e,t.fragment,!0)}}(t,s);return f[i]=b(e,n,s),f[i]}({template:{fragment:v,vertex:w},bits:[M,...t]});return n.B.from({name:s,vertex:{source:i.vertex,entryPoint:"main"},fragment:{source:i.fragment,entryPoint:"main"}})}function C({bits:t,name:s}){return new e.M({name:s,...m({template:{vertex:x,fragment:A},bits:[k,...t]})})}},5811:(t,s,i)=>{"use strict";i.d(s,{k:()=>c});var e=i(133),n=i(7952);const r=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],h=r.reduce((t,s)=>(t[s]=!0,t),{});function o(t,s){switch(t){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*s);case"vec3<f32>":return new Float32Array(3*s);case"vec4<f32>":return new Float32Array(4*s);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const a=class t{constructor(s,i){this.O=0,this.uid=(0,e.L)("uniform"),this._="uniformGroup",this.D=(0,e.L)("resource"),this.isUniformGroup=!0,this.Wi=0,this.destroyed=!1,i={...t.defaultOptions,...i},this.uniformStructures=s;const a={};for(const t in s){const i=s[t];if(i.name=t,i.size=i.size??1,!h[i.type]){const t=i.type.match(/^array<(\w+(?:<\w+>)?),\s*(\d+)>$/);if(t){const[,s,e]=t;throw new Error(`Uniform type ${i.type} is not supported. Use type: '${s}', size: ${e} instead.`)}throw new Error(`Uniform type ${i.type} is not supported. Supported uniform types are: ${r.join(", ")}`)}i.value??(i.value=o(i.type,i.size)),a[t]=i.value}this.uniforms=a,this.Wi=1,this.ubo=i.ubo,this.isStatic=i.isStatic,this.Ni=(0,n.X)(Object.keys(a).map(t=>`${t}-${s[t].type}`).join("-"),"uniform-group")}update(){this.Wi++}};a.defaultOptions={ubo:!1,isStatic:!1};let c=a},5957:(t,s,i)=>{"use strict";i.d(s,{g:()=>n});class e{constructor(t=0,s=0,i=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=t,this.resetTtl=i,this.size=0,this.ttl=s}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(t){if(this.has(t)){const s=this.items[t];delete this.items[t],this.size--,null!==s.prev&&(s.prev.next=s.next),null!==s.next&&(s.next.prev=s.prev),this.first===s&&(this.first=s.next),this.last===s&&(this.last=s.prev)}return this}entries(t=this.keys()){return t.map(t=>[t,this.get(t)])}evict(t=!1){if(t||this.size>0){const t=this.first;delete this.items[t.key],0===--this.size?(this.first=null,this.last=null):(this.first=t.next,this.first.prev=null)}return this}expiresAt(t){let s;return this.has(t)&&(s=this.items[t].expiry),s}get(t){const s=this.items[t];if(void 0!==s)return this.ttl>0&&s.expiry<=Date.now()?void this.delete(t):(this.moveToEnd(s),s.value)}has(t){return t in this.items}moveToEnd(t){this.last!==t&&(null!==t.prev&&(t.prev.next=t.next),null!==t.next&&(t.next.prev=t.prev),this.first===t&&(this.first=t.next),t.prev=this.last,t.next=null,null!==this.last&&(this.last.next=t),this.last=t,null===this.first&&(this.first=t))}keys(){const t=[];let s=this.first;for(;null!==s;)t.push(s.key),s=s.next;return t}setWithEvicted(t,s,i=this.resetTtl){let e=null;if(this.has(t))this.set(t,s,!0,i);else{this.max>0&&this.size===this.max&&(e={...this.first},this.evict(!0));let i=this.items[t]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:t,prev:this.last,next:null,value:s};1===++this.size?this.first=i:this.last.next=i,this.last=i}return e}set(t,s,i=!1,e=this.resetTtl){let n=this.items[t];return i||void 0!==n?(n.value=s,!1===i&&e&&(n.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.moveToEnd(n)):(this.max>0&&this.size===this.max&&this.evict(!0),n=this.items[t]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:t,prev:this.last,next:null,value:s},1===++this.size?this.first=n:this.last.next=n,this.last=n),this}values(t=this.keys()){return t.map(t=>this.get(t))}}function n(t=1e3,s=0,i=!1){if(isNaN(t)||t<0)throw new TypeError("Invalid max value");if(isNaN(s)||s<0)throw new TypeError("Invalid ttl value");if("boolean"!=typeof i)throw new TypeError("Invalid resetTtl value");return new e(t,s,i)}},6011:(t,s,i)=>{"use strict";i.d(s,{V:()=>c});var e=i(4486),n=i(9636),r=i(133),h=i(949),o=i(1132);function a(t,s){if(!(t instanceof h.h)){let i=s?o.S.INDEX:o.S.VERTEX;t instanceof Array&&(s?(t=new Uint32Array(t),i=o.S.INDEX|o.S.COPY_DST):(t=new Float32Array(t),i=o.S.VERTEX|o.S.COPY_DST)),t=new h.h({data:t,label:s?"index-mesh-buffer":"vertex-mesh-buffer",usage:i})}return t}class c extends e.A{constructor(t={}){super(),this.uid=(0,r.L)("geometry"),this._s=0,this.instanceCount=1,this._i=new n.c,this.Oi=!0;const{attributes:s,indexBuffer:i,topology:e}=t;if(this.buffers=[],this.attributes={},s)for(const t in s)this.addAttribute(t,s[t]);this.instanceCount=t.instanceCount??1,i&&this.addIndex(i),this.topology=e||"triangle-list"}onBufferUpdate(){this.Oi=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const s=this.attributes[t];return s.buffer.data.length/(s.stride/4||s.size)}return 0}addAttribute(t,s){const i=function(t){return(t instanceof h.h||Array.isArray(t)||t.BYTES_PER_ELEMENT)&&(t={buffer:t}),t.buffer=a(t.buffer,!1),t}(s);-1===this.buffers.indexOf(i.buffer)&&(this.buffers.push(i.buffer),i.buffer.on("update",this.onBufferUpdate,this),i.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=i}addIndex(t){this.indexBuffer=a(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this.Oi?(this.Oi=!1,function(t,s,i){const e=t.getAttribute("aPosition");if(!e)return i.minX=0,i.minY=0,i.maxX=0,i.maxY=0,i;const n=e.buffer.data;let r=1/0,h=1/0,o=-1/0,a=-1/0;const c=n.BYTES_PER_ELEMENT,l=(e.offset||0)/c,u=(e.stride||8)/c;for(let t=l;t<n.length;t+=u){const s=n[t],i=n[t+1];s>o&&(o=s),i>a&&(a=i),s<r&&(r=s),i<h&&(h=i)}return i.minX=r,i.minY=h,i.maxX=o,i.maxY=a,i}(this,0,this._i)):this._i}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(t=>t.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._i=null}}},6040:(t,s,i)=>{"use strict";i.d(s,{n:()=>r});var e=i(5811);const n={};function r(t){let s=n[t];if(s)return s;const i=new Int32Array(t);for(let s=0;s<t;s++)i[s]=s;return s=n[t]=new e.k({uTextures:{value:i,type:"i32",size:t}},{isStatic:!0}),s}},6083:(t,s,i)=>{"use strict";i.d(s,{L:()=>e});const e={Vi:new Set,register(t){this.Vi.add(t)},unregister(t){this.Vi.delete(t)},release(){this.Vi.forEach(t=>t.clear())},get registeredCount(){return this.Vi.size},isRegistered(t){return this.Vi.has(t)},reset(){this.Vi.clear()}}},6139:(t,s,i)=>{"use strict";i.d(s,{$:()=>a});var e=i(8507),n=i(7309),r=i(6858),h=i(583);const o=class t extends h.v{constructor(s){super(s),this.isReady=!1,this.uploadMethodId="video",s={...t.defaultOptions,...s},this.Li=!0,this.Hi=!1,this.qi=s.updateFPS||0,this.Yi=0,this.autoPlay=!1!==s.autoPlay,this.alphaMode=s.alphaMode??"premultiply-alpha-on-upload",this.Xi=this.Xi.bind(this),this.Qi=null,this.Zi=null,this.Ki=null,this.Ji=null,this.te=this.te.bind(this),this.se=this.se.bind(this),this.ie=this.ie.bind(this),this.ee=this.ee.bind(this),this.ne=this.ne.bind(this),this.re=this.re.bind(this),!1!==s.autoLoad&&this.load()}updateFrame(){if(!this.destroyed){if(this.qi){const t=n.R.shared.elapsedMS*this.resource.playbackRate;this.Yi=Math.floor(this.Yi-t)}(!this.qi||this.Yi<=0)&&(this.Yi=this.qi?Math.floor(1e3/this.qi):0),this.isValid&&this.update()}}Xi(){this.updateFrame(),this.destroyed?this.Qi=null:this.Qi=this.resource.requestVideoFrameCallback(this.Xi)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this.Zi)return this.Zi;const t=this.resource,s=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this.ee),t.addEventListener("pause",this.ne),t.addEventListener("seeked",this.re),this.he()?this.oe():(s.preload||t.addEventListener("canplay",this.te),t.addEventListener("canplaythrough",this.se),t.addEventListener("error",this.ie,!0)),this.alphaMode=await(0,r.C)(),this.Zi=new Promise((i,e)=>{this.isValid?i(this):(this.Ki=i,this.Ji=e,void 0!==s.preloadTimeoutMs&&(this.ae=setTimeout(()=>{this.ie(new ErrorEvent(`Preload exceeded timeout of ${s.preloadTimeoutMs}ms`))})),t.load())}),this.Zi}ie(t){this.resource.removeEventListener("error",this.ie,!0),this.emit("error",t),this.Ji&&(this.Ji(t),this.Ji=null,this.Ki=null)}ce(){const t=this.resource;return!t.paused&&!t.ended}he(){return this.resource.readyState>2}ee(){this.isValid||this.oe(),this.le()}ne(){this.le()}re(){this.Li&&!this.ce()&&(this.Yi=0,this.updateFrame(),this.Yi=0)}te(){this.resource.removeEventListener("canplay",this.te),this.oe()}se(){this.resource.removeEventListener("canplaythrough",this.te),this.ae&&(clearTimeout(this.ae),this.ae=void 0),this.oe()}oe(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this.Yi=0,this.updateFrame(),this.Yi=0,this.Ki&&(this.Ki(this),this.Ki=null,this.Ji=null),this.ce()?this.ee():this.autoPlay&&this.resource.play()}destroy(){this.le();const t=this.resource;t&&(t.removeEventListener("play",this.ee),t.removeEventListener("pause",this.ne),t.removeEventListener("seeked",this.re),t.removeEventListener("canplay",this.te),t.removeEventListener("canplaythrough",this.se),t.removeEventListener("error",this.ie,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this.Li}set autoUpdate(t){t!==this.Li&&(this.Li=t,this.le())}get updateFPS(){return this.qi}set updateFPS(t){t!==this.qi&&(this.qi=t,this.le())}le(){this.Li&&this.ce()?!this.qi&&this.resource.requestVideoFrameCallback?(this.Hi&&(n.R.shared.remove(this.updateFrame,this),this.Hi=!1,this.Yi=0),null===this.Qi&&(this.Qi=this.resource.requestVideoFrameCallback(this.Xi))):(null!==this.Qi&&(this.resource.cancelVideoFrameCallback(this.Qi),this.Qi=null),this.Hi||(n.R.shared.add(this.updateFrame,this),this.Hi=!0,this.Yi=0)):(null!==this.Qi&&(this.resource.cancelVideoFrameCallback(this.Qi),this.Qi=null),this.Hi&&(n.R.shared.remove(this.updateFrame,this),this.Hi=!1,this.Yi=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};o.extension=e.Ag.TextureSource,o.defaultOptions={...h.v.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1},o.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let a=o},6302:(t,s,i)=>{"use strict";i.d(s,{GH:()=>lt});var e=i(8507),n=i(341),r=i(3721),h=i(848),o=i(4670),a=i(8655),c=i(9313),l=i(9252);function u(t,s,i,e,n){const r=s.a,h=s.b,o=s.c,a=s.d,c=s.tx,l=s.ty;i||(i=0),e||(e=2),n||(n=t.length/e-i);let u=i*e;for(let s=0;s<n;s++){const s=t[u],i=t[u+1];t[u]=r*s+o*i+c,t[u+1]=h*s+a*i+l,u+=e}}var d=i(5589),f=i(6954);const p={extension:{type:e.Ag.ShapeBuilder,name:"circle"},build(t,s){let i,e,n,r,h,o;if("circle"===t.type){const s=t;if(h=o=s.radius,h<=0)return!1;i=s.x,e=s.y,n=r=0}else if("ellipse"===t.type){const s=t;if(h=s.halfWidth,o=s.halfHeight,h<=0||o<=0)return!1;i=s.x,e=s.y,n=r=0}else{const s=t,a=s.width/2,c=s.height/2;i=s.x+a,e=s.y+c,h=o=Math.max(0,Math.min(s.radius,Math.min(a,c))),n=a-h,r=c-o}if(n<0||r<0)return!1;const a=Math.ceil(2.3*Math.sqrt(h+o)),c=8*a+(n?4:0)+(r?4:0);if(0===c)return!1;if(0===a)return s[0]=s[6]=i+n,s[1]=s[3]=e+r,s[2]=s[4]=i-n,s[5]=s[7]=e-r,!0;let l=0,u=4*a+(n?2:0)+2,d=u,f=c,p=n+h,g=r,m=i+p,y=i-p,b=e+g;if(s[l++]=m,s[l++]=b,s[--u]=b,s[--u]=y,r){const t=e-g;s[d++]=y,s[d++]=t,s[--f]=t,s[--f]=m}for(let t=1;t<a;t++){const c=Math.PI/2*(t/a),p=n+Math.cos(c)*h,g=r+Math.sin(c)*o,m=i+p,y=i-p,b=e+g,w=e-g;s[l++]=m,s[l++]=b,s[--u]=b,s[--u]=y,s[d++]=y,s[d++]=w,s[--f]=w,s[--f]=m}p=n,g=r+o,m=i+p,y=i-p,b=e+g;const w=e-g;return s[l++]=m,s[l++]=b,s[--f]=w,s[--f]=m,n&&(s[l++]=y,s[l++]=b,s[--f]=w,s[--f]=y),!0},triangulate(t,s,i,e,n,r){if(0===t.length)return;let h=0,o=0;for(let s=0;s<t.length;s+=2)h+=t[s],o+=t[s+1];h/=t.length/2,o/=t.length/2;let a=e;s[a*i]=h,s[a*i+1]=o;const c=a++;for(let e=0;e<t.length;e+=2)s[a*i]=t[e],s[a*i+1]=t[e+1],e>0&&(n[r++]=a,n[r++]=c,n[r++]=a-1),a++;n[r++]=c+1,n[r++]=c,n[r++]=a-1}},g={...p,extension:{...p.extension,name:"ellipse"}},m={...p,extension:{...p.extension,name:"roundedRectangle"}};var y=i(5101);const b=1e-4;function w(t,s,i,e,n,r,h,o){let a,c;h?(a=e,c=-i):(a=-e,c=i);const l=t-i*n+a,u=s-e*n+c,d=t+i*r+a,f=s+e*r+c;return o.push(l,u),o.push(d,f),2}function v(t,s,i,e,n,r,h,o){const a=i-t,c=e-s;let l=Math.atan2(a,c),u=Math.atan2(n-t,r-s);o&&l<u?l+=2*Math.PI:!o&&l>u&&(u+=2*Math.PI);let d=l;const f=u-l,p=Math.abs(f),g=Math.sqrt(a*a+c*c),m=1+(15*p*Math.sqrt(g)/Math.PI|0),y=f/m;if(d+=y,o){h.push(t,s),h.push(i,e);for(let i=1,e=d;i<m;i++,e+=y)h.push(t,s),h.push(t+Math.sin(e)*g,s+Math.cos(e)*g);h.push(t,s),h.push(n,r)}else{h.push(i,e),h.push(t,s);for(let i=1,e=d;i<m;i++,e+=y)h.push(t+Math.sin(e)*g,s+Math.cos(e)*g),h.push(t,s);h.push(n,r),h.push(t,s)}return 2*m}function x(t,s,i=2){const e=s&&s.length,n=e?s[0]*i:t.length;let r=A(t,0,n,i,!0);const h=[];if(!r||r.next===r.prev)return h;let o,a,c;if(e&&(r=function(t,s,i,e){const n=[];for(let i=0,r=s.length;i<r;i++){const h=A(t,s[i]*e,i<r-1?s[i+1]*e:t.length,e,!1);h===h.next&&(h.steiner=!0),n.push(R(h))}n.sort(P);for(let t=0;t<n.length;t++)i=I(n[t],i);return i}(t,s,r,i)),t.length>80*i){o=t[0],a=t[1];let s=o,e=a;for(let r=i;r<n;r+=i){const i=t[r],n=t[r+1];i<o&&(o=i),n<a&&(a=n),i>s&&(s=i),n>e&&(e=n)}c=Math.max(s-o,e-a),c=0!==c?32767/c:0}return k(r,h,i,o,a,c,0),h}function A(t,s,i,e,n){let r;if(n===function(t,s,i,e){let n=0;for(let r=s,h=i-e;r<i;r+=e)n+=(t[h]-t[r])*(t[r+1]+t[h+1]),h=r;return n}(t,s,i,e)>0)for(let n=s;n<i;n+=e)r=V(n/e|0,t[n],t[n+1],r);else for(let n=i-e;n>=s;n-=e)r=V(n/e|0,t[n],t[n+1],r);return r&&_(r,r.next)&&(L(r),r=r.next),r}function M(t,s){if(!t)return t;s||(s=t);let i,e=t;do{if(i=!1,e.steiner||!_(e,e.next)&&0!==j(e.prev,e,e.next))e=e.next;else{if(L(e),e=s=e.prev,e===e.next)break;i=!0}}while(i||e!==s);return s}function k(t,s,i,e,n,r,h){if(!t)return;!h&&r&&function(t,s,i,e){let n=t;do{0===n.z&&(n.z=B(n.x,n.y,s,i,e)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){let s,i=1;do{let e,n=t;t=null;let r=null;for(s=0;n;){s++;let h=n,o=0;for(let t=0;t<i&&(o++,h=h.nextZ,h);t++);let a=i;for(;o>0||a>0&&h;)0!==o&&(0===a||!h||n.z<=h.z)?(e=n,n=n.nextZ,o--):(e=h,h=h.nextZ,a--),r?r.nextZ=e:t=e,e.prevZ=r,r=e;n=h}r.nextZ=null,i*=2}while(s>1)}(n)}(t,e,n,r);let o=t;for(;t.prev!==t.next;){const a=t.prev,c=t.next;if(r?C(t,e,n,r):S(t))s.push(a.i,t.i,c.i),L(t),t=c.next,o=c.next;else if((t=c)===o){h?1===h?k(t=T(M(t),s),s,i,e,n,r,2):2===h&&$(t,s,i,e,n,r):k(M(t),s,i,e,n,r,1);break}}}function S(t){const s=t.prev,i=t,e=t.next;if(j(s,i,e)>=0)return!1;const n=s.x,r=i.x,h=e.x,o=s.y,a=i.y,c=e.y,l=Math.min(n,r,h),u=Math.min(o,a,c),d=Math.max(n,r,h),f=Math.max(o,a,c);let p=e.next;for(;p!==s;){if(p.x>=l&&p.x<=d&&p.y>=u&&p.y<=f&&G(n,o,r,a,h,c,p.x,p.y)&&j(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function C(t,s,i,e){const n=t.prev,r=t,h=t.next;if(j(n,r,h)>=0)return!1;const o=n.x,a=r.x,c=h.x,l=n.y,u=r.y,d=h.y,f=Math.min(o,a,c),p=Math.min(l,u,d),g=Math.max(o,a,c),m=Math.max(l,u,d),y=B(f,p,s,i,e),b=B(g,m,s,i,e);let w=t.prevZ,v=t.nextZ;for(;w&&w.z>=y&&v&&v.z<=b;){if(w.x>=f&&w.x<=g&&w.y>=p&&w.y<=m&&w!==n&&w!==h&&G(o,l,a,u,c,d,w.x,w.y)&&j(w.prev,w,w.next)>=0)return!1;if(w=w.prevZ,v.x>=f&&v.x<=g&&v.y>=p&&v.y<=m&&v!==n&&v!==h&&G(o,l,a,u,c,d,v.x,v.y)&&j(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;w&&w.z>=y;){if(w.x>=f&&w.x<=g&&w.y>=p&&w.y<=m&&w!==n&&w!==h&&G(o,l,a,u,c,d,w.x,w.y)&&j(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;v&&v.z<=b;){if(v.x>=f&&v.x<=g&&v.y>=p&&v.y<=m&&v!==n&&v!==h&&G(o,l,a,u,c,d,v.x,v.y)&&j(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function T(t,s){let i=t;do{const e=i.prev,n=i.next.next;!_(e,n)&&O(e,i,i.next,n)&&W(e,n)&&W(n,e)&&(s.push(e.i,i.i,n.i),L(i),L(i.next),i=t=n),i=i.next}while(i!==t);return M(i)}function $(t,s,i,e,n,r){let h=t;do{let t=h.next.next;for(;t!==h.prev;){if(h.i!==t.i&&F(h,t)){let o=N(h,t);return h=M(h,h.next),o=M(o,o.next),k(h,s,i,e,n,r,0),void k(o,s,i,e,n,r,0)}t=t.next}h=h.next}while(h!==t)}function P(t,s){let i=t.x-s.x;return 0===i&&(i=t.y-s.y,0===i)&&(i=(t.next.y-t.y)/(t.next.x-t.x)-(s.next.y-s.y)/(s.next.x-s.x)),i}function I(t,s){const i=function(t,s){let i=s;const e=t.x,n=t.y;let r,h=-1/0;if(_(t,i))return i;do{if(_(t,i.next))return i.next;if(n<=i.y&&n>=i.next.y&&i.next.y!==i.y){const t=i.x+(n-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(t<=e&&t>h&&(h=t,r=i.x<i.next.x?i:i.next,t===e))return r}i=i.next}while(i!==s);if(!r)return null;const o=r,a=r.x,c=r.y;let l=1/0;i=r;do{if(e>=i.x&&i.x>=a&&e!==i.x&&z(n<c?e:h,n,a,c,n<c?h:e,n,i.x,i.y)){const s=Math.abs(n-i.y)/(e-i.x);W(i,t)&&(s<l||s===l&&(i.x>r.x||i.x===r.x&&E(r,i)))&&(r=i,l=s)}i=i.next}while(i!==o);return r}(t,s);if(!i)return s;const e=N(i,t);return M(e,e.next),M(i,i.next)}function E(t,s){return j(t.prev,t,s.prev)<0&&j(s.next,t,t.next)<0}function B(t,s,i,e,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*n|0)|t<<8))|t<<4))|t<<2))|t<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-e)*n|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function R(t){let s=t,i=t;do{(s.x<i.x||s.x===i.x&&s.y<i.y)&&(i=s),s=s.next}while(s!==t);return i}function z(t,s,i,e,n,r,h,o){return(n-h)*(s-o)>=(t-h)*(r-o)&&(t-h)*(e-o)>=(i-h)*(s-o)&&(i-h)*(r-o)>=(n-h)*(e-o)}function G(t,s,i,e,n,r,h,o){return!(t===h&&s===o)&&z(t,s,i,e,n,r,h,o)}function F(t,s){return t.next.i!==s.i&&t.prev.i!==s.i&&!function(t,s){let i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==s.i&&i.next.i!==s.i&&O(i,i.next,t,s))return!0;i=i.next}while(i!==t);return!1}(t,s)&&(W(t,s)&&W(s,t)&&function(t,s){let i=t,e=!1;const n=(t.x+s.x)/2,r=(t.y+s.y)/2;do{i.y>r!=i.next.y>r&&i.next.y!==i.y&&n<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(e=!e),i=i.next}while(i!==t);return e}(t,s)&&(j(t.prev,t,s.prev)||j(t,s.prev,s))||_(t,s)&&j(t.prev,t,t.next)>0&&j(s.prev,s,s.next)>0)}function j(t,s,i){return(s.y-t.y)*(i.x-s.x)-(s.x-t.x)*(i.y-s.y)}function _(t,s){return t.x===s.x&&t.y===s.y}function O(t,s,i,e){const n=D(j(t,s,i)),r=D(j(t,s,e)),h=D(j(i,e,t)),o=D(j(i,e,s));return n!==r&&h!==o||!(0!==n||!U(t,i,s))||!(0!==r||!U(t,e,s))||!(0!==h||!U(i,t,e))||!(0!==o||!U(i,s,e))}function U(t,s,i){return s.x<=Math.max(t.x,i.x)&&s.x>=Math.min(t.x,i.x)&&s.y<=Math.max(t.y,i.y)&&s.y>=Math.min(t.y,i.y)}function D(t){return t>0?1:t<0?-1:0}function W(t,s){return j(t.prev,t,t.next)<0?j(t,s,t.next)>=0&&j(t,t.prev,s)>=0:j(t,s,t.prev)<0||j(t,t.next,s)<0}function N(t,s){const i=H(t.i,t.x,t.y),e=H(s.i,s.x,s.y),n=t.next,r=s.prev;return t.next=s,s.prev=t,i.next=n,n.prev=i,e.next=i,i.prev=e,r.next=e,e.prev=r,e}function V(t,s,i,e){const n=H(t,s,i);return e?(n.next=e.next,n.prev=e,e.next.prev=n,e.next=n):(n.prev=n,n.next=n),n}function L(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function H(t,s,i){return{i:t,x:s,y:i,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}i(4486);const q=x.default||x;function Y(t,s,i,e,n,r,h){const o=q(t,s,2);if(!o)return;for(let t=0;t<o.length;t+=3)r[h++]=o[t]+n,r[h++]=o[t+1]+n,r[h++]=o[t+2]+n;let a=n*e;for(let s=0;s<t.length;s+=2)i[a]=t[s],i[a+1]=t[s+1],a+=e}const X=[],Q={extension:{type:e.Ag.ShapeBuilder,name:"polygon"},build(t,s){for(let i=0;i<t.points.length;i++)s[i]=t.points[i];return!0},triangulate(t,s,i,e,n,r){Y(t,X,s,i,e,n,r)}},Z={extension:{type:e.Ag.ShapeBuilder,name:"rectangle"},build(t,s){const i=t,e=i.x,n=i.y,r=i.width,h=i.height;return r>0&&h>0&&(s[0]=e,s[1]=n,s[2]=e+r,s[3]=n,s[4]=e+r,s[5]=n+h,s[6]=e,s[7]=n+h,!0)},triangulate(t,s,i,e,n,r){let h=0;s[(e*=i)+h]=t[0],s[e+h+1]=t[1],h+=i,s[e+h]=t[2],s[e+h+1]=t[3],h+=i,s[e+h]=t[6],s[e+h+1]=t[7],h+=i,s[e+h]=t[4],s[e+h+1]=t[5],h+=i;const o=e/i;n[r++]=o,n[r++]=o+1,n[r++]=o+2,n[r++]=o+1,n[r++]=o+3,n[r++]=o+2}},K={extension:{type:e.Ag.ShapeBuilder,name:"triangle"},build:(t,s)=>(s[0]=t.x,s[1]=t.y,s[2]=t.x2,s[3]=t.y2,s[4]=t.x3,s[5]=t.y3,!0),triangulate(t,s,i,e,n,r){let h=0;s[(e*=i)+h]=t[0],s[e+h+1]=t[1],h+=i,s[e+h]=t[2],s[e+h+1]=t[3],h+=i,s[e+h]=t[4],s[e+h+1]=t[5];const o=e/i;n[r++]=o,n[r++]=o+1,n[r++]=o+2}};var J=i(7276);const tt=new c.u,st=new l.M,it={};e.XO.handleByMap(e.Ag.ShapeBuilder,it),e.XO.add(Z,Q,K,p,g,m);const et=new l.M,nt=new c.u;function rt(t,s,i){const e=[],n=it.rectangle,r=et;r.x=t.dx,r.y=t.dy,r.width=t.dw,r.height=t.dh;const h=t.transform;if(!n.build(r,e))return;const{vertices:o,uvs:c,indices:l}=i,d=l.length,p=o.length/2;h&&u(e,h),n.triangulate(e,o,2,p,l,d);const g=t.image,m=g.uvs;c.push(m.x0,m.y0,m.x1,m.y1,m.x3,m.y3,m.x2,m.y2);const y=a.Z.get(f.G);y.indexOffset=d,y.indexSize=l.length-d,y.attributeOffset=p,y.attributeSize=o.length/2-p,y.baseColor=t.style,y.alpha=t.alpha,y.texture=g,y.geometryData=i,s.push(y)}function ht(t,s,i,e,n){const{vertices:r,uvs:h,indices:o}=n;t.shapePrimitives.forEach(({shape:t,transform:c,holes:l})=>{const p=[],g=it[t.type];if(!g.build(t,p))return;const m=o.length,x=r.length/2;let A="triangle-list";if(c&&u(p,c),i){const i=t.closePath??!0,e=s;e.pixelLine?(function(t,s,i,e){const n=b;if(0===t.length)return;const r=t[0],h=t[1],o=t[t.length-2],a=t[t.length-1],c=s||Math.abs(r-o)<n&&Math.abs(h-a)<n,l=i,u=t.length/2,d=l.length/2;for(let s=0;s<u;s++)l.push(t[2*s]),l.push(t[2*s+1]);for(let t=0;t<u-1;t++)e.push(d+t,d+t+1);c&&e.push(d+u-1,d)}(p,i,r,o),A="line-list"):function(t,s,i,e,n,r){const h=b;if(0===t.length)return;const o=s;let a=o.alignment;if(.5!==s.alignment){let s=function(t){const s=t.length;if(s<6)return 1;let i=0;for(let e=0,n=t[s-2],r=t[s-1];e<s;e+=2){const s=t[e],h=t[e+1];i+=(s-n)*(h+r),n=s,r=h}return i<0?-1:1}(t);a=(a-.5)*s+.5}const c=new y.b(t[0],t[1]),l=new y.b(t[t.length-2],t[t.length-1]),u=e,d=Math.abs(c.x-l.x)<h&&Math.abs(c.y-l.y)<h;if(u){t=t.slice(),d&&(t.pop(),t.pop(),l.set(t[t.length-2],t[t.length-1]));const s=.5*(c.x+l.x),i=.5*(l.y+c.y);t.unshift(s,i),t.push(s,i)}const f=n,p=t.length/2;let g=t.length;const m=f.length/2,x=o.width/2,A=x*x,M=o.miterLimit*o.miterLimit;let k=t[0],S=t[1],C=t[2],T=t[3],$=0,P=0,I=-(S-T),E=k-C,B=0,R=0,z=Math.sqrt(I*I+E*E);I/=z,E/=z,I*=x,E*=x;const G=2*(1-a),F=2*a;u||("round"===o.cap?g+=v(k-I*(G-F)*.5,S-E*(G-F)*.5,k-I*G,S-E*G,k+I*F,S+E*F,f,!0)+2:"square"===o.cap&&(g+=w(k,S,I,E,G,F,!0,f))),f.push(k-I*G,S-E*G),f.push(k+I*F,S+E*F);for(let s=1;s<p-1;++s){k=t[2*(s-1)],S=t[2*(s-1)+1],C=t[2*s],T=t[2*s+1],$=t[2*(s+1)],P=t[2*(s+1)+1],I=-(S-T),E=k-C,z=Math.sqrt(I*I+E*E),I/=z,E/=z,I*=x,E*=x,B=-(T-P),R=C-$,z=Math.sqrt(B*B+R*R),B/=z,R/=z,B*=x,R*=x;const i=C-k,e=S-T,n=C-$,r=P-T,h=i*n+e*r,a=e*n-r*i,c=a<0;if(Math.abs(a)<.001*Math.abs(h)){f.push(C-I*G,T-E*G),f.push(C+I*F,T+E*F),h>=0&&("round"===o.join?g+=v(C,T,C-I*G,T-E*G,C-B*G,T-R*G,f,!1)+4:g+=2,f.push(C-B*F,T-R*F),f.push(C+B*G,T+R*G));continue}const l=(-I+k)*(-E+T)-(-I+C)*(-E+S),u=(-B+$)*(-R+T)-(-B+C)*(-R+P),d=(i*u-n*l)/a,p=(r*l-e*u)/a,m=(d-C)*(d-C)+(p-T)*(p-T),y=C+(d-C)*G,b=T+(p-T)*G,w=C-(d-C)*F,j=T-(p-T)*F,_=c?G:F;m<=Math.min(i*i+e*e,n*n+r*r)+_*_*A?"bevel"===o.join||m/A>M?(c?(f.push(y,b),f.push(C+I*F,T+E*F),f.push(y,b),f.push(C+B*F,T+R*F)):(f.push(C-I*G,T-E*G),f.push(w,j),f.push(C-B*G,T-R*G),f.push(w,j)),g+=2):"round"===o.join?c?(f.push(y,b),f.push(C+I*F,T+E*F),g+=v(C,T,C+I*F,T+E*F,C+B*F,T+R*F,f,!0)+4,f.push(y,b),f.push(C+B*F,T+R*F)):(f.push(C-I*G,T-E*G),f.push(w,j),g+=v(C,T,C-I*G,T-E*G,C-B*G,T-R*G,f,!1)+4,f.push(C-B*G,T-R*G),f.push(w,j)):(f.push(y,b),f.push(w,j)):(f.push(C-I*G,T-E*G),f.push(C+I*F,T+E*F),"round"===o.join?g+=c?v(C,T,C+I*F,T+E*F,C+B*F,T+R*F,f,!0)+2:v(C,T,C-I*G,T-E*G,C-B*G,T-R*G,f,!1)+2:"miter"===o.join&&m/A<=M&&(c?(f.push(w,j),f.push(w,j)):(f.push(y,b),f.push(y,b)),g+=2),f.push(C-B*G,T-R*G),f.push(C+B*F,T+R*F),g+=2)}k=t[2*(p-2)],S=t[2*(p-2)+1],C=t[2*(p-1)],T=t[2*(p-1)+1],I=-(S-T),E=k-C,z=Math.sqrt(I*I+E*E),I/=z,E/=z,I*=x,E*=x,f.push(C-I*G,T-E*G),f.push(C+I*F,T+E*F),u||("round"===o.cap?g+=v(C-I*(G-F)*.5,T-E*(G-F)*.5,C-I*G,T-E*G,C+I*F,T+E*F,f,!1)+2:"square"===o.cap&&(g+=w(C,T,I,E,G,F,!1,f)));for(let t=m;t<g+m-2;++t)k=f[2*t],S=f[2*t+1],C=f[2*(t+1)],T=f[2*(t+1)+1],$=f[2*(t+2)],P=f[2*(t+2)+1],Math.abs(k*(T-P)+C*(P-S)+$*(S-T))<1e-8||r.push(t,t+1,t+2)}(p,e,0,i,r,o)}else if(l){const t=[],s=p.slice();(function(t){const s=[];for(let i=0;i<t.length;i++){const e=t[i].shape,n=[];it[e.type].build(e,n)&&s.push(n)}return s})(l).forEach(i=>{t.push(s.length/2),s.push(...i)}),Y(s,t,r,2,x,o,m)}else g.triangulate(p,r,2,x,o,m);const M=h.length/2,k=s.texture;if(k!==d.g.WHITE){const i=function(t,s,i,e){const n=s.matrix?t.copyFrom(s.matrix).invert():t.identity();if("local"===s.textureSpace){const t=i.getBounds(st);s.width&&t.pad(s.width);const{x:e,y:r}=t,h=1/t.width,o=1/t.height,a=-e*h,c=-r*o,l=n.a,u=n.b,d=n.c,f=n.d;n.a*=h,n.b*=h,n.c*=o,n.d*=o,n.tx=a*l+c*d+n.tx,n.ty=a*u+c*f+n.ty}else n.translate(s.texture.frame.x,s.texture.frame.y),n.scale(1/s.texture.source.width,1/s.texture.source.height);const r=s.texture.source.style;return s.fill instanceof J.St||"clamp-to-edge"!==r.addressMode||(r.addressMode="repeat",r.update()),e&&n.append(tt.copyFrom(e).invert()),n}(nt,s,t,c);!function(t,s,i,e,n,r,h,o=null){let a=0;i*=s,n*=r;const c=o.a,l=o.b,u=o.c,d=o.d,f=o.tx,p=o.ty;for(;a<h;){const h=t[i],o=t[i+1];e[n]=c*h+u*o+f,e[n+1]=l*h+d*o+p,n+=r,i+=s,a++}}(r,2,x,h,M,2,r.length/2-x,i)}else!function(t,s,i,e){let n=0;for(s*=2;n<e;)t[s]=0,t[s+1]=0,s+=2,n++}(h,M,0,r.length/2-x);const S=a.Z.get(f.G);S.indexOffset=m,S.indexSize=o.length-m,S.attributeOffset=x,S.attributeSize=r.length/2-x,S.baseColor=s.color,S.alpha=s.alpha,S.texture=k,S.geometryData=n,S.topology=A,e.push(S)})}class ot{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class at{constructor(){this.instructions=new h.L}init(t){this.batcher=new r.J({maxTextures:t}),this.instructions.reset()}get geometry(){return(0,o.t6)(o.Ek,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}}const ct=class t{constructor(t){this.ue={},this.de=Object.create(null),this.fe=t,t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(s){t.defaultOptions.bezierSmoothness=s?.bezierSmoothness??t.defaultOptions.bezierSmoothness}getContextRenderData(t){return this.de[t.uid]||this.pe(t)}updateGpuContext(t){let s=this.ue[t.uid]||this.ge(t);if(t.dirty){s?this.me(t):s=this.ge(t),function(t,s){const{geometryData:i,batches:e}=s;e.length=0,i.indices.length=0,i.vertices.length=0,i.uvs.length=0;for(let s=0;s<t.instructions.length;s++){const n=t.instructions[s];if("texture"===n.action)rt(n.data,e,i);else if("fill"===n.action||"stroke"===n.action){const t="stroke"===n.action,s=n.data.path.shapePath,r=n.data.style,h=n.data.hole;t&&h&&ht(h.shapePath,r,!0,e,i),h&&(s.shapePrimitives[s.shapePrimitives.length-1].holes=h.shapePath.shapePrimitives),ht(s,r,t,e,i)}}}(t,s);const i=t.batchMode;t.customShader||"no-batch"===i?s.isBatchable=!1:s.isBatchable="auto"!==i||s.geometryData.vertices.length<400,t.dirty=!1}return s}getGpuContext(t){return this.ue[t.uid]||this.ge(t)}pe(t){const s=a.Z.get(at,{maxTextures:this.fe.limits.maxBatchableTextures}),{batches:i,geometryData:e}=this.ue[t.uid],r=e.vertices.length,h=e.indices.length;for(let t=0;t<i.length;t++)i[t].applyTransform=!1;const o=s.batcher;o.ensureAttributeBuffer(r),o.ensureIndexBuffer(h),o.begin();for(let t=0;t<i.length;t++){const s=i[t];o.add(s)}o.finish(s.instructions);const c=o.geometry;c.indexBuffer.setDataWithSize(o.indexBuffer,o.indexSize,!0),c.buffers[0].setDataWithSize(o.attributeBuffer.float32View,o.attributeSize,!0);const l=o.batches;for(let t=0;t<l.length;t++){const s=l[t];s.bindGroup=(0,n.w)(s.textures.textures,s.textures.count,this.fe.limits.maxBatchableTextures)}return this.de[t.uid]=s,s}ge(t){const s=new ot;return s.context=t,this.ue[t.uid]=s,t.on("destroy",this.onGraphicsContextDestroy,this),this.ue[t.uid]}onGraphicsContextDestroy(t){this.me(t),t.off("destroy",this.onGraphicsContextDestroy,this),this.ue[t.uid]=null}me(t){const s=this.ue[t.uid];s.isBatchable||this.de[t.uid]&&(a.Z.return(this.getContextRenderData(t)),this.de[t.uid]=null),s.batches&&s.batches.forEach(t=>{a.Z.return(t)})}destroy(){for(const t in this.ue)this.ue[t]&&this.onGraphicsContextDestroy(this.ue[t].context)}};ct.extension={type:[e.Ag.WebGLSystem,e.Ag.WebGPUSystem,e.Ag.CanvasSystem],name:"graphicsContext"},ct.defaultOptions={bezierSmoothness:.5};let lt=ct},6512:(t,s,i)=>{"use strict";i.d(s,{u:()=>r});const e=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function n(t){let s="";for(let i=0;i<t;++i)i>0&&(s+="\nelse "),i<t-1&&(s+=`if(test == ${i}.0){}`);return s}function r(t,s){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const i=s.createShader(s.FRAGMENT_SHADER);try{for(;;){const r=e.replace(/%forloop%/gi,n(t));if(s.shaderSource(i,r),s.compileShader(i),s.getShaderParameter(i,s.COMPILE_STATUS))break;t=t/2|0}}finally{s.deleteShader(i)}return t}},6557:(t,s,i)=>{"use strict";var e=i(1979),n=i(8507),r=i(583),h=i(5589);const o=[];function a(t={}){const s=t&&t.resource,i=s?t.resource:t,e=s?t:{resource:t};for(let t=0;t<o.length;t++){const s=o[t];if(s.test(i))return new s(e)}throw new Error(`Could not find a source type for resource: ${e.resource}`)}n.XO.handleByList(n.Ag.TextureSource,o),h.g.from=function(t,s=!1){return"string"==typeof t?e.l.get(t):t instanceof r.v?new h.g({source:t}):function(t={},s=!1){const i=t&&t.resource,n=i?t.resource:t,r=i?t:{resource:t};if(!s&&e.l.has(n))return e.l.get(n);const o=new h.g({source:a(r)});return o.on("destroy",()=>{e.l.has(n)&&e.l.remove(n)}),s||e.l.set(n,o),o}(t,s)},r.v.from=a},6665:(t,s,i)=>{"use strict";i.d(s,{b:()=>e,m:()=>n});const e={name:"round-pixels-bit",vertex:{header:"\n            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>\n            {\n                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n            }\n        "}},n={name:"round-pixels-bit",vertex:{header:"\n            vec2 roundPixels(vec2 position, vec2 targetSize)\n            {\n                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n            }\n        "}}},6736:(t,s,i)=>{"use strict";function e(t,s){const i=t.byteLength/8|0,e=new Float64Array(t,0,i);new Float64Array(s,0,i).set(e);const n=t.byteLength-8*i;if(n>0){const e=new Uint8Array(t,8*i,n);new Uint8Array(s,8*i,n).set(e)}}i.d(s,{W:()=>e})},6844:(t,s,i)=>{"use strict";i.d(s,{k:()=>a});var e=i(2812),n=i(5589),r=i(2048),h=i(4670),o=i(4985);class a extends o.l{constructor(t=n.g.EMPTY){t instanceof n.g&&(t={texture:t});const{texture:s=n.g.EMPTY,anchor:i,roundPixels:r,width:h,height:o,...a}=t;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this.ye={minX:0,maxX:1,minY:0,maxY:0},this.be=new e.o({js:()=>{this.onViewUpdate()}}),i?this.anchor=i:s.defaultAnchor&&(this.anchor=s.defaultAnchor),this.texture=s,this.allowChildren=!1,this.roundPixels=r??!1,void 0!==h&&(this.width=h),void 0!==o&&(this.height=o)}static from(t,s=!1){return t instanceof n.g?new a(t):new a(n.g.from(t,s))}set texture(t){t||(t=n.g.EMPTY);const s=this.Nt;s!==t&&(s&&s.dynamic&&s.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this.Nt=t,this.we&&this.ve(this.we,this.Nt.orig.width),this.xe&&this.Ae(this.xe,this.Nt.orig.height),this.onViewUpdate())}get texture(){return this.Nt}get visualBounds(){return(0,r.y)(this.ye,this.be,this.Nt),this.ye}get sourceBounds(){return(0,h.t6)("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const t=this.be,s=this.Nt,i=this._i,{width:e,height:n}=s.orig;i.minX=-t.vs*e,i.maxX=i.minX+e,i.minY=-t.xs*n,i.maxY=i.minY+n}destroy(t=!1){if(super.destroy(t),"boolean"==typeof t?t:t?.texture){const s="boolean"==typeof t?t:t?.textureSource;this.Nt.destroy(s)}this.Nt=null,this.ye=null,this._i=null,this.be=null,this.ji=null}get anchor(){return this.be}set anchor(t){"number"==typeof t?this.be.set(t):this.be.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this.Nt.orig.width}set width(t){this.ve(t,this.Nt.orig.width),this.we=t}get height(){return Math.abs(this.scale.y)*this.Nt.orig.height}set height(t){this.Ae(t,this.Nt.orig.height),this.xe=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this.Nt.orig.width,t.height=Math.abs(this.scale.y)*this.Nt.orig.height,t}setSize(t,s){"object"==typeof t?(s=t.height??t.width,t=t.width):s??(s=t),void 0!==t&&this.ve(t,this.Nt.orig.width),void 0!==s&&this.Ae(s,this.Nt.orig.height)}}},6858:(t,s,i)=>{"use strict";i.d(s,{C:()=>r});var e=i(1761);let n;async function r(){return n??(n=(async()=>{const t=e.e.get().createCanvas(1,1).getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const s=await new Promise(t=>{const s=document.createElement("video");s.onloadeddata=()=>t(s),s.onerror=()=>t(null),s.autoplay=!1,s.crossOrigin="anonymous",s.preload="auto",s.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",s.load()});if(!s)return"premultiply-alpha-on-upload";const i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i);const n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,s);const r=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,r),t.deleteFramebuffer(n),t.deleteTexture(i),t.getExtension("WEBGL_lose_context")?.loseContext(),r[0]<=r[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),n}},6954:(t,s,i)=>{"use strict";i.d(s,{G:()=>h});var e=i(9313),n=i(4676);const r=new e.u;class h{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this.ci=null,this.li=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,s=t>>16|65280&t|(255&t)<<16,i=this.renderable;return i?(0,n.u)(s,i.groupColor)+(this.alpha*i.groupAlpha*255<<24):s+(255*this.alpha<<24)}get transform(){return this.renderable?.groupTransform||r}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this.ci=null,this.li=null}}},7073:(t,s,i)=>{"use strict";i.d(s,{M:()=>r,d:()=>h});var e=i(8507),n=i(2571);class r{static init(){globalThis.__PIXI_APP_INIT__?.(this,n.xv)}static destroy(){}}r.extension=e.Ag.Application;class h{constructor(t){this.fe=t}init(){globalThis.__PIXI_RENDERER_INIT__?.(this.fe,n.xv)}destroy(){this.fe=null}}h.extension={type:[e.Ag.WebGLSystem,e.Ag.WebGPUSystem],name:"initHook",priority:-10}},7269:(t,s,i)=>{"use strict";i.d(s,{n:()=>r});var e=i(9313),n=i(2208);function r(t,s,i){return s.clear(),i||(i=e.u.IDENTITY),h(t,s,i,t,!0),s.isValid||s.set(0,0,0,0),s}function h(t,s,i,r,o){let a;if(o)a=n.u.get(),a=i.copyTo(a);else{if(!t.visible||!t.measurable)return;t.updateLocalTransform();const s=t.localTransform;a=n.u.get(),a.appendFrom(s,i)}const c=s,l=!!t.effects.length;if(l&&(s=n.o.get().clear()),t.boundsArea)s.addRect(t.boundsArea,a);else{t.renderPipeId&&(s.matrix=a,s.addBounds(t.bounds));const i=t.children;for(let t=0;t<i.length;t++)h(i[t],s,a,r,!1)}if(l){for(let i=0;i<t.effects.length;i++)t.effects[i].addLocalBounds?.(s,r);c.addBounds(s,e.u.IDENTITY),n.o.return(s)}n.u.return(a)}},7276:(t,s,i)=>{"use strict";i.d(s,{St:()=>f});var e=i(2577),n=i(1761),r=i(9313),h=i(8293),o=i(5589),a=i(133),c=i(4670),l=i(2698);const u=[{offset:0,color:"white"},{offset:1,color:"black"}],d=class t{constructor(...s){this.uid=(0,a.L)("fillGradient"),this.Gs=0,this.type="linear",this.colorStops=[];let i=function(t){let s=t[0]??{};return("number"==typeof s||t[1])&&((0,c.t6)("8.5.2","use options object instead"),s={type:"linear",start:{x:t[0],y:t[1]},end:{x:t[2],y:t[3]},textureSpace:t[4],textureSize:t[5]??f.defaultLinearOptions.textureSize}),s}(s);i={..."radial"===i.type?t.defaultRadialOptions:t.defaultLinearOptions,...(0,l.S)(i)},this.Kt=i.textureSize,this.Me=i.wrapMode,"radial"===i.type?(this.center=i.center,this.outerCenter=i.outerCenter??this.center,this.innerRadius=i.innerRadius,this.outerRadius=i.outerRadius,this.scale=i.scale,this.rotation=i.rotation):(this.start=i.start,this.end=i.end),this.textureSpace=i.textureSpace,this.type=i.type,i.colorStops.forEach(t=>{this.addColorStop(t.offset,t.color)})}addColorStop(t,s){return this.colorStops.push({offset:t,color:e.Q.shared.setValue(s).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:t,y:s}=this.start,{x:i,y:e}=this.end,n=i-t,a=e-s;const c=n<0||a<0;if("clamp-to-edge"===this.Me){if(n<0){const s=t;t=i,i=s,n*=-1}if(a<0){const t=s;s=e,e=t,a*=-1}}const l=this.colorStops.length?this.colorStops:u,d=this.Kt,{canvas:f,context:m}=g(d,1),y=c?m.createLinearGradient(this.Kt,0,0,0):m.createLinearGradient(0,0,this.Kt,0);p(y,l),m.fillStyle=y,m.fillRect(0,0,d,1),this.texture=new o.g({source:new h.b({resource:f,addressMode:this.Me})});const b=Math.sqrt(n*n+a*a),w=Math.atan2(a,n),v=new r.u;v.scale(b/d,1),v.rotate(w),v.translate(t,s),"local"===this.textureSpace&&v.scale(d,d),this.transform=v}buildGradient(){this.texture||this.Gs++,"linear"===this.type?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:u,s=this.Kt,{canvas:i,context:e}=g(s,s),{x:n,y:a}=this.center,{x:c,y:l}=this.outerCenter,d=this.innerRadius,f=this.outerRadius,m=c-f,y=l-f,b=s/(2*f),w=(n-m)*b,v=(a-y)*b,x=e.createRadialGradient(w,v,d*b,(c-m)*b,(l-y)*b,f*b);p(x,t),e.fillStyle=t[t.length-1].color,e.fillRect(0,0,s,s),e.fillStyle=x,e.translate(w,v),e.rotate(this.rotation),e.scale(1,this.scale),e.translate(-w,-v),e.fillRect(0,0,s,s),this.texture=new o.g({source:new h.b({resource:i,addressMode:this.Me})});const A=new r.u;A.scale(1/b,1/b),A.translate(m,y),"local"===this.textureSpace&&A.scale(s,s),this.transform=A}destroy(){this.texture?.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this.Gs}`}};d.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"},d.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let f=d;function p(t,s){for(let i=0;i<s.length;i++){const e=s[i];t.addColorStop(e.offset,e.color)}}function g(t,s){const i=n.e.get().createCanvas(t,s),e=i.getContext("2d");return{canvas:i,context:e}}},7309:(t,s,i)=>{"use strict";i.d(s,{R:()=>h});var e=i(4458);class n{constructor(t,s=null,i=0,e=!1){this.next=null,this.previous=null,this.ke=!1,this.Se=t,this.Ri=s,this.priority=i,this.Ce=e}match(t,s=null){return this.Se===t&&this.Ri===s}emit(t){this.Se&&(this.Ri?this.Se.call(this.Ri,t):this.Se(t));const s=this.next;return this.Ce&&this.destroy(!0),this.ke&&(this.next=null),s}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this.ke=!0,this.Se=null,this.Ri=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const s=this.next;return this.next=t?null:s,this.previous=null,s}}const r=class t{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this.Te=null,this.$e=100,this.Pe=0,this.Ie=!1,this.Ee=-1,this.Be=new n(null,null,1/0),this.deltaMS=1/t.targetFPMS,this.elapsedMS=1/t.targetFPMS,this.Gs=t=>{this.Te=null,this.started&&(this.update(t),this.started&&null===this.Te&&this.Be.next&&(this.Te=requestAnimationFrame(this.Gs)))}}Re(){null===this.Te&&this.Be.next&&(this.lastTime=performance.now(),this.Ee=this.lastTime,this.Te=requestAnimationFrame(this.Gs))}ze(){null!==this.Te&&(cancelAnimationFrame(this.Te),this.Te=null)}Ge(){this.started?this.Re():this.autoStart&&this.start()}add(t,s,i=e.d.NORMAL){return this.Fe(new n(t,s,i))}addOnce(t,s,i=e.d.NORMAL){return this.Fe(new n(t,s,i,!0))}Fe(t){let s=this.Be.next,i=this.Be;if(s){for(;s;){if(t.priority>s.priority){t.connect(i);break}i=s,s=s.next}t.previous||t.connect(i)}else t.connect(i);return this.Ge(),this}remove(t,s){let i=this.Be.next;for(;i;)i=i.match(t,s)?i.destroy():i.next;return this.Be.next||this.ze(),this}get count(){if(!this.Be)return 0;let t=0,s=this.Be;for(;s=s.next;)t++;return t}start(){this.started||(this.started=!0,this.Re())}stop(){this.started&&(this.started=!1,this.ze())}destroy(){if(!this.Ie){this.stop();let t=this.Be.next;for(;t;)t=t.destroy(!0);this.Be.destroy(),this.Be=null}}update(s=performance.now()){let i;if(s>this.lastTime){if(i=this.elapsedMS=s-this.lastTime,i>this.$e&&(i=this.$e),i*=this.speed,this.Pe){const t=s-this.Ee|0;if(t<this.Pe)return;this.Ee=s-t%this.Pe}this.deltaMS=i,this.deltaTime=this.deltaMS*t.targetFPMS;const e=this.Be;let n=e.next;for(;n;)n=n.emit(this);e.next||this.ze()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=s}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this.$e}set minFPS(s){const i=Math.min(this.maxFPS,s),e=Math.min(Math.max(0,i)/1e3,t.targetFPMS);this.$e=1/e}get maxFPS(){return this.Pe?Math.round(1e3/this.Pe):0}set maxFPS(t){if(0===t)this.Pe=0;else{const s=Math.max(this.minFPS,t);this.Pe=1/(s/1e3)}}static get shared(){if(!t.je){const s=t.je=new t;s.autoStart=!0,s.Ie=!0}return t.je}static get system(){if(!t._e){const s=t._e=new t;s.autoStart=!0,s.Ie=!0}return t._e}};r.targetFPMS=.06;let h=r},7457:(t,s,i)=>{"use strict";i.d(s,{mc:()=>H,u:()=>V,ig:()=>N,fR:()=>L});var e=i(4486),n=i(2577),r=i(8507),h=i(9313),o=i(1652),a=i(2812),c=i(133),l=i(4670),u=i(268),d=i(8655);const f={get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(t){"boolean"==typeof t&&!1===t?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(!0===t?{}:t))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(t){(0,l.t6)("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(t)}};var p=i(9903);const g={allowChildren:!0,removeChildren(t=0,s){const i=s??this.children.length,e=i-t,n=[];if(e>0&&e<=i){for(let s=i-1;s>=t;s--){const t=this.children[s];t&&(n.push(t),t.parent=null)}(0,p.d)(this.children,t,i);const s=this.renderGroup||this.parentRenderGroup;s&&s.removeChildren(n);for(let t=0;t<n.length;++t){const s=n[t];s.parentRenderLayer?.detach(s),this.emit("childRemoved",s,this,t),n[t].emit("removed",this)}return n.length>0&&this.Ui++,n}if(0===e&&0===this.children.length)return n;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(t){const s=this.getChildAt(t);return this.removeChild(s)},getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]},setChildIndex(t,s){if(s<0||s>=this.children.length)throw new Error(`The index ${s} supplied is out of bounds ${this.children.length}`);this.getChildIndex(t),this.addChildAt(t,s)},getChildIndex(t){const s=this.children.indexOf(t);if(-1===s)throw new Error("The supplied Container must be a child of the caller");return s},addChildAt(t,s){this.allowChildren||(0,l.t6)(l.lj,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:i}=this;if(s<0||s>i.length)throw new Error(`${t}addChildAt: The index ${s} supplied is out of bounds ${i.length}`);if(t.parent){const i=t.parent.children.indexOf(t);if(t.parent===this&&i===s)return t;-1!==i&&t.parent.children.splice(i,1)}s===i.length?i.push(t):i.splice(s,0,t),t.parent=this,t.didChange=!0,t.Hs=15;const e=this.renderGroup||this.parentRenderGroup;return e&&e.addChild(t),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",t,this,s),t.emit("added",this),t},swapChildren(t,s){if(t===s)return;const i=this.getChildIndex(t),e=this.getChildIndex(s);this.children[i]=s,this.children[e]=t;const n=this.renderGroup||this.parentRenderGroup;n&&(n.structureDidChange=!0),this.Oe++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...t){return 1===t.length?this.reparentChildAt(t[0],this.children.length):(t.forEach(t=>this.reparentChildAt(t,this.children.length)),t[0])},reparentChildAt(t,s){if(t.parent===this)return this.setChildIndex(t,s),t;const i=t.worldTransform.clone();t.removeFromParent(),this.addChildAt(t,s);const e=this.worldTransform.clone();return e.invert(),i.prepend(e),t.setFromMatrix(i),t},replaceChild(t,s){t.updateLocalTransform(),this.addChildAt(s,this.getChildIndex(t)),s.setFromMatrix(t.localTransform),s.updateLocalTransform(),this.removeChild(t)}},m={collectRenderables(t,s,i){this.parentRenderLayer&&this.parentRenderLayer!==i||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(t,s,i):this.renderGroup?s.renderPipes.renderGroup.addRenderGroup(this.renderGroup,t):this.collectRenderablesWithEffects(t,s,i))},collectRenderablesSimple(t,s,i){const e=this.children,n=e.length;for(let r=0;r<n;r++)e[r].collectRenderables(t,s,i)},collectRenderablesWithEffects(t,s,i){const{renderPipes:e}=s;for(let s=0;s<this.effects.length;s++){const i=this.effects[s];e[i.pipe].push(i,this,t)}this.collectRenderablesSimple(t,s,i);for(let s=this.effects.length-1;s>=0;s--){const i=this.effects[s];e[i.pipe].pop(i,this,t)}}};var y=i(9049);const b=new class{constructor(){this.Ue=[],this.De=[],this.We=!1}init(){this.We||(this.We=!0,this.Ue.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this.De.push(t)}getMaskEffect(t){this.We||this.init();for(let s=0;s<this.De.length;s++){const i=this.De[s];if(i.test(t))return d.Z.get(i.maskClass,t)}return t}returnMaskEffect(t){d.Z.return(t)}};r.XO.handleByList(r.Ag.MaskEffect,b.Ue);const w={Ne:null,Ve:{inverse:!1},Le:null,effects:[],He(){const t=this.renderGroup||this.parentRenderGroup;t&&(t.structureDidChange=!0)},addEffect(t){-1===this.effects.indexOf(t)&&(this.effects.push(t),this.effects.sort((t,s)=>t.priority-s.priority),this.He(),this.qe())},removeEffect(t){const s=this.effects.indexOf(t);-1!==s&&(this.effects.splice(s,1),this.He(),this.qe())},set mask(t){const s=this.Ne;s?.mask!==t&&(s&&(this.removeEffect(s),b.returnMaskEffect(s),this.Ne=null),null!=t&&(this.Ne=b.getMaskEffect(t),this.addEffect(this.Ne)))},get mask(){return this.Ne?.mask},setMask(t){this.Ve={...this.Ve,...t},t.mask&&(this.mask=t.mask),this.He()},set filters(t){!Array.isArray(t)&&t&&(t=[t]);const s=this.Le||(this.Le=new y.a),i=t?.length>0,e=i!==s.filters?.length>0;t=Array.isArray(t)?t.slice(0):t,s.filters=Object.freeze(t),e&&(i?this.addEffect(s):(this.removeEffect(s),s.filters=t??null))},get filters(){return this.Le?.filters},set filterArea(t){this.Le||(this.Le=new y.a),this.Le.filterArea=t},get filterArea(){return this.Le?.filterArea}},v={label:null,get name(){return(0,l.t6)(l.lj,"Container.name property has been removed, use Container.label instead"),this.label},set name(t){(0,l.t6)(l.lj,"Container.name property has been removed, use Container.label instead"),this.label=t},getChildByName(t,s=!1){return this.getChildByLabel(t,s)},getChildByLabel(t,s=!1){const i=this.children;for(let s=0;s<i.length;s++){const e=i[s];if(e.label===t||t instanceof RegExp&&t.test(e.label))return e}if(s)for(let s=0;s<i.length;s++){const e=i[s].getChildByLabel(t,!0);if(e)return e}return null},getChildrenByLabel(t,s=!1,i=[]){const e=this.children;for(let s=0;s<e.length;s++){const n=e[s];(n.label===t||t instanceof RegExp&&t.test(n.label))&&i.push(n)}if(s)for(let s=0;s<e.length;s++)e[s].getChildrenByLabel(t,!0,i);return i}};var x=i(9636),A=i(2208);const M=new h.u,k={getFastGlobalBounds(t,s){s||(s=new x.c),s.clear(),this.Ye(!!t,s,this.parentRenderLayer),s.isValid||s.set(0,0,0,0);const i=this.renderGroup||this.parentRenderGroup;return s.applyMatrix(i.worldTransform),s},Ye(t,s,i){let e=s;if(t&&this.parentRenderLayer&&this.parentRenderLayer!==i)return;if(7!==this.localDisplayStatus||!this.measurable)return;const n=!!this.effects.length;if((this.renderGroup||n)&&(e=A.o.get().clear()),this.boundsArea)s.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const t=this.bounds;e.addFrame(t.minX,t.minY,t.maxX,t.maxY,this.groupTransform)}const s=this.children;for(let n=0;n<s.length;n++)s[n].Ye(t,e,i)}if(n){let t=!1;const i=this.renderGroup||this.parentRenderGroup;for(let s=0;s<this.effects.length;s++)this.effects[s].addBounds&&(t||(t=!0,e.applyMatrix(i.worldTransform)),this.effects[s].addBounds(e,!0));t&&e.applyMatrix(i.worldTransform.copyTo(M).invert()),s.addBounds(e),A.o.return(e)}else this.renderGroup&&(s.addBounds(e,this.relativeGroupTransform),A.o.return(e))}};var S=i(9443),C=i(753);function T(t){return((255&t)<<16)+(65280&t)+(t>>16&255)}const $={getGlobalAlpha(t){if(t)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let s=this.alpha,i=this.parent;for(;i;)s*=i.alpha,i=i.parent;return s},getGlobalTransform(t=new h.u,s){if(s)return t.copyFrom(this.worldTransform);this.updateLocalTransform();const i=(0,S.E)(this,A.u.get().identity());return t.appendFrom(this.localTransform,i),A.u.return(i),t},getGlobalTint(t){if(t)return this.renderGroup?T(this.renderGroup.worldColor):this.parentRenderGroup?T((0,C.j)(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let s=this.localColor,i=this.parent;for(;i;)s=(0,C.j)(s,i.localColor),i=i.parent;return T(s)}};var P=i(7269);function I(t,s){const i=t.children;for(let t=0;t<i.length;t++){const e=i[t],n=e.uid,r=(65535&e.Ui)<<16|65535&e.Oe,h=s.index;s.data[h]===n&&s.data[h+1]===r||(s.data[s.index]=n,s.data[s.index+1]=r,s.didChange=!0),s.index=h+2,e.children.length&&I(e,s)}return s.didChange}const E=new h.u,B={Xe:-1,Qe:null,ve(t,s){const i=Math.sign(this.scale.x)||1;this.scale.x=0!==s?t/s*i:i},Ae(t,s){const i=Math.sign(this.scale.y)||1;this.scale.y=0!==s?t/s*i:i},getLocalBounds(){this.Qe||(this.Qe={data:[],index:1,didChange:!1,localBounds:new x.c});const t=this.Qe;return t.index=1,t.didChange=!1,t.data[0]!==this.Ui&&(t.didChange=!0,t.data[0]=this.Ui),I(this,t),t.didChange&&(0,P.n)(this,t.localBounds,E),t.localBounds},getBounds(t,s){return(0,S.f)(this,t,s||new x.c)}},R={Ls:null,set onRender(t){const s=this.renderGroup||this.parentRenderGroup;if(!t)return this.Ls&&s?.removeOnRender(this),void(this.Ls=null);this.Ls||s?.addOnRender(this),this.Ls=t},get onRender(){return this.Ls}},z={Ze:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this.Ze},set zIndex(t){this.Ze!==t&&(this.Ze=t,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(G))}};function G(t,s){return t.Ze-s.Ze}var F=i(5101);const j={getGlobalPosition(t=new F.b,s=!1){return this.parent?this.parent.toGlobal(this.Ke,t,s):(t.x=this.Ke.x,t.y=this.Ke.y),t},toGlobal(t,s,i=!1){const e=this.getGlobalTransform(A.u.get(),i);return s=e.apply(t,s),A.u.return(e),s},toLocal(t,s,i,e){s&&(t=s.toGlobal(t,i,e));const n=this.getGlobalTransform(A.u.get(),e);return i=n.applyInverse(t,i),A.u.return(n),i}};var _=i(3284);const O=new a.o(null),U=new a.o(null),D=new a.o(null,1,1),W=new a.o(null),N=1,V=2,L=4;class H extends e.A{constructor(t={}){super(),this.uid=(0,c.L)("renderable"),this.Hs=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.parentRenderLayer=null,this.updateTick=-1,this.localTransform=new h.u,this.relativeGroupTransform=new h.u,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this.Ke=new a.o(this,0,0),this.Je=D,this.tn=U,this.sn=W,this.en=O,this.nn=1,this.rn=0,this.hn=0,this.an=1,this.cn=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this.Oe=0,this.Ui=0,this.ln=-1,this.effects=[],function(t,s,i={}){for(const e in s)i[e]||void 0===s[e]||(t[e]=s[e])}(this,t,{children:!0,parent:!0,effects:!0}),t.children?.forEach(t=>this.addChild(t)),t.parent?.addChild(this)}static mixin(t){(0,l.t6)("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),r.XO.mixin(H,t)}set un(t){this.Ui=t>>12&4095,this.Oe=4095&t}get un(){return 4095&this.Oe|(4095&this.Ui)<<12}addChild(...t){if(this.allowChildren||(0,l.t6)(l.lj,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let s=0;s<t.length;s++)this.addChild(t[s]);return t[0]}const s=t[0],i=this.renderGroup||this.parentRenderGroup;return s.parent===this?(this.children.splice(this.children.indexOf(s),1),this.children.push(s),i&&(i.structureDidChange=!0),s):(s.parent&&s.parent.removeChild(s),this.children.push(s),this.sortableChildren&&(this.sortDirty=!0),s.parent=this,s.didChange=!0,s.Hs=15,i&&i.addChild(s),this.emit("childAdded",s,this,this.children.length-1),s.emit("added",this),this.Ui++,0!==s.Ze&&s.depthOfChildModified(),s)}removeChild(...t){if(t.length>1){for(let s=0;s<t.length;s++)this.removeChild(t[s]);return t[0]}const s=t[0],i=this.children.indexOf(s);return i>-1&&(this.Ui++,this.children.splice(i,1),this.renderGroup?this.renderGroup.removeChild(s):this.parentRenderGroup&&this.parentRenderGroup.removeChild(s),s.parentRenderLayer&&s.parentRenderLayer.detach(s),s.parent=null,this.emit("childRemoved",s,this,i),s.emit("removed",this)),s}js(t){t&&t===this.en&&this.dn(),this.Oe++,this.didChange||(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t?.removeChild(this),this.renderGroup=d.Z.get(_.m,this),this.groupTransform=h.u.IDENTITY,t?.addChild(this),this.qe()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t?.removeChild(this),d.Z.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t?.addChild(this),this.qe()}qe(){this.isSimple=!this.renderGroup&&0===this.effects.length}get worldTransform(){return this.pn||(this.pn=new h.u),this.renderGroup?this.pn.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this.pn.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this.pn}get x(){return this.Ke.x}set x(t){this.Ke.x=t}get y(){return this.Ke.y}set y(t){this.Ke.y=t}get position(){return this.Ke}set position(t){this.Ke.copyFrom(t)}get rotation(){return this.cn}set rotation(t){this.cn!==t&&(this.cn=t,this.js(this.en))}get angle(){return this.rotation*o.bO}set angle(t){this.rotation=t*o.Td}get pivot(){return this.tn===U&&(this.tn=new a.o(this,0,0)),this.tn}set pivot(t){this.tn===U&&(this.tn=new a.o(this,0,0),this.sn!==W&&(0,u.R)("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),"number"==typeof t?this.tn.set(t):this.tn.copyFrom(t)}get skew(){return this.en===O&&(this.en=new a.o(this,0,0)),this.en}set skew(t){this.en===O&&(this.en=new a.o(this,0,0)),this.en.copyFrom(t)}get scale(){return this.Je===D&&(this.Je=new a.o(this,1,1)),this.Je}set scale(t){this.Je===D&&(this.Je=new a.o(this,0,0)),"string"==typeof t&&(t=parseFloat(t)),"number"==typeof t?this.Je.set(t):this.Je.copyFrom(t)}get origin(){return this.sn===W&&(this.sn=new a.o(this,0,0)),this.sn}set origin(t){this.sn===W&&(this.sn=new a.o(this,0,0),this.tn!==U&&(0,u.R)("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),"number"==typeof t?this.sn.set(t):this.sn.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const s=this.getLocalBounds().width;this.ve(t,s)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const s=this.getLocalBounds().height;this.Ae(t,s)}getSize(t){t||(t={});const s=this.getLocalBounds();return t.width=Math.abs(this.scale.x*s.width),t.height=Math.abs(this.scale.y*s.height),t}setSize(t,s){const i=this.getLocalBounds();"object"==typeof t?(s=t.height??t.width,t=t.width):s??(s=t),void 0!==t&&this.ve(t,i.width),void 0!==s&&this.Ae(s,i.height)}dn(){const t=this.cn,s=this.en;this.nn=Math.cos(t+s.xs),this.rn=Math.sin(t+s.xs),this.hn=-Math.sin(t-s.vs),this.an=Math.cos(t-s.vs)}updateTransform(t){return this.position.set("number"==typeof t.x?t.x:this.position.x,"number"==typeof t.y?t.y:this.position.y),this.scale.set("number"==typeof t.scaleX?t.scaleX||1:this.scale.x,"number"==typeof t.scaleY?t.scaleY||1:this.scale.y),this.rotation="number"==typeof t.rotation?t.rotation:this.rotation,this.skew.set("number"==typeof t.skewX?t.skewX:this.skew.x,"number"==typeof t.skewY?t.skewY:this.skew.y),this.pivot.set("number"==typeof t.pivotX?t.pivotX:this.pivot.x,"number"==typeof t.pivotY?t.pivotY:this.pivot.y),this.origin.set("number"==typeof t.originX?t.originX:this.origin.x,"number"==typeof t.originY?t.originY:this.origin.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this.Oe;if(this.ln===t)return;this.ln=t;const s=this.localTransform,i=this.Je,e=this.tn,n=this.sn,r=this.Ke,h=i.vs,o=i.xs,a=e.vs,c=e.xs,l=-n.vs,u=-n.xs;s.a=this.nn*h,s.b=this.rn*h,s.c=this.hn*o,s.d=this.an*o,s.tx=r.vs-(a*s.a+c*s.c)+(l*s.a+u*s.c)-l,s.ty=r.xs-(a*s.b+c*s.d)+(l*s.b+u*s.d)-u}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this.Hs|=N,this.js())}get alpha(){return this.localAlpha}set tint(t){const s=n.Q.shared.setValue(t??16777215).toBgrNumber();s!==this.localColor&&(this.localColor=s,this.Hs|=N,this.js())}get tint(){return T(this.localColor)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this.Hs|=V,this.localBlendMode=t,this.js())}get blendMode(){return this.localBlendMode}get visible(){return!!(2&this.localDisplayStatus)}set visible(t){const s=t?2:0;(2&this.localDisplayStatus)!==s&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this.Hs|=L,this.localDisplayStatus^=2,this.js())}get culled(){return!(4&this.localDisplayStatus)}set culled(t){const s=t?0:4;(4&this.localDisplayStatus)!==s&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this.Hs|=L,this.localDisplayStatus^=4,this.js())}get renderable(){return!!(1&this.localDisplayStatus)}set renderable(t){const s=t?1:0;(1&this.localDisplayStatus)!==s&&(this.Hs|=L,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this.js())}get isRenderable(){return 7===this.localDisplayStatus&&this.groupAlpha>0}destroy(t=!1){if(this.destroyed)return;let s;if(this.destroyed=!0,this.children.length&&(s=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this.Ne=null,this.Le=null,this.effects=null,this.Ke=null,this.Je=null,this.tn=null,this.sn=null,this.en=null,this.emit("destroyed",this),this.removeAllListeners(),("boolean"==typeof t?t:t?.children)&&s)for(let i=0;i<s.length;++i)s[i].destroy(t);this.renderGroup?.destroy(),this.renderGroup=null}}r.XO.mixin(H,g,k,j,R,B,w,v,z,{cullArea:null,cullable:!1,cullableChildren:!0},f,$,m)},7608:(t,s,i)=>{"use strict";i.d(s,{N:()=>h});var e=i(1761),n=i(9939),r=i(6083);const h=new class{constructor(t){this.gn=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}mn(t,s){const i=e.e.get().createCanvas();i.width=t,i.height=s;const n=i.getContext("2d");return{canvas:i,context:n}}getOptimalCanvasAndContext(t,s,i=1){t=Math.ceil(t*i-1e-6),s=Math.ceil(s*i-1e-6);const e=((t=(0,n.U5)(t))<<17)+((s=(0,n.U5)(s))<<1);this.gn[e]||(this.gn[e]=[]);let r=this.gn[e].pop();return r||(r=this.mn(t,s)),r}returnCanvasAndContext(t){const s=t.canvas,{width:i,height:e}=s,n=(i<<17)+(e<<1);t.context.resetTransform(),t.context.clearRect(0,0,i,e),this.gn[n].push(t)}clear(){this.gn={}}};r.L.register(h)},7729:(t,s,i)=>{"use strict";i.d(s,{C:()=>e});class e{constructor(t){this.items=[],this.yn=t}emit(t,s,i,e,n,r,h,o){const{name:a,items:c}=this;for(let l=0,u=c.length;l<u;l++)c[l][a](t,s,i,e,n,r,h,o);return this}add(t){return t[this.yn]&&(this.remove(t),this.items.push(t)),this}remove(t){const s=this.items.indexOf(t);return-1!==s&&this.items.splice(s,1),this}contains(t){return-1!==this.items.indexOf(t)}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this.yn=null}get empty(){return 0===this.items.length}get name(){return this.yn}}},7952:(t,s,i)=>{"use strict";i.d(s,{X:()=>r});const e=Object.create(null),n=Object.create(null);function r(t,s){let i=n[t];return void 0===i&&(void 0===e[s]&&(e[s]=1),n[t]=i=e[s]++),i}},8133:t=>{t.exports=function(t){var n=[];return t.replace(i,function(t,i,r){var h=i.toLowerCase();for(r=function(t){var s=t.match(e);return s?s.map(Number):[]}(r),"m"==h&&r.length>2&&(n.push([i].concat(r.splice(0,2))),h="l",i="m"==i?"l":"L");;){if(r.length==s[h])return r.unshift(i),n.push(r);if(r.length<s[h])throw new Error("malformed path data");n.push([i].concat(r.splice(0,s[h])))}}),n};var s={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},i=/([astvzqmhlc])([^astvzqmhlc]*)/gi,e=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},8288:(t,s,i)=>{"use strict";i.d(s,{T:()=>Z});var e=i(4486),n=i(2577),r=i(9313),h=i(5101),o=i(5589),a=i(133),c=i(4670),l=i(9636),u=i(268),d=i(8133),f=i(9252);class p{constructor(t=0,s=0,i=0){this.type="circle",this.x=t,this.y=s,this.radius=i}clone(){return new p(this.x,this.y,this.radius)}contains(t,s){if(this.radius<=0)return!1;const i=this.radius*this.radius;let e=this.x-t,n=this.y-s;return e*=e,n*=n,e+n<=i}strokeContains(t,s,i,e=.5){if(0===this.radius)return!1;const n=this.x-t,r=this.y-s,h=this.radius,o=(1-e)*i,a=Math.sqrt(n*n+r*r);return a<=h+o&&a>h-(i-o)}getBounds(t){return t||(t=new f.M),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=2*this.radius,t.height=2*this.radius,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class g{constructor(t=0,s=0,i=0,e=0){this.type="ellipse",this.x=t,this.y=s,this.halfWidth=i,this.halfHeight=e}clone(){return new g(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,s){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let i=(t-this.x)/this.halfWidth,e=(s-this.y)/this.halfHeight;return i*=i,e*=e,i+e<=1}strokeContains(t,s,i,e=.5){const{halfWidth:n,halfHeight:r}=this;if(n<=0||r<=0)return!1;const h=i*(1-e),o=i-h,a=n-o,c=r-o,l=n+h,u=r+h,d=t-this.x,f=s-this.y;return d*d/(a*a)+f*f/(c*c)>1&&d*d/(l*l)+f*f/(u*u)<=1}getBounds(t){return t||(t=new f.M),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=2*this.halfWidth,t.height=2*this.halfHeight,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function m(t,s,i,e,n,r){const h=n-i,o=r-e,a=h*h+o*o;let c,l,u=-1;0!==a&&(u=((t-i)*h+(s-e)*o)/a),u<0?(c=i,l=e):u>1?(c=n,l=r):(c=i+u*h,l=e+u*o);const d=t-c,f=s-l;return d*d+f*f}class y{constructor(...t){this.type="polygon";let s=Array.isArray(t[0])?t[0]:t;if("number"!=typeof s[0]){const t=[];for(let i=0,e=s.length;i<e;i++)t.push(s[i].x,s[i].y);s=t}this.points=s,this.closePath=!0}isClockwise(){let t=0;const s=this.points,i=s.length;for(let e=0;e<i;e+=2){const n=s[e],r=s[e+1];t+=(s[(e+2)%i]-n)*(s[(e+3)%i]+r)}return t<0}containsPolygon(t){const s=this.getBounds(void 0),i=t.getBounds(void 0);if(!s.containsRect(i))return!1;const e=t.points;for(let t=0;t<e.length;t+=2){const s=e[t],i=e[t+1];if(!this.contains(s,i))return!1}return!0}clone(){const t=this.points.slice(),s=new y(t);return s.closePath=this.closePath,s}contains(t,s){let i=!1;const e=this.points.length/2;for(let n=0,r=e-1;n<e;r=n++){const e=this.points[2*n],h=this.points[2*n+1],o=this.points[2*r],a=this.points[2*r+1];h>s!=a>s&&t<(s-h)/(a-h)*(o-e)+e&&(i=!i)}return i}strokeContains(t,s,i,e=.5){const n=i*i,r=n*(1-e),h=n-r,{points:o}=this,a=o.length-(this.closePath?0:2);for(let i=0;i<a;i+=2){const e=o[i],n=o[i+1],a=o[(i+2)%o.length],c=o[(i+3)%o.length];if(m(t,s,e,n,a,c)<=(Math.sign((a-e)*(s-n)-(c-n)*(t-e))<0?h:r))return!0}return!1}getBounds(t){t||(t=new f.M);const s=this.points;let i=1/0,e=-1/0,n=1/0,r=-1/0;for(let t=0,h=s.length;t<h;t+=2){const h=s[t],o=s[t+1];i=h<i?h:i,e=h>e?h:e,n=o<n?o:n,r=o>r?o:r}return t.x=i,t.width=e-i,t.y=n,t.height=r-n,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,s)=>`${t}, ${s}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return(0,c.t6)("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return(0,c.t6)("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const b=(t,s,i,e,n,r,h)=>{const o=t-i,a=s-e,c=Math.sqrt(o*o+a*a);return c>=n-r&&c<=n+h};class w{constructor(t=0,s=0,i=0,e=0,n=20){this.type="roundedRectangle",this.x=t,this.y=s,this.width=i,this.height=e,this.radius=n}getBounds(t){return t||(t=new f.M),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new w(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,s){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&s>=this.y&&s<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(s>=this.y+i&&s<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let e=t-(this.x+i),n=s-(this.y+i);const r=i*i;if(e*e+n*n<=r)return!0;if(e=t-(this.x+this.width-i),e*e+n*n<=r)return!0;if(n=s-(this.y+this.height-i),e*e+n*n<=r)return!0;if(e=t-(this.x+i),e*e+n*n<=r)return!0}return!1}strokeContains(t,s,i,e=.5){const{x:n,y:r,width:h,height:o,radius:a}=this,c=i*(1-e),l=i-c,u=n+a,d=r+a,f=n+h,p=r+o;return(t>=n-c&&t<=n+l||t>=f-l&&t<=f+c)&&s>=d&&s<=d+(o-2*a)||(s>=r-c&&s<=r+l||s>=p-l&&s<=p+c)&&t>=u&&t<=u+(h-2*a)||t<u&&s<d&&b(t,s,u,d,a,l,c)||t>f-a&&s<d&&b(t,s,f-a,d,a,l,c)||t>f-a&&s>p-a&&b(t,s,f-a,p-a,a,l,c)||t<u&&s>p-a&&b(t,s,u,p-a,a,l,c)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}var v=i(6302);const x=1.1920929e-7;function A(t,s,i,e,n,r,h,o,a,c){let l=(1-Math.min(.99,Math.max(0,c??v.GH.defaultOptions.bezierSmoothness)))/1;return l*=l,function(t,s,i,e,n,r,h,o,a,c){M(t,s,i,e,n,r,h,o,a,c,0),a.push(h,o)}(s,i,e,n,r,h,o,a,t,l),t}function M(t,s,i,e,n,r,h,o,a,c,l){if(l>8)return;Math.PI;const u=(t+i)/2,d=(s+e)/2,f=(i+n)/2,p=(e+r)/2,g=(n+h)/2,m=(r+o)/2,y=(u+f)/2,b=(d+p)/2,w=(f+g)/2,v=(p+m)/2,A=(y+w)/2,k=(b+v)/2;if(l>0){let l=h-t,u=o-s;const d=Math.abs((i-h)*u-(e-o)*l),f=Math.abs((n-h)*u-(r-o)*l);if(d>x&&f>x){if((d+f)*(d+f)<=c*(l*l+u*u))return void a.push(A,k)}else if(d>x){if(d*d<=c*(l*l+u*u))return void a.push(A,k)}else if(f>x){if(f*f<=c*(l*l+u*u))return void a.push(A,k)}else if(l=A-(t+h)/2,u=k-(s+o)/2,l*l+u*u<=c)return void a.push(A,k)}M(t,s,u,d,y,b,A,k,a,c,l+1),M(A,k,w,v,g,m,h,o,a,c,l+1)}function k(t,s,i,e,n,r,h,o){let a=(1-Math.min(.99,Math.max(0,o??v.GH.defaultOptions.bezierSmoothness)))/1;return a*=a,function(t,s,i,e,n,r,h,o){S(h,t,s,i,e,n,r,o,0),h.push(n,r)}(s,i,e,n,r,h,t,a),t}function S(t,s,i,e,n,r,h,o,a){if(a>8)return;Math.PI;const c=(s+e)/2,l=(i+n)/2,u=(e+r)/2,d=(n+h)/2,f=(c+u)/2,p=(l+d)/2;let g=r-s,m=h-i;const y=Math.abs((e-r)*m-(n-h)*g);if(y>1.1920929e-7){if(y*y<=o*(g*g+m*m))return void t.push(f,p)}else if(g=f-(s+r)/2,m=p-(i+h)/2,g*g+m*m<=o)return void t.push(f,p);S(t,s,i,c,l,f,p,o,a+1),S(t,f,p,u,d,r,h,o,a+1)}function C(t,s,i,e,n,r,h,o){let a=Math.abs(n-r);(!h&&n>r||h&&r>n)&&(a=2*Math.PI-a),o||(o=Math.max(6,Math.floor(6*Math.pow(e,1/3)*(a/Math.PI))));let c=a/(o=Math.max(o,3)),l=n;c*=h?-1:1;for(let n=0;n<o+1;n++){const n=s+Math.cos(l)*e,r=i+Math.sin(l)*e;t.push(n,r),l+=c}}const T=2*Math.PI,$={centerX:0,centerY:0,ang1:0,ang2:0},P=({x:t,y:s},i,e,n,r,h,o,a)=>{const c=n*(t*=i)-r*(s*=e),l=r*t+n*s;return a.x=c+h,a.y=l+o,a};function I(t,s){const i=-1.5707963267948966===s?-.551915024494:4/3*Math.tan(s/4),e=1.5707963267948966===s?.551915024494:i,n=Math.cos(t),r=Math.sin(t),h=Math.cos(t+s),o=Math.sin(t+s);return[{x:n-r*e,y:r+n*e},{x:h+o*e,y:o-h*e},{x:h,y:o}]}const E=(t,s,i,e)=>{let n=t*i+s*e;return n>1&&(n=1),n<-1&&(n=-1),(t*e-s*i<0?-1:1)*Math.acos(n)};const B=new f.M;class R{constructor(t){this.shapePrimitives=[],this.bn=null,this._i=new l.c,this.wn=t,this.signed=t.checkForHoles}moveTo(t,s){return this.startPoly(t,s),this}lineTo(t,s){this.vn();const i=this.bn.points,e=i[i.length-2],n=i[i.length-1];return e===t&&n===s||i.push(t,s),this}arc(t,s,i,e,n,r){return this.vn(!1),C(this.bn.points,t,s,i,e,n,r),this}arcTo(t,s,i,e,n){return this.vn(),function(t,s,i,e,n,r){const h=t[t.length-2],o=t[t.length-1]-i,a=h-s,c=n-i,l=e-s,u=Math.abs(o*l-a*c);if(u<1e-8||0===r)return void(t[t.length-2]===s&&t[t.length-1]===i||t.push(s,i));const d=o*o+a*a,f=c*c+l*l,p=o*c+a*l,g=r*Math.sqrt(d)/u,m=r*Math.sqrt(f)/u,y=g*p/d,b=m*p/f,w=g*l+m*a,v=g*c+m*o,x=a*(m+y),A=o*(m+y),M=l*(g+b),k=c*(g+b);C(t,w+s,v+i,r,Math.atan2(A-v,x-w),Math.atan2(k-v,M-w),a*c>l*o)}(this.bn.points,t,s,i,e,n),this}arcToSvg(t,s,i,e,n,r,h){return function(t,s,i,e,n,r,h,o=0,a=0,c=0){if(0===r||0===h)return;const l=Math.sin(o*T/360),u=Math.cos(o*T/360),d=u*(s-e)/2+l*(i-n)/2,f=-l*(s-e)/2+u*(i-n)/2;if(0===d&&0===f)return;r=Math.abs(r),h=Math.abs(h);const p=Math.pow(d,2)/Math.pow(r,2)+Math.pow(f,2)/Math.pow(h,2);p>1&&(r*=Math.sqrt(p),h*=Math.sqrt(p)),((t,s,i,e,n,r,h,o,a,c,l,u,d)=>{const f=Math.pow(n,2),p=Math.pow(r,2),g=Math.pow(l,2),m=Math.pow(u,2);let y=f*p-f*m-p*g;y<0&&(y=0),y/=f*m+p*g,y=Math.sqrt(y)*(h===o?-1:1);const b=y*n/r*u,w=y*-r/n*l,v=c*b-a*w+(t+i)/2,x=a*b+c*w+(s+e)/2,A=(l-b)/n,M=(u-w)/r,k=(-l-b)/n,S=(-u-w)/r,C=E(1,0,A,M);let $=E(A,M,k,S);0===o&&$>0&&($-=T),1===o&&$<0&&($+=T),d.centerX=v,d.centerY=x,d.ang1=C,d.ang2=$})(s,i,e,n,r,h,a,c,l,u,d,f,$);let{ang1:g,ang2:m}=$;const{centerX:y,centerY:b}=$;let w=Math.abs(m)/(T/4);Math.abs(1-w)<1e-7&&(w=1);const v=Math.max(Math.ceil(w),1);m/=v;let x=t[t.length-2],M=t[t.length-1];const k={x:0,y:0};for(let s=0;s<v;s++){const s=I(g,m),{x:i,y:e}=P(s[0],r,h,u,l,y,b,k),{x:n,y:o}=P(s[1],r,h,u,l,y,b,k),{x:a,y:c}=P(s[2],r,h,u,l,y,b,k);A(t,x,M,i,e,n,o,a,c),x=a,M=c,g+=m}}(this.bn.points,this.bn.lastX,this.bn.lastY,r,h,t,s,i,e,n),this}bezierCurveTo(t,s,i,e,n,r,h){this.vn();const o=this.bn;return A(this.bn.points,o.lastX,o.lastY,t,s,i,e,n,r,h),this}quadraticCurveTo(t,s,i,e,n){this.vn();const r=this.bn;return k(this.bn.points,r.lastX,r.lastY,t,s,i,e,n),this}closePath(){return this.endPoly(!0),this}addPath(t,s){this.endPoly(),s&&!s.isIdentity()&&(t=t.clone(!0)).transform(s);const i=this.shapePrimitives,e=i.length;for(let s=0;s<t.instructions.length;s++){const i=t.instructions[s];this[i.action](...i.data)}if(t.checkForHoles&&i.length-e>1){let t=null;for(let s=e;s<i.length;s++){const e=i[s];if("polygon"===e.shape.type){const n=e.shape,r=t?.shape;r&&r.containsPolygon(n)?(t.holes||(t.holes=[]),t.holes.push(e),i.copyWithin(s,s+1),i.length--,s--):t=e}}}return this}finish(t=!1){this.endPoly(t)}rect(t,s,i,e,n){return this.drawShape(new f.M(t,s,i,e),n),this}circle(t,s,i,e){return this.drawShape(new p(t,s,i),e),this}poly(t,s,i){const e=new y(t);return e.closePath=s,this.drawShape(e,i),this}regularPoly(t,s,i,e,n=0,r){e=Math.max(0|e,3);const h=-1*Math.PI/2+n,o=2*Math.PI/e,a=[];for(let n=0;n<e;n++){const e=h-n*o;a.push(t+i*Math.cos(e),s+i*Math.sin(e))}return this.poly(a,!0,r),this}roundPoly(t,s,i,e,n,r=0,h){if(e=Math.max(0|e,3),n<=0)return this.regularPoly(t,s,i,e,r);const o=i*Math.sin(Math.PI/e)-.001;n=Math.min(n,o);const a=-1*Math.PI/2+r,c=2*Math.PI/e,l=(e-2)*Math.PI/e/2;for(let r=0;r<e;r++){const e=r*c+a,o=t+i*Math.cos(e),u=s+i*Math.sin(e),d=e+Math.PI+l,f=e-Math.PI-l,p=o+n*Math.cos(d),g=u+n*Math.sin(d),m=o+n*Math.cos(f),y=u+n*Math.sin(f);0===r?this.moveTo(p,g):this.lineTo(p,g),this.quadraticCurveTo(o,u,m,y,h)}return this.closePath()}roundShape(t,s,i=!1,e){return t.length<3?this:(i?function(t,s,i,e){const n=(t,s)=>Math.sqrt((t.x-s.x)**2+(t.y-s.y)**2),r=(t,s,i)=>({x:t.x+(s.x-t.x)*i,y:t.y+(s.y-t.y)*i}),h=s.length;for(let o=0;o<h;o++){const a=s[(o+1)%h],c=a.radius??i;if(c<=0){0===o?t.moveTo(a.x,a.y):t.lineTo(a.x,a.y);continue}const l=s[o],u=s[(o+2)%h],d=n(l,a);let f;f=d<1e-4?a:r(a,l,Math.min(d/2,c)/d);const p=n(u,a);let g;g=p<1e-4?a:r(a,u,Math.min(p/2,c)/p),0===o?t.moveTo(f.x,f.y):t.lineTo(f.x,f.y),t.quadraticCurveTo(a.x,a.y,g.x,g.y,e)}}(this,t,s,e):function(t,s,i){const e=(t,s)=>{const i=s.x-t.x,e=s.y-t.y,n=Math.sqrt(i*i+e*e);return{len:n,nx:i/n,ny:e/n}},n=(s,i)=>{0===s?t.moveTo(i.x,i.y):t.lineTo(i.x,i.y)};let r=s[s.length-1];for(let h=0;h<s.length;h++){const o=s[h%s.length],a=o.radius??i;if(a<=0){n(h,o),r=o;continue}const c=s[(h+1)%s.length],l=e(o,r),u=e(o,c);if(l.len<1e-4||u.len<1e-4){n(h,o),r=o;continue}let d=Math.asin(l.nx*u.ny-l.ny*u.nx),f=1,p=!1;l.nx*u.nx-l.ny*-u.ny<0?d<0?d=Math.PI+d:(d=Math.PI-d,f=-1,p=!0):d>0&&(f=-1,p=!0);const g=d/2;let m,y=Math.abs(Math.cos(g)*a/Math.sin(g));y>Math.min(l.len/2,u.len/2)?(y=Math.min(l.len/2,u.len/2),m=Math.abs(y*Math.sin(g)/Math.cos(g))):m=a;const b=o.x+u.nx*y+-u.ny*m*f,w=o.y+u.ny*y+u.nx*m*f,v=Math.atan2(l.ny,l.nx)+Math.PI/2*f,x=Math.atan2(u.ny,u.nx)-Math.PI/2*f;0===h&&t.moveTo(b+Math.cos(v)*m,w+Math.sin(v)*m),t.arc(b,w,m,v,x,p),r=o}}(this,t,s),this.closePath())}filletRect(t,s,i,e,n){if(0===n)return this.rect(t,s,i,e);const r=Math.min(i,e)/2,h=Math.min(r,Math.max(-r,n)),o=t+i,a=s+e,c=h<0?-h:0,l=Math.abs(h);return this.moveTo(t,s+l).arcTo(t+c,s+c,t+l,s,l).lineTo(o-l,s).arcTo(o-c,s+c,o,s+l,l).lineTo(o,a-l).arcTo(o-c,a-c,t+i-l,a,l).lineTo(t+l,a).arcTo(t+c,a-c,t,a-l,l).closePath()}chamferRect(t,s,i,e,n,r){if(n<=0)return this.rect(t,s,i,e);const h=Math.min(n,Math.min(i,e)/2),o=t+i,a=s+e,c=[t+h,s,o-h,s,o,s+h,o,a-h,o-h,a,t+h,a,t,a-h,t,s+h];for(let t=c.length-1;t>=2;t-=2)c[t]===c[t-2]&&c[t-1]===c[t-3]&&c.splice(t-1,2);return this.poly(c,!0,r)}ellipse(t,s,i,e,n){return this.drawShape(new g(t,s,i,e),n),this}roundRect(t,s,i,e,n,r){return this.drawShape(new w(t,s,i,e,n),r),this}drawShape(t,s){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:s}),this}startPoly(t,s){let i=this.bn;return i&&this.endPoly(),i=new y,i.points.push(t,s),this.bn=i,this}endPoly(t=!1){const s=this.bn;return s&&s.points.length>2&&(s.closePath=t,this.shapePrimitives.push({shape:s})),this.bn=null,this}vn(t=!0){if(!this.bn&&(this.bn=new y,t)){const t=this.shapePrimitives[this.shapePrimitives.length-1];if(t){let s=t.shape.x,i=t.shape.y;if(t.transform&&!t.transform.isIdentity()){const e=t.transform,n=s;s=e.a*s+e.c*i+e.tx,i=e.b*n+e.d*i+e.ty}this.bn.points.push(s,i)}else this.bn.points.push(0,0)}}buildPath(){const t=this.wn;this.shapePrimitives.length=0,this.bn=null;for(let s=0;s<t.instructions.length;s++){const i=t.instructions[s];this[i.action](...i.data)}this.finish()}get bounds(){const t=this._i;t.clear();const s=this.shapePrimitives;for(let i=0;i<s.length;i++){const e=s[i],n=e.shape.getBounds(B);e.transform?t.addRect(n,e.transform):t.addRect(n)}return t}}class z{constructor(t,s=!1){this.instructions=[],this.uid=(0,a.L)("graphicsPath"),this.ti=!0,this.checkForHoles=s,"string"==typeof t?function(t,s){const i=d(t),e=[];let n=null,r=0,h=0;for(let t=0;t<i.length;t++){const o=i[t],a=o[0],c=o;switch(a){case"M":r=c[1],h=c[2],s.moveTo(r,h);break;case"m":r+=c[1],h+=c[2],s.moveTo(r,h);break;case"H":r=c[1],s.lineTo(r,h);break;case"h":r+=c[1],s.lineTo(r,h);break;case"V":h=c[1],s.lineTo(r,h);break;case"v":h+=c[1],s.lineTo(r,h);break;case"L":r=c[1],h=c[2],s.lineTo(r,h);break;case"l":r+=c[1],h+=c[2],s.lineTo(r,h);break;case"C":r=c[5],h=c[6],s.bezierCurveTo(c[1],c[2],c[3],c[4],r,h);break;case"c":s.bezierCurveTo(r+c[1],h+c[2],r+c[3],h+c[4],r+c[5],h+c[6]),r+=c[5],h+=c[6];break;case"S":r=c[3],h=c[4],s.bezierCurveToShort(c[1],c[2],r,h);break;case"s":s.bezierCurveToShort(r+c[1],h+c[2],r+c[3],h+c[4]),r+=c[3],h+=c[4];break;case"Q":r=c[3],h=c[4],s.quadraticCurveTo(c[1],c[2],r,h);break;case"q":s.quadraticCurveTo(r+c[1],h+c[2],r+c[3],h+c[4]),r+=c[3],h+=c[4];break;case"T":r=c[1],h=c[2],s.quadraticCurveToShort(r,h);break;case"t":r+=c[1],h+=c[2],s.quadraticCurveToShort(r,h);break;case"A":r=c[6],h=c[7],s.arcToSvg(c[1],c[2],c[3],c[4],c[5],r,h);break;case"a":r+=c[6],h+=c[7],s.arcToSvg(c[1],c[2],c[3],c[4],c[5],r,h);break;case"Z":case"z":s.closePath(),e.length>0&&(n=e.pop(),n?(r=n.startX,h=n.startY):(r=0,h=0)),n=null;break;default:(0,u.R)(`Unknown SVG path command: ${a}`)}"Z"!==a&&"z"!==a&&null===n&&(n={startX:r,startY:h},e.push(n))}}(t,this):this.instructions=t?.slice()??[]}get shapePath(){return this.xn||(this.xn=new R(this)),this.ti&&(this.ti=!1,this.xn.buildPath()),this.xn}addPath(t,s){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,s]}),this.ti=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this.ti=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this.ti=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this.ti=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this.ti=!0,this}bezierCurveToShort(t,s,i,e,n){const r=this.instructions[this.instructions.length-1],o=this.getLastPoint(h.b.shared);let a=0,c=0;if(r&&"bezierCurveTo"===r.action){a=r.data[2],c=r.data[3];const t=o.x,s=o.y;a=t+(t-a),c=s+(s-c)}else a=o.x,c=o.y;return this.instructions.push({action:"bezierCurveTo",data:[a,c,t,s,i,e,n]}),this.ti=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this.ti=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this.ti=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this.ti=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this.ti=!0,this}quadraticCurveToShort(t,s,i){const e=this.instructions[this.instructions.length-1],n=this.getLastPoint(h.b.shared);let r=0,o=0;if(e&&"quadraticCurveTo"===e.action){r=e.data[0],o=e.data[1];const t=n.x,s=n.y;r=t+(t-r),o=s+(s-o)}else r=n.x,o=n.y;return this.instructions.push({action:"quadraticCurveTo",data:[r,o,t,s,i]}),this.ti=!0,this}rect(t,s,i,e,n){return this.instructions.push({action:"rect",data:[t,s,i,e,n]}),this.ti=!0,this}circle(t,s,i,e){return this.instructions.push({action:"circle",data:[t,s,i,e]}),this.ti=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this.ti=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this.ti=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this.ti=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this.ti=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this.ti=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this.ti=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this.ti=!0,this}star(t,s,i,e,n,r,h){n||(n=e/2);const o=-1*Math.PI/2+r,a=2*i,c=2*Math.PI/a,l=[];for(let i=0;i<a;i++){const r=i%2?n:e,h=i*c+o;l.push(t+r*Math.cos(h),s+r*Math.sin(h))}return this.poly(l,!0,h),this}clone(t=!1){const s=new z;if(s.checkForHoles=this.checkForHoles,t)for(let t=0;t<this.instructions.length;t++){const i=this.instructions[t];s.instructions.push({action:i.action,data:i.data.slice()})}else s.instructions=this.instructions.slice();return s}clear(){return this.instructions.length=0,this.ti=!0,this}transform(t){if(t.isIdentity())return this;const s=t.a,i=t.b,e=t.c,n=t.d,r=t.tx,h=t.ty;let o=0,a=0,c=0,l=0,d=0,f=0,p=0,g=0;for(let m=0;m<this.instructions.length;m++){const y=this.instructions[m],b=y.data;switch(y.action){case"moveTo":case"lineTo":o=b[0],a=b[1],b[0]=s*o+e*a+r,b[1]=i*o+n*a+h;break;case"bezierCurveTo":c=b[0],l=b[1],d=b[2],f=b[3],o=b[4],a=b[5],b[0]=s*c+e*l+r,b[1]=i*c+n*l+h,b[2]=s*d+e*f+r,b[3]=i*d+n*f+h,b[4]=s*o+e*a+r,b[5]=i*o+n*a+h;break;case"quadraticCurveTo":c=b[0],l=b[1],o=b[2],a=b[3],b[0]=s*c+e*l+r,b[1]=i*c+n*l+h,b[2]=s*o+e*a+r,b[3]=i*o+n*a+h;break;case"arcToSvg":o=b[5],a=b[6],p=b[0],g=b[1],b[0]=s*p+e*g,b[1]=i*p+n*g,b[5]=s*o+e*a+r,b[6]=i*o+n*a+h;break;case"circle":b[4]=G(b[3],t);break;case"rect":b[4]=G(b[4],t);break;case"ellipse":b[8]=G(b[8],t);break;case"roundRect":b[5]=G(b[5],t);break;case"addPath":b[0].transform(t);break;case"poly":b[2]=G(b[2],t);break;default:(0,u.R)("unknown transform action",y.action)}}return this.ti=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let s=this.instructions.length-1,i=this.instructions[s];if(!i)return t.x=0,t.y=0,t;for(;"closePath"===i.action;){if(s--,s<0)return t.x=0,t.y=0,t;i=this.instructions[s]}switch(i.action){case"moveTo":case"lineTo":t.x=i.data[0],t.y=i.data[1];break;case"quadraticCurveTo":t.x=i.data[2],t.y=i.data[3];break;case"bezierCurveTo":t.x=i.data[4],t.y=i.data[5];break;case"arc":case"arcToSvg":t.x=i.data[5],t.y=i.data[6];break;case"addPath":i.data[0].getLastPoint(t)}return t}}function G(t,s){return t?t.prepend(s):s.clone()}var F=i(7276);function j(t,s,i){const e=t.getAttribute(s);return e?Number(e):i}function _(t){const s=j(t,"x1",0),i=j(t,"y1",0),e=j(t,"x2",1),r=j(t,"y2",0),h=t.getAttribute("gradientUnits")||"objectBoundingBox",o=new F.St(s,i,e,r,"objectBoundingBox"===h?"local":"global");for(let s=0;s<t.children.length;s++){const i=t.children[s],e=j(i,"offset",0),r=n.Q.shared.setValue(i.getAttribute("stop-color")).toNumber();o.addColorStop(e,r)}return o}function O(t){return(0,u.R)("[SVG Parser] Radial gradients are not yet supported"),new F.St(0,0,1,0)}function U(t){const s=t.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return s?s[1]:""}const D={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function W(t,s){const i=t.getAttribute("style"),e={},n={},r={strokeStyle:e,fillStyle:n,useFill:!1,useStroke:!1};for(const i in D){const e=t.getAttribute(i);e&&N(s,r,i,e.trim())}if(i){const t=i.split(";");for(let i=0;i<t.length;i++){const e=t[i].trim(),[n,h]=e.split(":");D[n]&&N(s,r,n,h.trim())}}return{strokeStyle:r.useStroke?e:null,fillStyle:r.useFill?n:null,useFill:r.useFill,useStroke:r.useStroke}}function N(t,s,i,e){switch(i){case"stroke":if("none"!==e){if(e.startsWith("url(")){const i=U(e);s.strokeStyle.fill=t.defs[i]}else s.strokeStyle.color=n.Q.shared.setValue(e).toNumber();s.useStroke=!0}break;case"stroke-width":s.strokeStyle.width=Number(e);break;case"fill":if("none"!==e){if(e.startsWith("url(")){const i=U(e);s.fillStyle.fill=t.defs[i]}else s.fillStyle.color=n.Q.shared.setValue(e).toNumber();s.useFill=!0}break;case"fill-opacity":s.fillStyle.alpha=Number(e);break;case"stroke-opacity":s.strokeStyle.alpha=Number(e);break;case"opacity":s.fillStyle.alpha=Number(e),s.strokeStyle.alpha=Number(e)}}function V(t){const s=t.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!s||s.length<4)return 0;const i=s.map(Number),e=[],n=[];for(let t=0;t<i.length;t+=2)t+1<i.length&&(e.push(i[t]),n.push(i[t+1]));if(0===e.length||0===n.length)return 0;const r=Math.min(...e),h=Math.max(...e),o=Math.min(...n);return(h-r)*(Math.max(...n)-o)}function L(t,s){const i=new z(t,!1);for(const t of i.instructions)s.instructions.push(t)}function H(t,s,i,e){const n=t.children,{fillStyle:r,strokeStyle:h}=W(t,s);r&&i?i={...i,...r}:r&&(i=r),h&&e?e={...e,...h}:h&&(e=h);const o=!i&&!e;let a,c,l,d,f,p,g,m,y,b,w,v,x,A,M,k,S;switch(o&&(i={color:0}),t.nodeName.toLowerCase()){case"path":{A=t.getAttribute("d");const n=t.getAttribute("fill-rule"),r=A.split(/(?=[Mm])/).filter(t=>t.trim().length>0),h="evenodd"===n,o=r.length>1;if(h&&o){const t=r.map(t=>({path:t,area:V(t)}));t.sort((t,s)=>s.area-t.area);const n=r.length>3||!function(t){if(t.length<=2)return!0;const s=t.map(t=>t.area).sort((t,s)=>s-t),[i,e]=s,n=s[s.length-1];return!(i/e>3&&e/n<2)}(t);if(n)for(let n=0;n<t.length;n++){const r=t[n],h=0===n;s.context.beginPath();const o=new z(void 0,!0);L(r.path,o),s.context.path(o),h?(i&&s.context.fill(i),e&&s.context.stroke(e)):s.context.cut()}else for(let n=0;n<t.length;n++){const r=t[n],h=n%2==1;s.context.beginPath();const o=new z(void 0,!0);L(r.path,o),s.context.path(o),h?s.context.cut():(i&&s.context.fill(i),e&&s.context.stroke(e))}}else M=new z(A,!n||"evenodd"===n),s.context.path(M),i&&s.context.fill(i),e&&s.context.stroke(e);break}case"circle":g=j(t,"cx",0),m=j(t,"cy",0),y=j(t,"r",0),s.context.ellipse(g,m,y,y),i&&s.context.fill(i),e&&s.context.stroke(e);break;case"rect":a=j(t,"x",0),c=j(t,"y",0),k=j(t,"width",0),S=j(t,"height",0),b=j(t,"rx",0),w=j(t,"ry",0),b||w?s.context.roundRect(a,c,k,S,b||w):s.context.rect(a,c,k,S),i&&s.context.fill(i),e&&s.context.stroke(e);break;case"ellipse":g=j(t,"cx",0),m=j(t,"cy",0),b=j(t,"rx",0),w=j(t,"ry",0),s.context.beginPath(),s.context.ellipse(g,m,b,w),i&&s.context.fill(i),e&&s.context.stroke(e);break;case"line":l=j(t,"x1",0),d=j(t,"y1",0),f=j(t,"x2",0),p=j(t,"y2",0),s.context.beginPath(),s.context.moveTo(l,d),s.context.lineTo(f,p),e&&s.context.stroke(e);break;case"polygon":x=t.getAttribute("points"),v=x.match(/\d+/g).map(t=>parseInt(t,10)),s.context.poly(v,!0),i&&s.context.fill(i),e&&s.context.stroke(e);break;case"polyline":x=t.getAttribute("points"),v=x.match(/\d+/g).map(t=>parseInt(t,10)),s.context.poly(v,!1),e&&s.context.stroke(e);break;case"g":case"svg":break;default:(0,u.R)(`[SVG parser] <${t.nodeName}> elements unsupported`)}o&&(i=null);for(let t=0;t<n.length;t++)H(n[t],s,i,e)}var q=i(990);const Y=new h.b,X=new r.u,Q=class t extends e.A{constructor(){super(...arguments),this.uid=(0,a.L)("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this.An=new z,this.Mn=new r.u,this.kn={...t.defaultFillStyle},this.Sn={...t.defaultStrokeStyle},this.Cn=[],this.Gs=0,this._i=new l.c,this.Oi=!0}clone(){const s=new t;return s.batchMode=this.batchMode,s.instructions=this.instructions.slice(),s.An=this.An.clone(),s.Mn=this.Mn.clone(),s.kn={...this.kn},s.Sn={...this.Sn},s.Cn=this.Cn.slice(),s._i=this._i.clone(),s.Oi=!0,s}get fillStyle(){return this.kn}set fillStyle(s){this.kn=(0,q.w)(s,t.defaultFillStyle)}get strokeStyle(){return this.Sn}set strokeStyle(s){this.Sn=(0,q.T)(s,t.defaultStrokeStyle)}setFillStyle(s){return this.kn=(0,q.w)(s,t.defaultFillStyle),this}setStrokeStyle(s){return this.Sn=(0,q.w)(s,t.defaultStrokeStyle),this}texture(t,s,i,e,r,h){return this.instructions.push({action:"texture",data:{image:t,dx:i||0,dy:e||0,dw:r||t.frame.width,dh:h||t.frame.height,transform:this.Mn.clone(),alpha:this.kn.alpha,style:s?n.Q.shared.setValue(s).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this.An=new z,this}fill(s,i){let e;const n=this.instructions[this.instructions.length-1];return e=0===this.Gs&&"stroke"===n?.action?n.data.path:this.An.clone(),e?(null!=s&&(void 0!==i&&"number"==typeof s&&((0,c.t6)(c.lj,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),s={color:s,alpha:i}),this.kn=(0,q.w)(s,t.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:e}}),this.onUpdate(),this.Tn(),this.Gs=0,this):this}Tn(){const{x:t,y:s}=this.An.getLastPoint(h.b.shared);this.An.clear(),this.An.moveTo(t,s)}stroke(s){let i;const e=this.instructions[this.instructions.length-1];return i=0===this.Gs&&"fill"===e?.action?e.data.path:this.An.clone(),i?(null!=s&&(this.Sn=(0,q.T)(s,t.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:i}}),this.onUpdate(),this.Tn(),this.Gs=0,this):this}cut(){for(let t=0;t<2;t++){const s=this.instructions[this.instructions.length-1-t],i=this.An.clone();if(s&&("stroke"===s.action||"fill"===s.action)){if(!s.data.hole){s.data.hole=i;break}s.data.hole.addPath(i)}}return this.Tn(),this}arc(t,s,i,e,n,r){this.Gs++;const h=this.Mn;return this.An.arc(h.a*t+h.c*s+h.tx,h.b*t+h.d*s+h.ty,i,e,n,r),this}arcTo(t,s,i,e,n){this.Gs++;const r=this.Mn;return this.An.arcTo(r.a*t+r.c*s+r.tx,r.b*t+r.d*s+r.ty,r.a*i+r.c*e+r.tx,r.b*i+r.d*e+r.ty,n),this}arcToSvg(t,s,i,e,n,r,h){this.Gs++;const o=this.Mn;return this.An.arcToSvg(t,s,i,e,n,o.a*r+o.c*h+o.tx,o.b*r+o.d*h+o.ty),this}bezierCurveTo(t,s,i,e,n,r,h){this.Gs++;const o=this.Mn;return this.An.bezierCurveTo(o.a*t+o.c*s+o.tx,o.b*t+o.d*s+o.ty,o.a*i+o.c*e+o.tx,o.b*i+o.d*e+o.ty,o.a*n+o.c*r+o.tx,o.b*n+o.d*r+o.ty,h),this}closePath(){return this.Gs++,this.An?.closePath(),this}ellipse(t,s,i,e){return this.Gs++,this.An.ellipse(t,s,i,e,this.Mn.clone()),this}circle(t,s,i){return this.Gs++,this.An.circle(t,s,i,this.Mn.clone()),this}path(t){return this.Gs++,this.An.addPath(t,this.Mn.clone()),this}lineTo(t,s){this.Gs++;const i=this.Mn;return this.An.lineTo(i.a*t+i.c*s+i.tx,i.b*t+i.d*s+i.ty),this}moveTo(t,s){this.Gs++;const i=this.Mn,e=this.An.instructions,n=i.a*t+i.c*s+i.tx,r=i.b*t+i.d*s+i.ty;return 1===e.length&&"moveTo"===e[0].action?(e[0].data[0]=n,e[0].data[1]=r,this):(this.An.moveTo(n,r),this)}quadraticCurveTo(t,s,i,e,n){this.Gs++;const r=this.Mn;return this.An.quadraticCurveTo(r.a*t+r.c*s+r.tx,r.b*t+r.d*s+r.ty,r.a*i+r.c*e+r.tx,r.b*i+r.d*e+r.ty,n),this}rect(t,s,i,e){return this.Gs++,this.An.rect(t,s,i,e,this.Mn.clone()),this}roundRect(t,s,i,e,n){return this.Gs++,this.An.roundRect(t,s,i,e,n,this.Mn.clone()),this}poly(t,s){return this.Gs++,this.An.poly(t,s,this.Mn.clone()),this}regularPoly(t,s,i,e,n=0,r){return this.Gs++,this.An.regularPoly(t,s,i,e,n,r),this}roundPoly(t,s,i,e,n,r){return this.Gs++,this.An.roundPoly(t,s,i,e,n,r),this}roundShape(t,s,i,e){return this.Gs++,this.An.roundShape(t,s,i,e),this}filletRect(t,s,i,e,n){return this.Gs++,this.An.filletRect(t,s,i,e,n),this}chamferRect(t,s,i,e,n,r){return this.Gs++,this.An.chamferRect(t,s,i,e,n,r),this}star(t,s,i,e,n=0,r=0){return this.Gs++,this.An.star(t,s,i,e,n,r,this.Mn.clone()),this}svg(t){return this.Gs++,function(t,s){if("string"==typeof t){const s=document.createElement("div");s.innerHTML=t.trim(),t=s.querySelector("svg")}const i={context:s,defs:{},path:new z};!function(t,s){const i=t.querySelectorAll("defs");for(let t=0;t<i.length;t++){const e=i[t];for(let t=0;t<e.children.length;t++){const i=e.children[t];switch(i.nodeName.toLowerCase()){case"lineargradient":s.defs[i.id]=_(i);break;case"radialgradient":s.defs[i.id]=O()}}}}(t,i);const e=t.children,{fillStyle:n,strokeStyle:r}=W(t,i);for(let t=0;t<e.length;t++){const s=e[t];"defs"!==s.nodeName.toLowerCase()&&H(s,i,n,r)}}(t,this),this}restore(){const t=this.Cn.pop();return t&&(this.Mn=t.transform,this.kn=t.fillStyle,this.Sn=t.strokeStyle),this}save(){return this.Cn.push({transform:this.Mn.clone(),fillStyle:{...this.kn},strokeStyle:{...this.Sn}}),this}getTransform(){return this.Mn}resetTransform(){return this.Mn.identity(),this}rotate(t){return this.Mn.rotate(t),this}scale(t,s=t){return this.Mn.scale(t,s),this}setTransform(t,s,i,e,n,h){return t instanceof r.u?(this.Mn.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this.Mn.set(t,s,i,e,n,h),this)}transform(t,s,i,e,n,h){return t instanceof r.u?(this.Mn.append(t),this):(X.set(t,s,i,e,n,h),this.Mn.append(X),this)}translate(t,s=t){return this.Mn.translate(t,s),this}clear(){return this.An.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.Oi=!0,this.dirty||(this.emit("update",this,16),this.dirty=!0)}get bounds(){if(!this.Oi)return this._i;this.Oi=!1;const t=this._i;t.clear();for(let s=0;s<this.instructions.length;s++){const i=this.instructions[s],e=i.action;if("fill"===e){const s=i.data;t.addBounds(s.path.bounds)}else if("texture"===e){const s=i.data;t.addFrame(s.dx,s.dy,s.dx+s.dw,s.dy+s.dh,s.transform)}if("stroke"===e){const s=i.data,e=s.style.alignment,n=s.style.width*(1-e),r=s.path.bounds;t.addFrame(r.minX-n,r.minY-n,r.maxX+n,r.maxY+n)}}return t}containsPoint(t){if(!this.bounds.containsPoint(t.x,t.y))return!1;const s=this.instructions;let i=!1;for(let e=0;e<s.length;e++){const n=s[e],r=n.data,h=r.path;if(!n.action||!h)continue;const o=r.style,a=h.shapePath.shapePrimitives;for(let s=0;s<a.length;s++){const e=a[s].shape;if(!o||!e)continue;const h=a[s].transform,c=h?h.applyInverse(t,Y):t;if("fill"===n.action)i=e.contains(c.x,c.y);else{const t=o;i=e.strokeContains(c.x,c.y,t.width,t.alignment)}const l=r.hole;if(l){const t=l.shapePath?.shapePrimitives;if(t)for(let s=0;s<t.length;s++)t[s].shape.contains(c.x,c.y)&&(i=!1)}if(i)return!0}}return i}destroy(t=!1){if(this.Cn.length=0,this.Mn=null,this.emit("destroy",this),this.removeAllListeners(),"boolean"==typeof t?t:t?.texture){const s="boolean"==typeof t?t:t?.textureSource;this.kn.texture&&(this.kn.fill&&"uid"in this.kn.fill?this.kn.fill.destroy():this.kn.texture.destroy(s)),this.Sn.texture&&(this.Sn.fill&&"uid"in this.Sn.fill?this.Sn.fill.destroy():this.Sn.texture.destroy(s))}this.kn=null,this.Sn=null,this.instructions=null,this.An=null,this._i=null,this.Cn=null,this.customShader=null,this.Mn=null}};Q.defaultFillStyle={color:16777215,alpha:1,texture:o.g.WHITE,matrix:null,fill:null,textureSpace:"local"},Q.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:o.g.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let Z=Q},8291:(t,s,i)=>{"use strict";i.d(s,{x:()=>f});var e=i(4486),n=i(2577),r=i(133),h=i(4670),o=i(268),a=i(7276),c=i(2806),l=i(8288),u=i(990);const d=class t extends e.A{constructor(s={}){super(),this.uid=(0,r.L)("textStyle"),this.Gs=0,function(t){const s=t;if("boolean"==typeof s.dropShadow&&s.dropShadow){const i=f.defaultDropShadow;t.dropShadow={alpha:s.dropShadowAlpha??i.alpha,angle:s.dropShadowAngle??i.angle,blur:s.dropShadowBlur??i.blur,color:s.dropShadowColor??i.color,distance:s.dropShadowDistance??i.distance}}if(void 0!==s.strokeThickness){(0,h.t6)(h.lj,"strokeThickness is now a part of stroke");const i=s.stroke;let e={};if(n.Q.isColorLike(i))e.color=i;else if(i instanceof a.St||i instanceof c.m)e.fill=i;else{if(!Object.hasOwnProperty.call(i,"color")&&!Object.hasOwnProperty.call(i,"fill"))throw new Error("Invalid stroke value.");e=i}t.stroke={...e,width:s.strokeThickness}}if(Array.isArray(s.fillGradientStops)){if((0,h.t6)(h.lj,"gradient fill is now a fill pattern: `new FillGradient(...)`"),!Array.isArray(s.fill)||0===s.fill.length)throw new Error("Invalid fill value. Expected an array of colors for gradient fill.");s.fill.length!==s.fillGradientStops.length&&(0,o.R)("The number of fill colors must match the number of fill gradient stops.");const i=new a.St({start:{x:0,y:0},end:{x:0,y:1},textureSpace:"local"}),e=s.fillGradientStops.slice(),r=s.fill.map(t=>n.Q.shared.setValue(t).toNumber());e.forEach((t,s)=>{i.addColorStop(t,r[s])}),t.fill={fill:i}}}(s);const i={...t.defaultTextStyle,...s};for(const t in i)this[t]=i[t];this.update(),this.Gs=0}get align(){return this.$n}set align(t){this.$n!==t&&(this.$n=t,this.update())}get breakWords(){return this.Pn}set breakWords(t){this.Pn!==t&&(this.Pn=t,this.update())}get dropShadow(){return this.In}set dropShadow(s){this.In!==s&&(this.In=null!==s&&"object"==typeof s?this.En({...t.defaultDropShadow,...s}):s?this.En({...t.defaultDropShadow}):null,this.update())}get fontFamily(){return this.Bn}set fontFamily(t){this.Bn!==t&&(this.Bn=t,this.update())}get fontSize(){return this.Rn}set fontSize(t){this.Rn!==t&&(this.Rn="string"==typeof t?parseInt(t,10):t,this.update())}get fontStyle(){return this.zn}set fontStyle(t){this.zn!==t&&(this.zn=t.toLowerCase(),this.update())}get fontVariant(){return this.Gn}set fontVariant(t){this.Gn!==t&&(this.Gn=t,this.update())}get fontWeight(){return this.Fn}set fontWeight(t){this.Fn!==t&&(this.Fn=t,this.update())}get leading(){return this.jn}set leading(t){this.jn!==t&&(this.jn=t,this.update())}get letterSpacing(){return this._n}set letterSpacing(t){this._n!==t&&(this._n=t,this.update())}get lineHeight(){return this.On}set lineHeight(t){this.On!==t&&(this.On=t,this.update())}get padding(){return this.Vt}set padding(t){this.Vt!==t&&(this.Vt=t,this.update())}get filters(){return this.Un}set filters(t){this.Un!==t&&(this.Un=Object.freeze(t),this.update())}get trim(){return this.Dn}set trim(t){this.Dn!==t&&(this.Dn=t,this.update())}get textBaseline(){return this.Wn}set textBaseline(t){this.Wn!==t&&(this.Wn=t,this.update())}get whiteSpace(){return this.Nn}set whiteSpace(t){this.Nn!==t&&(this.Nn=t,this.update())}get wordWrap(){return this.xi}set wordWrap(t){this.xi!==t&&(this.xi=t,this.update())}get wordWrapWidth(){return this.Vn}set wordWrapWidth(t){this.Vn!==t&&(this.Vn=t,this.update())}get fill(){return this.Ln}set fill(t){t!==this.Ln&&(this.Ln=t,this.Hn(t)&&(this.Ln=this.En({...l.T.defaultFillStyle,...t},()=>{this.ts=(0,u.w)({...this.Ln},l.T.defaultFillStyle)})),this.ts=(0,u.w)(0===t?"black":t,l.T.defaultFillStyle),this.update())}get stroke(){return this.qn}set stroke(t){t!==this.qn&&(this.qn=t,this.Hn(t)&&(this.qn=this.En({...l.T.defaultStrokeStyle,...t},()=>{this.ss=(0,u.T)({...this.qn},l.T.defaultStrokeStyle)})),this.ss=(0,u.T)(t,l.T.defaultStrokeStyle),this.update())}update(){this.Gs++,this.emit("update",this)}reset(){const s=t.defaultTextStyle;for(const t in s)this[t]=s[t]}get styleKey(){return`${this.uid}-${this.Gs}`}clone(){return new t({align:this.align,breakWords:this.breakWords,dropShadow:this.In?{...this.In}:null,fill:this.ts,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this.ss,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this.Un?[...this.Un]:void 0})}Yn(){let t=0;if(this.Un)for(let s=0;s<this.Un.length;s++)t+=this.Un[s].padding;return Math.max(this.Vt,t)}destroy(t=!1){if(this.removeAllListeners(),"boolean"==typeof t?t:t?.texture){const s="boolean"==typeof t?t:t?.textureSource;this.ts?.texture&&this.ts.texture.destroy(s),this.Ln?.texture&&this.Ln.texture.destroy(s),this.ss?.texture&&this.ss.texture.destroy(s),this.qn?.texture&&this.qn.texture.destroy(s)}this.ts=null,this.ss=null,this.dropShadow=null,this.qn=null,this.Ln=null}En(t,s){return new Proxy(t,{set:(t,i,e)=>(t[i]===e||(t[i]=e,s?.(i,e),this.update()),!0)})}Hn(t){return null!==(t??null)&&!(n.Q.isColorLike(t)||t instanceof a.St||t instanceof c.m)}};d.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5},d.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let f=d},8293:(t,s,i)=>{"use strict";i.d(s,{b:()=>r});var e=i(8507),n=i(583);class r extends n.v{constructor(t){super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}r.extension=e.Ag.TextureSource},8306:(t,s,i)=>{"use strict";i.d(s,{m:()=>n});const e={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function n(t){return e[t]??e.float32}},8475:(t,s,i)=>{"use strict";i.d(s,{M:()=>l});var e=i(4486),n=i(133),r=i(9113),h=i(3513),o=i(3012),a=i(5099),c=i(5811);class l extends e.A{constructor(t){super(),this.uid=(0,n.L)("shader"),this.Xn=Object.create(null),this.Qn=[];let{gpuProgram:s,glProgram:i,groups:e,resources:r,compatibleRenderers:o,groupMap:l}=t;this.gpuProgram=s,this.glProgram=i,void 0===o&&(o=0,s&&(o|=a.W.WEBGPU),i&&(o|=a.W.WEBGL)),this.compatibleRenderers=o;const u={};if(r||e||(r={}),r&&e)throw new Error("[Shader] Cannot have both resources and groups");if(!s&&e&&!l)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!s&&e&&l)for(const t in l)for(const s in l[t]){const i=l[t][s];u[i]={group:t,binding:s,name:i}}else if(s&&e&&!l){const t=s.structsAndGroups.groups;l={},t.forEach(t=>{l[t.group]=l[t.group]||{},l[t.group][t.binding]=t.name,u[t.name]=t})}else if(r){e={},l={},s&&s.structsAndGroups.groups.forEach(t=>{l[t.group]=l[t.group]||{},l[t.group][t.binding]=t.name,u[t.name]=t});let t=0;for(const s in r)u[s]||(e[99]||(e[99]=new h.T,this.Qn.push(e[99])),u[s]={group:99,binding:t,name:s},l[99]=l[99]||{},l[99][t]=s,t++);for(const t in r){const s=t;let i=r[t];i.source||i._||(i=new c.k(i));const n=u[s];n&&(e[n.group]||(e[n.group]=new h.T,this.Qn.push(e[n.group])),e[n.group].setResource(i,n.binding))}}this.groups=e,this.Xn=l,this.resources=this.Zn(e,u)}addResource(t,s,i){var e,n;(e=this.Xn)[s]||(e[s]={}),(n=this.Xn[s])[i]||(n[i]=t),this.groups[s]||(this.groups[s]=new h.T,this.Qn.push(this.groups[s]))}Zn(t,s){const i={};for(const e in s){const n=s[e];Object.defineProperty(i,n.name,{get:()=>t[n.group].getResource(n.binding),set(s){t[n.group].setResource(s,n.binding)}})}return i}destroy(t=!1){this.emit("destroy",this),t&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this.Xn=null,this.Qn.forEach(t=>{t.destroy()}),this.Qn=null,this.resources=null,this.groups=null}static from(t){const{gpu:s,gl:i,...e}=t;let n,h;return s&&(n=o.B.from(s)),i&&(h=r.M.from(i)),new l({gpuProgram:n,glProgram:h,...e})}}},8480:(t,s,i)=>{"use strict";var e=i(8507),n=i(6844),r=i(9636),h=i(9443);const o=new r.c;function a(t,s,i){const e=o;t.measurable=!0,(0,h.f)(t,i,e),s.addBoundsMask(e),t.measurable=!1}var c=i(7269),l=i(2208),u=i(268);function d(t,s,i){const e=l.o.get();t.measurable=!0;const n=l.u.get().identity(),r=f(t,i,n);(0,c.n)(t,e,r),t.measurable=!1,s.addBoundsMask(e),l.u.return(n),l.o.return(e)}function f(t,s,i){return t?(t!==s&&(f(t.parent,s,i),t.updateLocalTransform(),i.append(t.localTransform)),i):((0,u.R)("Mask bounds, renderable is not inside the root container"),i)}class p{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof n.k),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){null!==this.mask&&(this.mask.measurable=!0,this.mask=null)}addBounds(t,s){this.inverse||a(this.mask,t,s)}addLocalBounds(t,s){d(this.mask,t,s)}containsPoint(t,s){return s(this.mask,t)}destroy(){this.reset()}static test(t){return t instanceof n.k}}p.extension=e.Ag.MaskEffect;class g{constructor(t){this.priority=0,this.pipe="colorMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return"number"==typeof t}}g.extension=e.Ag.MaskEffect;var m=i(7457);class y{constructor(t){this.priority=0,this.pipe="stencilMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){null!==this.mask&&(this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null)}addBounds(t,s){a(this.mask,t,s)}addLocalBounds(t,s){d(this.mask,t,s)}containsPoint(t,s){return s(this.mask,t)}destroy(){this.reset()}static test(t){return t instanceof m.mc}}y.extension=e.Ag.MaskEffect;var b=i(4195),w=i(4884),v=i(8293),x=i(6139);i(6557),e.XO.add(p,g,y,x.$,v.b,w.q,b.P)},8507:(t,s,i)=>{"use strict";i.d(s,{Ag:()=>e,XO:()=>h});var e=(t=>(t.Application="application",t.WebGLPipes="webgl-pipes",t.WebGLPipesAdaptor="webgl-pipes-adaptor",t.WebGLSystem="webgl-system",t.WebGPUPipes="webgpu-pipes",t.WebGPUPipesAdaptor="webgpu-pipes-adaptor",t.WebGPUSystem="webgpu-system",t.CanvasSystem="canvas-system",t.CanvasPipesAdaptor="canvas-pipes-adaptor",t.CanvasPipes="canvas-pipes",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t.MaskEffect="mask-effect",t.BlendMode="blend-mode",t.TextureSource="texture-source",t.Environment="environment",t.ShapeBuilder="shape-builder",t.Batcher="batcher",t))(e||{});const n=t=>{if("function"==typeof t||"object"==typeof t&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={..."object"!=typeof t.extension?{type:t.extension}:t.extension,ref:t}}if("object"!=typeof t)throw new Error("Invalid extension type");return"string"==typeof(t={...t}).type&&(t.type=[t.type]),t},r=(t,s)=>n(t).priority??s,h={Kn:{},Jn:{},tr:{},remove(...t){return t.map(n).forEach(t=>{t.type.forEach(s=>this.Jn[s]?.(t))}),this},add(...t){return t.map(n).forEach(t=>{t.type.forEach(s=>{const i=this.Kn,e=this.tr;i[s]?i[s]?.(t):(e[s]=e[s]||[],e[s]?.push(t))})}),this},handle(t,s,i){const e=this.Kn,n=this.Jn;if(e[t]||n[t])throw new Error(`Extension type ${t} already has a handler`);e[t]=s,n[t]=i;const r=this.tr;return r[t]&&(r[t]?.forEach(t=>s(t)),delete r[t]),this},handleByMap(t,s){return this.handle(t,t=>{t.name&&(s[t.name]=t.ref)},t=>{t.name&&delete s[t.name]})},handleByNamedList(t,s,i=-1){return this.handle(t,t=>{s.findIndex(s=>s.name===t.name)>=0||(s.push({name:t.name,value:t.ref}),s.sort((t,s)=>r(s.value,i)-r(t.value,i)))},t=>{const i=s.findIndex(s=>s.name===t.name);-1!==i&&s.splice(i,1)})},handleByList(t,s,i=-1){return this.handle(t,t=>{s.includes(t.ref)||(s.push(t.ref),s.sort((t,s)=>r(s,i)-r(t,i)))},t=>{const i=s.indexOf(t.ref);-1!==i&&s.splice(i,1)})},mixin(t,...s){for(const i of s)Object.defineProperties(t.prototype,Object.getOwnPropertyDescriptors(i))}}},8639:(t,s,i)=>{"use strict";i.d(s,{i:()=>n});var e=i(1957);function n(t,s){return"no-premultiply-alpha"===s.alphaMode&&e.Q[t]||t}},8655:(t,s,i)=>{"use strict";i.d(s,{Z:()=>r});var e=i(6083);class n{constructor(t,s){this.sr=[],this.ir=0,this.er=0,this.nr=t,s&&this.prepopulate(s)}prepopulate(t){for(let s=0;s<t;s++)this.sr[this.er++]=new this.nr;this.ir+=t}get(t){let s;return s=this.er>0?this.sr[--this.er]:new this.nr,s.init?.(t),s}return(t){t.reset?.(),this.sr[this.er++]=t}get totalSize(){return this.ir}get totalFree(){return this.er}get totalUsed(){return this.ir-this.er}clear(){if(this.sr.length>0&&this.sr[0].destroy)for(let t=0;t<this.er;t++)this.sr[t].destroy();this.sr.length=0,this.ir=0,this.er=0}}const r=new class{constructor(){this.rr=new Map}prepopulate(t,s){this.getPool(t).prepopulate(s)}get(t,s){return this.getPool(t).get(s)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this.rr.has(t)||this.rr.set(t,new n(t)),this.rr.get(t)}stats(){const t={};return this.rr.forEach(s=>{const i=t[s.nr.name]?s.nr.name+s.nr.ID:s.nr.name;t[i]={free:s.totalFree,used:s.totalUsed,size:s.totalSize}}),t}clear(){this.rr.forEach(t=>t.clear()),this.rr.clear()}};e.L.register(r)},9010:(t,s,i)=>{"use strict";var e=i(8507),n=i(4589),r=i(1173),h=i(2233),o=i(5589),a=i(2927),c=i(9252),l=i(583);const u=class t{constructor(t,s){this.linkedSheets=[];let i=t;t?.source instanceof l.v&&(i={texture:t,data:s});const{texture:e,data:n,cachePrefix:r=""}=i;this.cachePrefix=r,this.Nt=e instanceof o.g?e:null,this.textureSource=e.source,this.textures={},this.animations={},this.data=n;const h=parseFloat(n.meta.scale);h?(this.resolution=h,e.source.resolution=this.resolution):this.resolution=e.source.et,this.hr=this.data.frames,this.ar=Object.keys(this.hr),this.cr=0,this.lr=null}parse(){return new Promise(s=>{this.lr=s,this.cr=0,this.ar.length<=t.BATCH_SIZE?(this.ur(0),this.dr(),this.pr()):this.gr()})}ur(s){let i=s;const e=t.BATCH_SIZE;for(;i-s<e&&i<this.ar.length;){const t=this.ar[i],s=this.hr[t],e=s.frame;if(e){let i=null,n=null;const r=!1!==s.trimmed&&s.sourceSize?s.sourceSize:s.frame,h=new c.M(0,0,Math.floor(r.w)/this.resolution,Math.floor(r.h)/this.resolution);i=s.rotated?new c.M(Math.floor(e.x)/this.resolution,Math.floor(e.y)/this.resolution,Math.floor(e.h)/this.resolution,Math.floor(e.w)/this.resolution):new c.M(Math.floor(e.x)/this.resolution,Math.floor(e.y)/this.resolution,Math.floor(e.w)/this.resolution,Math.floor(e.h)/this.resolution),!1!==s.trimmed&&s.spriteSourceSize&&(n=new c.M(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(e.w)/this.resolution,Math.floor(e.h)/this.resolution)),this.textures[t]=new o.g({source:this.textureSource,frame:i,orig:h,trim:n,rotate:s.rotated?2:0,defaultAnchor:s.anchor,defaultBorders:s.borders,label:t.toString()})}i++}}dr(){const t=this.data.animations||{};for(const s in t){this.animations[s]=[];for(let i=0;i<t[s].length;i++){const e=t[s][i];this.animations[s].push(this.textures[e])}}}pr(){const t=this.lr;this.lr=null,this.cr=0,t.call(this,this.textures)}gr(){this.ur(this.cr*t.BATCH_SIZE),this.cr++,setTimeout(()=>{this.cr*t.BATCH_SIZE<this.ar.length?this.gr():(this.dr(),this.pr())},0)}destroy(t=!1){for(const t in this.textures)this.textures[t].destroy();this.hr=null,this.ar=null,this.data=null,this.textures=null,t&&(this.Nt?.destroy(),this.textureSource.destroy()),this.Nt=null,this.textureSource=null,this.linkedSheets=[]}};u.BATCH_SIZE=1e3;let d=u;const f=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function p(t,s,i){const e={};if(t.forEach(t=>{e[t]=s}),Object.keys(s.textures).forEach(t=>{e[`${s.cachePrefix}${t}`]=s.textures[t]}),!i){const i=a.A.dirname(t[0]);s.linkedSheets.forEach((t,n)=>{const r=p([`${i}/${s.data.meta.related_multi_packs[n]}`],t,!0);Object.assign(e,r)})}return e}const g={extension:e.Ag.Asset,cache:{test:t=>t instanceof d,getCacheableAssets:(t,s)=>p(t,s,!1)},resolver:{extension:{type:e.Ag.ResolveParser,name:"resolveSpritesheet"},test:t=>{const s=t.split("?")[0].split("."),i=s.pop(),e=s.pop();return"json"===i&&f.includes(e)},parse:t=>{const s=t.split(".");return{resolution:parseFloat(r.x.RETINA_PREFIX.exec(t)?.[1]??"1"),format:s[s.length-2],src:t}}},loader:{name:"spritesheetLoader",id:"spritesheet",extension:{type:e.Ag.LoadParser,priority:n.T.Normal,name:"spritesheetLoader"},testParse:async(t,s)=>".json"===a.A.extname(s.src).toLowerCase()&&!!t.frames,async parse(t,s,i){const{texture:e,imageFilename:n,textureOptions:r,cachePrefix:c}=s?.data??{};let l,u=a.A.dirname(s.src);if(u&&u.lastIndexOf("/")!==u.length-1&&(u+="/"),e instanceof o.g)l=e;else{const e=(0,h.Y)(u+(n??t.meta.image),s.src);l=(await i.load([{src:e,data:r}]))[e]}const f=new d({texture:l.source,data:t,cachePrefix:c});await f.parse();const p=t?.meta?.related_multi_packs;if(Array.isArray(p)){const t=[];for(const e of p){if("string"!=typeof e)continue;let n=u+e;s.data?.ignoreMultiPack||(n=(0,h.Y)(n,s.src),t.push(i.load({src:n,data:{textureOptions:r,ignoreMultiPack:!0}})))}const e=await Promise.all(t);f.linkedSheets=e,e.forEach(t=>{t.linkedSheets=[f].concat(f.linkedSheets.filter(s=>s!==t))})}return f},async unload(t,s,i){await i.unload(t.textureSource.mr),t.destroy(!1)}}};e.XO.add(g)},9049:(t,s,i)=>{"use strict";i.d(s,{a:()=>e});class e{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}},9113:(t,s,i)=>{"use strict";i.d(s,{M:()=>d});var e=i(7952),n=i(3804);let r;function h(){if(!r){r="mediump";const t=(0,n.W)();if(t&&t.getShaderPrecisionFormat){const s=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);r=s.precision?"highp":"mediump"}}return r}const o={},a={},c={stripVersion:function(t,s){return s?t.replace("#version 300 es",""):t},ensurePrecision:function(t,s,i){const e=i?s.maxSupportedFragmentPrecision:s.maxSupportedVertexPrecision;if("precision"!==t.substring(0,9)){let n=i?s.requestedFragmentPrecision:s.requestedVertexPrecision;return"highp"===n&&"highp"!==e&&(n="mediump"),`precision ${n} float;\n${t}`}return"highp"!==e&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t},addProgramDefines:function(t,s,i){return s?t:i?`\n\n        #ifdef GL_ES // This checks if it is WebGL1\n        #define in varying\n        #define finalColor gl_FragColor\n        #define texture texture2D\n        #endif\n        ${t=t.replace("out vec4 finalColor;","")}\n        `:`\n\n        #ifdef GL_ES // This checks if it is WebGL1\n        #define in attribute\n        #define out varying\n        #endif\n        ${t}\n        `},setProgramName:function(t,{name:s="pixi-program"},i=!0){s=s.replace(/\s+/g,"-");const e=i?o:a;return e[s+=i?"-fragment":"-vertex"]?(e[s]++,s+=`-${e[s]}`):e[s]=1,-1!==t.indexOf("#define SHADER_NAME")?t:`#define SHADER_NAME ${s}\n${t}`},insertVersion:function(t,s){return s?`#version 300 es\n${t}`:t}},l=Object.create(null),u=class t{constructor(s){const i=-1!==(s={...t.defaultOptions,...s}).fragment.indexOf("#version 300 es"),n={stripVersion:i,ensurePrecision:{requestedFragmentPrecision:s.preferredFragmentPrecision,requestedVertexPrecision:s.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:h()},setProgramName:{name:s.name},addProgramDefines:i,insertVersion:i};let r=s.fragment,o=s.vertex;Object.keys(c).forEach(t=>{const s=n[t];r=c[t](r,s,!0),o=c[t](o,s,!1)}),this.fragment=r,this.vertex=o,this.transformFeedbackVaryings=s.transformFeedbackVaryings,this.ii=(0,e.X)(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this.Ds=null,this.yr=null,this.br=null,this.transformFeedbackVaryings=null,l[this.Ws]=null}static from(s){const i=`${s.vertex}:${s.fragment}`;return l[i]||(l[i]=new t(s),l[i].Ws=i),l[i]}};u.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let d=u},9252:(t,s,i)=>{"use strict";i.d(s,{M:()=>r});var e=i(5101);const n=[new e.b,new e.b,new e.b,new e.b];class r{constructor(t=0,s=0,i=0,e=0){this.type="rectangle",this.x=Number(t),this.y=Number(s),this.width=Number(i),this.height=Number(e)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new r(0,0,0,0)}clone(){return new r(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,s){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&s>=this.y&&s<this.y+this.height}strokeContains(t,s,i,e=.5){const{width:n,height:r}=this;if(n<=0||r<=0)return!1;const h=this.x,o=this.y,a=i*(1-e),c=i-a;return t>=h-a&&t<=h+n+a&&s>=o-a&&s<=o+r+a&&!(t>h+c&&t<h+n-c&&s>o+c&&s<o+r-c)}intersects(t,s){if(!s){const s=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=s)return!1;const i=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>i}const i=this.left,e=this.right,r=this.top,h=this.bottom;if(e<=i||h<=r)return!1;const o=n[0].set(t.left,t.top),a=n[1].set(t.left,t.bottom),c=n[2].set(t.right,t.top),l=n[3].set(t.right,t.bottom);if(c.x<=o.x||a.y<=o.y)return!1;const u=Math.sign(s.a*s.d-s.b*s.c);if(0===u)return!1;if(s.apply(o,o),s.apply(a,a),s.apply(c,c),s.apply(l,l),Math.max(o.x,a.x,c.x,l.x)<=i||Math.min(o.x,a.x,c.x,l.x)>=e||Math.max(o.y,a.y,c.y,l.y)<=r||Math.min(o.y,a.y,c.y,l.y)>=h)return!1;const d=u*(a.y-o.y),f=u*(o.x-a.x),p=d*i+f*r,g=d*e+f*r,m=d*i+f*h,y=d*e+f*h;if(Math.max(p,g,m,y)<=d*o.x+f*o.y||Math.min(p,g,m,y)>=d*l.x+f*l.y)return!1;const b=u*(o.y-c.y),w=u*(c.x-o.x),v=b*i+w*r,x=b*e+w*r,A=b*i+w*h,M=b*e+w*h;return!(Math.max(v,x,A,M)<=b*o.x+w*o.y||Math.min(v,x,A,M)>=b*l.x+w*l.y)}pad(t=0,s=t){return this.x-=t,this.y-=s,this.width+=2*t,this.height+=2*s,this}fit(t){const s=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),e=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=s,this.width=Math.max(i-s,0),this.y=e,this.height=Math.max(n-e,0),this}ceil(t=1,s=.001){const i=Math.ceil((this.x+this.width-s)*t)/t,e=Math.ceil((this.y+this.height-s)*t)/t;return this.x=Math.floor((this.x+s)*t)/t,this.y=Math.floor((this.y+s)*t)/t,this.width=i-this.x,this.height=e-this.y,this}scale(t,s=t){return this.x*=t,this.y*=s,this.width*=t,this.height*=s,this}enlarge(t){const s=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),e=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=s,this.width=i-s,this.y=e,this.height=n-e,this}getBounds(t){return t||(t=new r),t.copyFrom(this),t}containsRect(t){if(this.width<=0||this.height<=0)return!1;const s=t.x,i=t.y,e=t.x+t.width,n=t.y+t.height;return s>=this.x&&s<this.x+this.width&&i>=this.y&&i<this.y+this.height&&e>=this.x&&e<this.x+this.width&&n>=this.y&&n<this.y+this.height}set(t,s,i,e){return this.x=t,this.y=s,this.width=i,this.height=e,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}},9313:(t,s,i)=>{"use strict";i.d(s,{u:()=>r});var e=i(1652),n=i(5101);class r{constructor(t=1,s=0,i=0,e=1,n=0,r=0){this.array=null,this.a=t,this.b=s,this.c=i,this.d=e,this.tx=n,this.ty=r}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,s,i,e,n,r){return this.a=t,this.b=s,this.c=i,this.d=e,this.tx=n,this.ty=r,this}toArray(t,s){this.array||(this.array=new Float32Array(9));const i=s||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,s){s=s||new n.b;const i=t.x,e=t.y;return s.x=this.a*i+this.c*e+this.tx,s.y=this.b*i+this.d*e+this.ty,s}applyInverse(t,s){s=s||new n.b;const i=this.a,e=this.b,r=this.c,h=this.d,o=this.tx,a=this.ty,c=1/(i*h+r*-e),l=t.x,u=t.y;return s.x=h*c*l+-r*c*u+(a*r-o*h)*c,s.y=i*c*u+-e*c*l+(-a*i+o*e)*c,s}translate(t,s){return this.tx+=t,this.ty+=s,this}scale(t,s){return this.a*=t,this.d*=s,this.c*=t,this.b*=s,this.tx*=t,this.ty*=s,this}rotate(t){const s=Math.cos(t),i=Math.sin(t),e=this.a,n=this.c,r=this.tx;return this.a=e*s-this.b*i,this.b=e*i+this.b*s,this.c=n*s-this.d*i,this.d=n*i+this.d*s,this.tx=r*s-this.ty*i,this.ty=r*i+this.ty*s,this}append(t){const s=this.a,i=this.b,e=this.c,n=this.d;return this.a=t.a*s+t.b*e,this.b=t.a*i+t.b*n,this.c=t.c*s+t.d*e,this.d=t.c*i+t.d*n,this.tx=t.tx*s+t.ty*e+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this}appendFrom(t,s){const i=t.a,e=t.b,n=t.c,r=t.d,h=t.tx,o=t.ty,a=s.a,c=s.b,l=s.c,u=s.d;return this.a=i*a+e*l,this.b=i*c+e*u,this.c=n*a+r*l,this.d=n*c+r*u,this.tx=h*a+o*l+s.tx,this.ty=h*c+o*u+s.ty,this}setTransform(t,s,i,e,n,r,h,o,a){return this.a=Math.cos(h+a)*n,this.b=Math.sin(h+a)*n,this.c=-Math.sin(h-o)*r,this.d=Math.cos(h-o)*r,this.tx=t-(i*this.a+e*this.c),this.ty=s-(i*this.b+e*this.d),this}prepend(t){const s=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){const s=this.a,i=this.c;this.a=s*t.a+this.b*t.c,this.b=s*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=s*t.a+this.ty*t.c+t.tx,this.ty=s*t.b+this.ty*t.d+t.ty,this}decompose(t){const s=this.a,i=this.b,n=this.c,r=this.d,h=t.pivot,o=-Math.atan2(-n,r),a=Math.atan2(i,s),c=Math.abs(o+a);return c<1e-5||Math.abs(e.TO-c)<1e-5?(t.rotation=a,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=a),t.scale.x=Math.sqrt(s*s+i*i),t.scale.y=Math.sqrt(n*n+r*r),t.position.x=this.tx+(h.x*s+h.y*n),t.position.y=this.ty+(h.x*i+h.y*r),t}invert(){const t=this.a,s=this.b,i=this.c,e=this.d,n=this.tx,r=t*e-s*i;return this.a=e/r,this.b=-s/r,this.c=-i/r,this.d=t/r,this.tx=(i*this.ty-e*n)/r,this.ty=-(t*this.ty-s*n)/r,this}isIdentity(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.tx&&0===this.ty}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new r;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return o.identity()}static get shared(){return h.identity()}}const h=new r,o=new r},9408:(t,s,i)=>{"use strict";i.d(s,{A:()=>h});var e=i(4670),n=i(4985),r=i(8288);class h extends n.l{constructor(t){t instanceof r.T&&(t={context:t});const{context:s,roundPixels:i,...e}=t||{};super({label:"Graphics",...e}),this.renderPipeId="graphics",this.Ri=s||(this.wr=new r.T),this.Ri.on("update",this.onViewUpdate,this),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=i??!1}set context(t){t!==this.Ri&&(this.Ri.off("update",this.onViewUpdate,this),this.Ri=t,this.Ri.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this.Ri}get bounds(){return this.Ri.bounds}updateBounds(){}containsPoint(t){return this.Ri.containsPoint(t)}destroy(t){this.wr&&!t?this.wr.destroy(t):!0!==t&&!0!==t?.context||this.Ri.destroy(t),this.wr=null,this.Ri=null,super.destroy(t)}vr(t,s){return this.context[t](...s),this}setFillStyle(...t){return this.vr("setFillStyle",t)}setStrokeStyle(...t){return this.vr("setStrokeStyle",t)}fill(...t){return this.vr("fill",t)}stroke(...t){return this.vr("stroke",t)}texture(...t){return this.vr("texture",t)}beginPath(){return this.vr("beginPath",[])}cut(){return this.vr("cut",[])}arc(...t){return this.vr("arc",t)}arcTo(...t){return this.vr("arcTo",t)}arcToSvg(...t){return this.vr("arcToSvg",t)}bezierCurveTo(...t){return this.vr("bezierCurveTo",t)}closePath(){return this.vr("closePath",[])}ellipse(...t){return this.vr("ellipse",t)}circle(...t){return this.vr("circle",t)}path(...t){return this.vr("path",t)}lineTo(...t){return this.vr("lineTo",t)}moveTo(...t){return this.vr("moveTo",t)}quadraticCurveTo(...t){return this.vr("quadraticCurveTo",t)}rect(...t){return this.vr("rect",t)}roundRect(...t){return this.vr("roundRect",t)}poly(...t){return this.vr("poly",t)}regularPoly(...t){return this.vr("regularPoly",t)}roundPoly(...t){return this.vr("roundPoly",t)}roundShape(...t){return this.vr("roundShape",t)}filletRect(...t){return this.vr("filletRect",t)}chamferRect(...t){return this.vr("chamferRect",t)}star(...t){return this.vr("star",t)}svg(...t){return this.vr("svg",t)}restore(...t){return this.vr("restore",t)}save(){return this.vr("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this.vr("resetTransform",[])}rotateTransform(...t){return this.vr("rotate",t)}scaleTransform(...t){return this.vr("scale",t)}setTransform(...t){return this.vr("setTransform",t)}transform(...t){return this.vr("transform",t)}translateTransform(...t){return this.vr("translate",t)}clear(){return this.vr("clear",[])}get fillStyle(){return this.Ri.fillStyle}set fillStyle(t){this.Ri.fillStyle=t}get strokeStyle(){return this.Ri.strokeStyle}set strokeStyle(t){this.Ri.strokeStyle=t}clone(t=!1){return t?new h(this.Ri.clone()):(this.wr=null,new h(this.Ri))}lineStyle(t,s,i){(0,e.t6)(e.lj,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const n={};return t&&(n.width=t),s&&(n.color=s),i&&(n.alpha=i),this.context.strokeStyle=n,this}beginFill(t,s){(0,e.t6)(e.lj,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const i={};return void 0!==t&&(i.color=t),void 0!==s&&(i.alpha=s),this.context.fillStyle=i,this}endFill(){(0,e.t6)(e.lj,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return t.width===r.T.defaultStrokeStyle.width&&t.color===r.T.defaultStrokeStyle.color&&t.alpha===r.T.defaultStrokeStyle.alpha||this.context.stroke(),this}drawCircle(...t){return(0,e.t6)(e.lj,"Graphics#drawCircle has been renamed to Graphics#circle"),this.vr("circle",t)}drawEllipse(...t){return(0,e.t6)(e.lj,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this.vr("ellipse",t)}drawPolygon(...t){return(0,e.t6)(e.lj,"Graphics#drawPolygon has been renamed to Graphics#poly"),this.vr("poly",t)}drawRect(...t){return(0,e.t6)(e.lj,"Graphics#drawRect has been renamed to Graphics#rect"),this.vr("rect",t)}drawRoundedRect(...t){return(0,e.t6)(e.lj,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this.vr("roundRect",t)}drawStar(...t){return(0,e.t6)(e.lj,"Graphics#drawStar has been renamed to Graphics#star"),this.vr("star",t)}}},9443:(t,s,i)=>{"use strict";i.d(s,{E:()=>o,f:()=>r});var e=i(9313),n=i(2208);function r(t,s,i){let r,a;return i.clear(),t.parent?s?r=t.parent.worldTransform:(a=n.u.get().identity(),r=o(t,a)):r=e.u.IDENTITY,h(t,i,r,s),a&&n.u.return(a),i.isValid||i.set(0,0,0,0),i}function h(t,s,i,r){if(!t.visible||!t.measurable)return;let o;r?o=t.worldTransform:(t.updateLocalTransform(),o=n.u.get(),o.appendFrom(t.localTransform,i));const a=s,c=!!t.effects.length;if(c&&(s=n.o.get().clear()),t.boundsArea)s.addRect(t.boundsArea,o);else{const i=t.bounds;i&&!i.isEmpty()&&(s.matrix=o,s.addBounds(i));for(let i=0;i<t.children.length;i++)h(t.children[i],s,o,r)}if(c){for(let i=0;i<t.effects.length;i++)t.effects[i].addBounds?.(s);a.addBounds(s,e.u.IDENTITY),n.o.return(s)}r||n.u.return(o)}function o(t,s){const i=t.parent;return i&&(o(i,s),i.updateLocalTransform(),s.append(i.localTransform)),s}},9492:(t,s,i)=>{"use strict";i.d(s,{v:()=>y});var e=i(2577),n=i(9252),r=i(7608),h=i(1761),o=i(9939);let a=null,c=null;function l(t,s,i){for(let e=0,n=4*i*s;e<s;++e,n+=4)if(0!==t[n+3])return!1;return!0}function u(t,s,i,e,n){const r=4*s;for(let s=e,h=e*r+4*i;s<=n;++s,h+=r)if(0!==t[h+3])return!1;return!0}function d(...t){let s=t[0];s.canvas||(s={canvas:t[0],resolution:t[1]});const{canvas:i}=s,e=Math.min(s.resolution??1,1),r=s.width??i.width,d=s.height??i.height;let f=s.output;if(function(t,s){a||(a=h.e.get().createCanvas(256,128),c=a.getContext("2d",{willReadFrequently:!0}),c.globalCompositeOperation="copy",c.globalAlpha=1),(a.width<t||a.height<s)&&(a.width=(0,o.U5)(t),a.height=(0,o.U5)(s))}(r,d),!c)throw new TypeError("Failed to get canvas 2D context");c.drawImage(i,0,0,r,d,0,0,r*e,d*e);const p=c.getImageData(0,0,r,d).data;let g=0,m=0,y=r-1,b=d-1;for(;m<d&&l(p,r,m);)++m;if(m===d)return n.M.EMPTY;for(;l(p,r,b);)--b;for(;u(p,r,g,m,b);)++g;for(;u(p,r,y,m,b);)--y;return++y,++b,c.globalCompositeOperation="source-over",c.strokeRect(g,m,y-g,b-m),c.globalCompositeOperation="copy",f??(f=new n.M),f.set(g/e,m/e,(y-g)/e,(b-m)/e),f}var f=i(4016),p=i(1242),g=i(3548);const m=new n.M,y=new class{getCanvasAndContext(t){const{text:s,style:i,resolution:e=1}=t,n=i.Yn(),h=f.P.measureText(s||" ",i),o=Math.ceil(Math.ceil(Math.max(1,h.width)+2*n)*e),a=Math.ceil(Math.ceil(Math.max(1,h.height)+2*n)*e),c=r.N.getOptimalCanvasAndContext(o,a);return this.Ar(s,i,n,e,c),{canvasAndContext:c,frame:i.trim?d({canvas:c.canvas,width:o,height:a,resolution:1,output:m}):m.set(0,0,o,a)}}returnCanvasAndContext(t){r.N.returnCanvasAndContext(t)}Ar(t,s,i,n,r){const{canvas:h,context:o}=r,a=(0,p.Z)(s),c=f.P.measureText(t||" ",s),l=c.lines,u=c.lineHeight,d=c.lineWidths,m=c.maxLineWidth,y=c.fontProperties,b=h.height;if(o.resetTransform(),o.scale(n,n),o.textBaseline=s.textBaseline,s.ss?.width){const t=s.ss;o.lineWidth=t.width,o.miterLimit=t.miterLimit,o.lineJoin=t.join,o.lineCap=t.cap}let w,v;o.font=a;const x=s.dropShadow?2:1;for(let t=0;t<x;++t){const h=s.dropShadow&&0===t,a=h?Math.ceil(Math.max(1,b)+2*i):0,f=a*n;if(h){o.fillStyle="black",o.strokeStyle="black";const t=s.dropShadow,i=t.color,r=t.alpha;o.shadowColor=e.Q.shared.setValue(i).setAlpha(r).toRgbaString();const h=t.blur*n,a=t.distance*n;o.shadowBlur=h,o.shadowOffsetX=Math.cos(t.angle)*a,o.shadowOffsetY=Math.sin(t.angle)*a+f}else{if(o.fillStyle=s.ts?(0,g.r)(s.ts,o,c,2*i):null,s.ss?.width){const t=.5*s.ss.width+2*i;o.strokeStyle=(0,g.r)(s.ss,o,c,t)}o.shadowColor="black"}let p=(u-y.fontSize)/2;u-y.fontSize<0&&(p=0);const x=s.ss?.width??0;for(let t=0;t<l.length;t++)w=x/2,v=x/2+t*u+y.ascent+p,"right"===s.align?w+=m-d[t]:"center"===s.align&&(w+=(m-d[t])/2),s.ss?.width&&this.Mr(l[t],s,r,w+i,v+i-a,!0),void 0!==s.ts&&this.Mr(l[t],s,r,w+i,v+i-a)}}Mr(t,s,i,e,n,r=!1){const{context:h}=i,o=s.letterSpacing;let a=!1;if(f.P.experimentalLetterSpacingSupported&&(f.P.experimentalLetterSpacing?(h.letterSpacing=`${o}px`,h.textLetterSpacing=`${o}px`,a=!0):(h.letterSpacing="0px",h.textLetterSpacing="0px")),0===o||a)return void(r?h.strokeText(t,e,n):h.fillText(t,e,n));let c=e;const l=f.P.graphemeSegmenter(t);let u=h.measureText(t).width,d=0;for(let t=0;t<l.length;++t){const s=l[t];r?h.strokeText(s,c,n):h.fillText(s,c,n);let i="";for(let s=t+1;s<l.length;++s)i+=l[s];d=h.measureText(i).width,c+=u-d+o,u=d}}}},9636:(t,s,i)=>{"use strict";i.d(s,{c:()=>h});var e=i(9313),n=i(9252);const r=new e.u;class h{constructor(t=1/0,s=1/0,i=-1/0,e=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=r,this.minX=t,this.minY=s,this.maxX=i,this.maxY=e}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this.kr||(this.kr=new n.M);const t=this.kr;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=r,this}set(t,s,i,e){this.minX=t,this.minY=s,this.maxX=i,this.maxY=e}addFrame(t,s,i,e,n){n||(n=this.matrix);const r=n.a,h=n.b,o=n.c,a=n.d,c=n.tx,l=n.ty;let u=this.minX,d=this.minY,f=this.maxX,p=this.maxY,g=r*t+o*s+c,m=h*t+a*s+l;g<u&&(u=g),m<d&&(d=m),g>f&&(f=g),m>p&&(p=m),g=r*i+o*s+c,m=h*i+a*s+l,g<u&&(u=g),m<d&&(d=m),g>f&&(f=g),m>p&&(p=m),g=r*t+o*e+c,m=h*t+a*e+l,g<u&&(u=g),m<d&&(d=m),g>f&&(f=g),m>p&&(p=m),g=r*i+o*e+c,m=h*i+a*e+l,g<u&&(u=g),m<d&&(d=m),g>f&&(f=g),m>p&&(p=m),this.minX=u,this.minY=d,this.maxX=f,this.maxY=p}addRect(t,s){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,s)}addBounds(t,s){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,s)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const s=this.minX,i=this.minY,e=this.maxX,n=this.maxY,{a:r,b:h,c:o,d:a,tx:c,ty:l}=t;let u=r*s+o*i+c,d=h*s+a*i+l;this.minX=u,this.minY=d,this.maxX=u,this.maxY=d,u=r*e+o*i+c,d=h*e+a*i+l,this.minX=u<this.minX?u:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=u>this.maxX?u:this.maxX,this.maxY=d>this.maxY?d:this.maxY,u=r*s+o*n+c,d=h*s+a*n+l,this.minX=u<this.minX?u:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=u>this.maxX?u:this.maxX,this.maxY=d>this.maxY?d:this.maxY,u=r*e+o*n+c,d=h*e+a*n+l,this.minX=u<this.minX?u:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=u>this.maxX?u:this.maxX,this.maxY=d>this.maxY?d:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,s,i,e){return this.minX<t&&(this.minX=t),this.maxX>s&&(this.maxX=s),this.minY<i&&(this.minY=i),this.maxY>e&&(this.maxY=e),this}pad(t,s=t){return this.minX-=t,this.maxX+=t,this.minY-=s,this.maxY+=s,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new h(this.minX,this.minY,this.maxX,this.maxY)}scale(t,s=t){return this.minX*=t,this.minY*=s,this.maxX*=t,this.maxY*=s,this}get x(){return this.minX}set x(t){const s=this.maxX-this.minX;this.minX=t,this.maxX=t+s}get y(){return this.minY}set y(t){const s=this.maxY-this.minY;this.minY=t,this.maxY=t+s}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,s,i,e){let n=this.minX,r=this.minY,h=this.maxX,o=this.maxY;e||(e=this.matrix);const a=e.a,c=e.b,l=e.c,u=e.d,d=e.tx,f=e.ty;for(let e=s;e<i;e+=2){const s=t[e],i=t[e+1],p=a*s+l*i+d,g=c*s+u*i+f;n=p<n?p:n,r=g<r?g:r,h=p>h?p:h,o=g>o?g:o}this.minX=n,this.minY=r,this.maxX=h,this.maxY=o}containsPoint(t,s){return this.minX<=t&&this.minY<=s&&this.maxX>=t&&this.maxY>=s}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}}},9903:(t,s,i)=>{"use strict";function e(t,s,i){const e=t.length;let n;if(s>=e||0===i)return;const r=e-(i=s+i>e?e-s:i);for(n=s;n<r;++n)t[n]=t[n+i];t.length=r}i.d(s,{d:()=>e})},9939:(t,s,i)=>{"use strict";function e(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,1+(t|=t>>>16)}function n(t){return!(t&t-1||!t)}i.d(s,{U5:()=>e,f3:()=>n})}},e={};function n(t){var s=e[t];if(void 0!==s)return s.exports;var r=e[t]={exports:{}};return i[t](r,r.exports,n),r.exports}n.m=i,n.d=(t,s)=>{for(var i in s)n.o(s,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},n.f={},n.e=t=>Promise.all(Object.keys(n.f).reduce((s,i)=>(n.f[i](t,s),s),[])),n.u=t=>"bundle."+{98:"fa2af3c2166419c9c58c",162:"eee2d451fd69d5c3d756",397:"562d77d8d81f553f5eea",580:"2d16cd12145b928a8d9f",582:"de2da08f0edc62cf82af",584:"d8570b2b52fb518ffd10"}[t]+".js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,s)=>Object.prototype.hasOwnProperty.call(t,s),t={},s="jump-game:",n.l=(i,e,r,h)=>{if(t[i])t[i].push(e);else{var o,a;if(void 0!==r)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var u=c[l];if(u.getAttribute("src")==i||u.getAttribute("data-webpack")==s+r){o=u;break}}o||(a=!0,(o=document.createElement("script")).charset="utf-8",n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",s+r),o.src=i),t[i]=[e];var d=(s,e)=>{o.onerror=o.onload=null,clearTimeout(f);var n=t[i];if(delete t[i],o.parentNode&&o.parentNode.removeChild(o),n&&n.forEach(t=>t(e)),s)return s(e)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),a&&document.head.appendChild(o)}},n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"Sr",{value:!0})},(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var s=n.g.document;if(!t&&s&&(s.currentScript&&"SCRIPT"===s.currentScript.tagName.toUpperCase()&&(t=s.currentScript.src),!t)){var i=s.getElementsByTagName("script");if(i.length)for(var e=i.length-1;e>-1&&(!t||!/^http(s?):/.test(t));)t=i[e--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),(()=>{var t={792:0};n.f.j=(s,i)=>{var e=n.o(t,s)?t[s]:void 0;if(0!==e)if(e)i.push(e[2]);else{var r=new Promise((i,n)=>e=t[s]=[i,n]);i.push(e[2]=r);var h=n.p+n.u(s),o=new Error;n.l(h,i=>{if(n.o(t,s)&&(0!==(e=t[s])&&(t[s]=void 0),e)){var r=i&&("load"===i.type?"missing":i.type),h=i&&i.target&&i.target.src;o.message="Loading chunk "+s+" failed.\n("+r+": "+h+")",o.name="ChunkLoadError",o.type=r,o.request=h,e[1](o)}},"chunk-"+s,s)}};var s=(s,i)=>{var e,r,[h,o,a]=i,c=0;if(h.some(s=>0!==t[s])){for(e in o)n.o(o,e)&&(n.m[e]=o[e]);a&&a(n)}for(s&&s(i);c<h.length;c++)r=h[c],n.o(t,r)&&t[r]&&t[r][0](),t[r]=0},i=self.webpackChunkjump_game=self.webpackChunkjump_game||[];i.forEach(s.bind(null,0)),i.push=s.bind(null,i.push.bind(i))})(),(()=>{"use strict";class t{constructor(t){this.gameManager=t,this.container=document.createElement("div")}init(){const t=this.gameManager.getUILayer();this.container.style.cssText="\n            width: 100%;\n            height: 100%;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            background: url('images/start_bg.png') center/cover;\n            position: relative;\n        ";const s=document.createElement("div");s.style.cssText="\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            z-index: 0;\n        ";const i=document.createElement("div");i.style.cssText="\n            display: flex;\n            flex-direction: column;\n            gap: 20px;\n            z-index: 1;\n            margin-top: 200px;\n        ";const e=document.createElement("button");e.textContent="",e.style.cssText="\n            width: 200px;\n            height: 60px;\n            font-size: 24px;\n        ",e.onclick=()=>{this.gameManager.showScreen(Nt.HELP)};const n=document.createElement("button");n.textContent="",n.style.cssText="\n            width: 200px;\n            height: 60px;\n            font-size: 24px;\n        ",n.onclick=()=>{this.gameManager.showScreen(Nt.RANKING)};const r=document.createElement("button");r.textContent="",r.style.cssText="\n            width: 200px;\n            height: 60px;\n            font-size: 24px;\n            background: #ff6b6b;\n        ",r.onclick=()=>{this.gameManager.showScreen(Nt.CHARACTER_SELECT)},i.appendChild(e),i.appendChild(n),i.appendChild(r),this.container.appendChild(s),this.container.appendChild(i),t.appendChild(this.container)}destroy(){this.container.parentNode&&this.container.parentNode.removeChild(this.container)}}class s{constructor(t){this.characterIndex=0,this.characters=[0,1,2],this.gameManager=t,this.container=document.createElement("div")}init(){const t=this.gameManager.getUILayer();this.container.style.cssText="\n            width: 100%;\n            height: 100%;\n            min-height: 100vh;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            padding: 20px;\n            position: relative;\n            overflow-y: auto;\n            box-sizing: border-box;\n        ";const s=document.createElement("div");s.style.cssText="\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            gap: 20px;\n            margin-bottom: 30px;\n            width: 100%;\n            max-width: 400px;\n        ";const i=document.createElement("div");i.textContent=" .",i.style.cssText="\n            font-size: 24px;\n            color: white;\n            font-weight: bold;\n        ",this.nicknameInput=document.createElement("input"),this.nicknameInput.type="text",this.nicknameInput.placeholder=" ",this.nicknameInput.maxLength=10,this.nicknameInput.style.cssText="\n            width: 100%;\n            max-width: 300px;\n            height: 50px;\n            font-size: 20px;\n            padding: 0 15px;\n            border-radius: 10px;\n            border: 2px solid white;\n            box-sizing: border-box;\n        ",s.appendChild(i),s.appendChild(this.nicknameInput);const e=document.createElement("div");e.style.cssText="\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 15px;\n            margin: 30px 0;\n            width: 100%;\n            max-width: 400px;\n            flex-wrap: wrap;\n        ";const n=document.createElement("button");n.textContent="",n.style.cssText="\n            width: 50px;\n            height: 50px;\n            min-width: 50px;\n            font-size: 24px;\n            border-radius: 50%;\n            background: rgba(255, 255, 255, 0.8);\n            border: 2px solid white;\n            cursor: pointer;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        ",n.onclick=()=>{this.characterIndex=(this.characterIndex-1+this.characters.length)%this.characters.length,this.updateCharacterDisplay()};const r=document.createElement("div");r.id="character-display",r.style.cssText="\n            width: 180px;\n            height: 180px;\n            min-width: 180px;\n            background: rgba(255, 255, 255, 0.3);\n            border-radius: 20px;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            overflow: hidden;\n            flex-shrink: 0;\n        ";const h=document.createElement("img");h.id="character-image",h.style.cssText="\n            width: 100%;\n            height: 100%;\n            object-fit: contain;\n        ",r.appendChild(h);const o=document.createElement("button");o.textContent="",o.style.cssText="\n            width: 50px;\n            height: 50px;\n            min-width: 50px;\n            font-size: 24px;\n            border-radius: 50%;\n            background: rgba(255, 255, 255, 0.8);\n            border: 2px solid white;\n            cursor: pointer;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        ",o.onclick=()=>{this.characterIndex=(this.characterIndex+1)%this.characters.length,this.updateCharacterDisplay()},e.appendChild(n),e.appendChild(r),e.appendChild(o);const a=document.createElement("div");a.style.cssText="\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            width: 100%;\n            max-width: 400px;\n            margin-top: 30px;\n            padding: 0 20px;\n            box-sizing: border-box;\n        ";const c=document.createElement("button");c.textContent="",c.style.cssText="\n            width: 100%;\n            height: 60px;\n            font-size: 24px;\n            background: #ff6b6b;\n            border: none;\n            border-radius: 10px;\n            color: white;\n            font-weight: bold;\n            cursor: pointer;\n            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);\n            box-sizing: border-box;\n        ",c.onclick=()=>{const t=this.nicknameInput.value.trim();0!==t.length?(this.gameManager.setGameData({nickname:t,characterId:this.characters[this.characterIndex]}),this.gameManager.showScreen(Nt.GAME)):alert(" .")},a.appendChild(c),this.container.appendChild(s),this.container.appendChild(e),this.container.appendChild(a),t.appendChild(this.container),this.updateCharacterDisplay()}updateCharacterDisplay(){const t=this.characters[this.characterIndex],s=document.getElementById("character-image");if(s){const i=t+1;s.src=`images/${i}L.png`,s.alt=` ${i}`}}destroy(){this.container.parentNode&&this.container.parentNode.removeChild(this.container)}}class i{static isDevelopment(){return!1}static async getGameKey(){if(this.isDevelopment())return console.log("[DEV MODE] Using dummy game key"),`dev_key_${Date.now()}`;try{const t=await fetch(`${this.baseUrl}/game/key`,{method:"POST",headers:{"Content-Type":"application/json"}});return(await t.json()).key||""}catch(t){throw console.error("Get game key error:",t),t}}static async getMonthlyRanking(){if(this.isDevelopment())return console.log("[DEV MODE] Using dummy monthly ranking"),[{nickname:"Player1",score:500},{nickname:"Player2",score:450},{nickname:"Player3",score:400},{nickname:"Player4",score:350},{nickname:"Player5",score:300},{nickname:"Player6",score:250},{nickname:"Player7",score:200}];try{const t=await fetch(`${this.baseUrl}/ranking/monthly`,{method:"GET",headers:{"Content-Type":"application/json"}});return(await t.json()).rankings||[]}catch(t){throw console.error("Get ranking error:",t),t}}static async getResultRanking(t){if(this.isDevelopment()){console.log("[DEV MODE] Using dummy result ranking");let s=8;return t>=500?s=1:t>=450?s=2:t>=400?s=3:t>=350?s=4:t>=300?s=5:t>=250?s=6:t>=200&&(s=7),{topRankings:[{nickname:"Player1",score:500},{nickname:"Player2",score:450},{nickname:"Player3",score:400},{nickname:"Player4",score:350},{nickname:"Player5",score:300},{nickname:"Player6",score:250},{nickname:"Player7",score:200}],myRank:{rank:s,nickname:"Me",score:t}}}try{const s=await fetch(`${this.baseUrl}/ranking/result`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({score:t})});return await s.json()}catch(t){throw console.error("Get result ranking error:",t),t}}static async submitEventInfo(t){if(this.isDevelopment())return console.log("[DEV MODE] Simulating event info submission:",t),new Promise(t=>{setTimeout(()=>{console.log("[DEV MODE] Event info submitted successfully"),t(!0)},500)});try{return(await fetch(`${this.baseUrl}/event/submit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok}catch(t){return console.error("Submit event info error:",t),!1}}}i.baseUrl="https://your-api-server.com/api";var e=n(8507);const r={extension:{type:e.Ag.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await Promise.all([n.e(582),n.e(397)]).then(n.bind(n,8397))}},h={extension:{type:e.Ag.Environment,name:"webworker",priority:0},test:()=>"undefined"!=typeof self&&void 0!==self.WorkerGlobalScope,load:async()=>{await Promise.all([n.e(582),n.e(162)]).then(n.bind(n,2162))}};n(8480),n(9010);var o=n(1761),a=n(800);let c,l;function u(t){return void 0!==c||(c=(()=>{const s={stencil:!0,failIfMajorPerformanceCaveat:t??a.k.defaultOptions.failIfMajorPerformanceCaveat};try{if(!o.e.get().getWebGLRenderingContext())return!1;let t=o.e.get().createCanvas().getContext("webgl",s);const i=!!t?.getContextAttributes()?.stencil;if(t){const s=t.getExtension("WEBGL_lose_context");s&&s.loseContext()}return t=null,i}catch(t){return!1}})()),c}async function d(t={}){return void 0!==l||(l=await(async()=>{const s=o.e.get().getNavigator().gpu;if(!s)return!1;try{const i=await s.requestAdapter(t);return await i.requestDevice(),!0}catch(t){return!1}})()),l}const f=["webgl","webgpu","canvas"];var p=n(7457),g=n(7073),m=n(4670);const y=class t{constructor(...t){this.stage=new p.mc,void 0!==t[0]&&(0,m.t6)(m.lj,"Application constructor options are deprecated, please use Application.init() instead.")}async init(s){s={...s},this.renderer=await async function(t){let s,i=[];t.preference?(i.push(t.preference),f.forEach(s=>{s!==t.preference&&i.push(s)})):i=f.slice();let e={};for(let r=0;r<i.length;r++){const h=i[r];if("webgpu"===h&&await d()){const{WebGPURenderer:i}=await Promise.all([n.e(580),n.e(98)]).then(n.bind(n,3098));s=i,e={...t,...t.webgpu};break}if("webgl"===h&&u(t.failIfMajorPerformanceCaveat??a.k.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:i}=await Promise.all([n.e(580),n.e(584)]).then(n.bind(n,7584));s=i,e={...t,...t.webgl};break}if("canvas"===h)throw e={...t},new Error("CanvasRenderer is not yet implemented")}if(delete e.webgpu,delete e.webgl,!s)throw new Error("No available renderer for the current environment");const r=new s;return await r.init(e),r}(s),t.Cr.forEach(t=>{t.init.call(this,s)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return(0,m.t6)(m.lj,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(s=!1,i=!1){const e=t.Cr.slice(0);e.reverse(),e.forEach(t=>{t.destroy.call(this)}),this.stage.destroy(i),this.stage=null,this.renderer.destroy(s),this.renderer=null}};y.Cr=[];let b=y;e.XO.handleByList(e.Ag.Application,b.Cr),e.XO.add(g.M);var w=n(4589),v=n(2233),x=n(2927),A=n(2079),M=n(9252),k=n(5589),S=n(1849),C=n(1312);class T extends S.v{constructor(t,s){super();const{textures:i,data:e}=t;Object.keys(e.pages).forEach(t=>{const s=e.pages[parseInt(t,10)],n=i[s.id];this.pages.push({texture:n})}),Object.keys(e.chars).forEach(t=>{const s=e.chars[t],{frame:n,source:r,rotate:h}=i[s.page],o=A.E.transformRectCoords(s,n,h,new M.M),a=new k.g({frame:o,orig:new M.M(0,0,s.width,s.height),source:r,rotate:h});this.chars[t]={id:t.codePointAt(0),xOffset:s.xOffset,yOffset:s.yOffset,xAdvance:s.xAdvance,kerning:s.kerning??{},texture:a}}),this.baseRenderedFontSize=e.fontSize,this.baseMeasurementFontSize=e.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:e.fontSize},this.baseLineOffset=e.baseLineOffset,this.lineHeight=e.lineHeight,this.fontFamily=e.fontFamily,this.distanceField=e.distanceField??{type:"none",range:0},this.url=s}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{texture:s}=this.pages[t];s.destroy(!0)}this.pages=null}static install(t){C.c.install(t)}static uninstall(t){C.c.uninstall(t)}}const $={test:t=>"string"==typeof t&&t.startsWith("info face="),parse(t){const s=t.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const t in s){const e=s[t].match(/^[a-z]+/gm)[0],n=s[t].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),r={};for(const t in n){const s=n[t].split("="),i=s[0],e=s[1].replace(/"/gm,""),h=parseFloat(e),o=isNaN(h)?e:h;r[i]=o}i[e].push(r)}const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[n]=i.info,[r]=i.common,[h]=i.distanceField??[];h&&(e.distanceField={range:parseInt(h.distanceRange,10),type:h.fieldType}),e.fontSize=parseInt(n.size,10),e.fontFamily=n.face,e.lineHeight=parseInt(r.lineHeight,10);const o=i.page;for(let t=0;t<o.length;t++)e.pages.push({id:parseInt(o[t].id,10)||0,file:o[t].file});const a={};e.baseLineOffset=e.lineHeight-parseInt(r.base,10);const c=i.char;for(let t=0;t<c.length;t++){const s=c[t],i=parseInt(s.id,10);let n=s.letter??s.char??String.fromCharCode(i);"space"===n&&(n=" "),a[i]=n,e.chars[n]={id:i,page:parseInt(s.page,10)||0,x:parseInt(s.x,10),y:parseInt(s.y,10),width:parseInt(s.width,10),height:parseInt(s.height,10),xOffset:parseInt(s.xoffset,10),yOffset:parseInt(s.yoffset,10),xAdvance:parseInt(s.xadvance,10),kerning:{}}}const l=i.kerning||[];for(let t=0;t<l.length;t++){const s=parseInt(l[t].first,10),i=parseInt(l[t].second,10),n=parseInt(l[t].amount,10);e.chars[a[i]].kerning[a[s]]=n}return e}},P={test(t){const s=t;return"string"!=typeof s&&"getElementsByTagName"in s&&s.getElementsByTagName("page").length&&null!==s.getElementsByTagName("info")[0].getAttribute("face")},parse(t){const s={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},i=t.getElementsByTagName("info")[0],e=t.getElementsByTagName("common")[0],n=t.getElementsByTagName("distanceField")[0];n&&(s.distanceField={type:n.getAttribute("fieldType"),range:parseInt(n.getAttribute("distanceRange"),10)});const r=t.getElementsByTagName("page"),h=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning");s.fontSize=parseInt(i.getAttribute("size"),10),s.fontFamily=i.getAttribute("face"),s.lineHeight=parseInt(e.getAttribute("lineHeight"),10);for(let t=0;t<r.length;t++)s.pages.push({id:parseInt(r[t].getAttribute("id"),10)||0,file:r[t].getAttribute("file")});const a={};s.baseLineOffset=s.lineHeight-parseInt(e.getAttribute("base"),10);for(let t=0;t<h.length;t++){const i=h[t],e=parseInt(i.getAttribute("id"),10);let n=i.getAttribute("letter")??i.getAttribute("char")??String.fromCharCode(e);"space"===n&&(n=" "),a[e]=n,s.chars[n]={id:e,page:parseInt(i.getAttribute("page"),10)||0,x:parseInt(i.getAttribute("x"),10),y:parseInt(i.getAttribute("y"),10),width:parseInt(i.getAttribute("width"),10),height:parseInt(i.getAttribute("height"),10),xOffset:parseInt(i.getAttribute("xoffset"),10),yOffset:parseInt(i.getAttribute("yoffset"),10),xAdvance:parseInt(i.getAttribute("xadvance"),10),kerning:{}}}for(let t=0;t<o.length;t++){const i=parseInt(o[t].getAttribute("first"),10),e=parseInt(o[t].getAttribute("second"),10),n=parseInt(o[t].getAttribute("amount"),10);s.chars[a[e]].kerning[a[i]]=n}return s}},I=t=>!("string"!=typeof t||!t.includes("<font>"))&&P.test(o.e.get().parseXML(t)),E=t=>P.parse(o.e.get().parseXML(t)),B=[".xml",".fnt"],R={extension:{type:e.Ag.CacheParser,name:"cacheBitmapFont"},test:t=>t instanceof T,getCacheableAssets(t,s){const i={};return t.forEach(t=>{i[t]=s,i[`${t}-bitmap`]=s}),i[`${s.fontFamily}-bitmap`]=s,i}},z={extension:{type:e.Ag.LoadParser,priority:w.T.Normal},name:"loadBitmapFont",id:"bitmap-font",test:t=>B.includes(x.A.extname(t).toLowerCase()),testParse:async t=>$.test(t)||I(t),async parse(t,s,i){const e=$.test(t)?$.parse(t):E(t),{src:n}=s,{pages:r}=e,h=[],o=e.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let t=0;t<r.length;++t){const s=r[t].file;let i=x.A.join(x.A.dirname(n),s);i=(0,v.Y)(i,n),h.push({src:i,data:o})}const a=await i.load(h),c=h.map(t=>a[t.src]);return new T({data:e,textures:c},n)},async load(t,s){const i=await o.e.get().fetch(t);return await i.text()},async unload(t,s,i){await Promise.all(t.pages.map(t=>i.unload(t.texture.source.mr))),t.destroy()}};var G=n(268);class F{constructor(t,s=!1){this.Tr=t,this.$r=[],this.Pr=!1,this.Ir=1,this.verbose=s}add(t){t.forEach(t=>{this.$r.push(t)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this.$r),this.Er&&!this.Pr&&this.Br()}async Br(){if(this.$r.length&&this.Er){this.Pr=!0;const t=[],s=Math.min(this.$r.length,this.Ir);for(let i=0;i<s;i++)t.push(this.$r.pop());await this.Tr.load(t),this.Pr=!1,this.Br()}}get active(){return this.Er}set active(t){this.Er!==t&&(this.Er=t,t&&!this.Pr&&this.Br())}}var j=n(1979);const _={extension:{type:e.Ag.CacheParser,name:"cacheTextureArray"},test:t=>Array.isArray(t)&&t.every(t=>t instanceof k.g),getCacheableAssets:(t,s)=>{const i={};return t.forEach(t=>{s.forEach((s,e)=>{i[t+(0===e?"":e+1)]=s})}),i}};async function O(t){if("Image"in globalThis)return new Promise(s=>{const i=new Image;i.onload=()=>{s(!0)},i.onerror=()=>{s(!1)},i.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const s=await(await fetch(t)).blob();await createImageBitmap(s)}catch(t){return!1}return!0}return!1}const U={extension:{type:e.Ag.DetectionParser,priority:1},test:async()=>O("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(t=>"avif"!==t)},D=["png","jpg","jpeg"],W={extension:{type:e.Ag.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...D],remove:async t=>t.filter(t=>!D.includes(t))},N="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function V(t){return!N&&""!==document.createElement("video").canPlayType(t)}const L={extension:{type:e.Ag.DetectionParser,priority:0},test:async()=>V("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(t=>"mp4"!==t&&"m4v"!==t)},H={extension:{type:e.Ag.DetectionParser,priority:0},test:async()=>V("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(t=>"ogv"!==t)},q={extension:{type:e.Ag.DetectionParser,priority:0},test:async()=>V("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(t=>"webm"!==t)},Y={extension:{type:e.Ag.DetectionParser,priority:0},test:async()=>O("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(t=>"webp"!==t)};var X=n(2406),Q=n(2217);const Z=class t{constructor(){this.loadOptions={...t.defaultOptions},this.Bt=[],this.Rr=!1,this.parsers=new Proxy(this.Bt,{set:(t,s,i)=>(this.Rr=!1,t[s]=i,!0)}),this.promiseCache={}}reset(){this.Rr=!1,this.promiseCache={}}zr(t,s){const i={promise:null,parser:null};return i.promise=(async()=>{let e=null,n=null;if((s.parser||s.loadParser)&&(n=this.Gr[s.parser||s.loadParser],s.loadParser&&(0,G.R)(`[Assets] "loadParser" is deprecated, use "parser" instead for ${t}`),n||(0,G.R)(`[Assets] specified load parser "${s.parser||s.loadParser}" not found while loading ${t}`)),!n){for(let i=0;i<this.parsers.length;i++){const e=this.parsers[i];if(e.load&&e.test?.(t,s,this)){n=e;break}}if(!n)return(0,G.R)(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}e=await n.load(t,s,this),i.parser=n;for(let t=0;t<this.parsers.length;t++){const n=this.parsers[t];n.parse&&n.parse&&await(n.testParse?.(e,s,this))&&(e=await n.parse(e,s,this)||e,i.parser=n)}return e})(),i}async load(s,i){this.Rr||this.Fr();const e="function"==typeof i?{...t.defaultOptions,...this.loadOptions,onProgress:i}:{...t.defaultOptions,...this.loadOptions,...i||{}},{onProgress:n,onError:r,strategy:h,retryCount:o,retryDelay:a}=e;let c=0;const l={},u=(0,Q.a)(s),d=(0,X.z)(s,t=>({alias:[t],src:t,data:{}})),f=d.reduce((t,s)=>t+(s.progressSize||1),0),p=d.map(async t=>{const s=x.A.toAbsolute(t.src);l[t.src]||(await this.jr(s,t,{onProgress:n,onError:r,strategy:h,retryCount:o,retryDelay:a},l),c+=t.progressSize||1,n&&n(c/f))});return await Promise.all(p),u?l[d[0].src]:l}async unload(t){const s=(0,X.z)(t,t=>({alias:[t],src:t})).map(async t=>{const s=x.A.toAbsolute(t.src),i=this.promiseCache[s];if(i){const e=await i.promise;delete this.promiseCache[s],await(i.parser?.unload?.(e,t,this))}});await Promise.all(s)}Fr(){this.Rr=!0,this.Gr=this.Bt.filter(t=>t.name||t.id).reduce((t,s)=>(s.name||s.id?(t[s.name]||t[s.id])&&(0,G.R)(`[Assets] parser id conflict "${s.id}"`):(0,G.R)("[Assets] parser should have an id"),t[s.name]=s,s.id&&(t[s.id]=s),t),{})}async jr(t,s,i,e){let n=0;const{onError:r,strategy:h,retryCount:o,retryDelay:a}=i,c=t=>new Promise(s=>setTimeout(s,t));for(;;)try{return this.promiseCache[t]||(this.promiseCache[t]=this.zr(t,s)),void(e[s.src]=await this.promiseCache[t].promise)}catch(i){if(delete this.promiseCache[t],delete e[s.src],n++,"retry"===h&&!("retry"!==h||n>o)){r&&r(i,s),await c(a);continue}if("skip"===h)return void(r&&r(i,s));throw r&&r(i,s),new Error(`[Loader.load] Failed to load ${t}.\n${i}`)}}};Z.defaultOptions={onProgress:void 0,onError:void 0,strategy:"throw",retryCount:3,retryDelay:250};let K=Z;function J(t,s){if(Array.isArray(s)){for(const i of s)if(t.startsWith(`data:${i}`))return!0;return!1}return t.startsWith(`data:${s}`)}function tt(t,s){const i=t.split("?")[0],e=x.A.extname(i).toLowerCase();return Array.isArray(s)?s.includes(e):e===s}const st={extension:{type:e.Ag.LoadParser,priority:w.T.Low},name:"loadJson",id:"json",test:t=>J(t,"application/json")||tt(t,".json"),async load(t){const s=await o.e.get().fetch(t);return await s.json()}},it={name:"loadTxt",id:"text",extension:{type:e.Ag.LoadParser,priority:w.T.Low,name:"loadTxt"},test:t=>J(t,"text/plain")||tt(t,".txt"),async load(t){const s=await o.e.get().fetch(t);return await s.text()}},et=["normal","bold","100","200","300","400","500","600","700","800","900"],nt=[".ttf",".otf",".woff",".woff2"],rt=["font/ttf","font/otf","font/woff","font/woff2"],ht=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i,ot=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function at(t){return ot.test(t)?t:encodeURI(t)}const ct={extension:{type:e.Ag.LoadParser,priority:w.T.Low},name:"loadWebFont",id:"web-font",test:t=>J(t,rt)||tt(t,nt),async load(t,s){const i=o.e.get().getFontFaceSet();if(i){const e=[],n=s.data?.family??function(t){const s=x.A.extname(t),i=x.A.basename(t,s).replace(/(-|_)/g," ").toLowerCase().split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1));let e=i.length>0;for(const t of i)if(!t.match(ht)){e=!1;break}let n=i.join(" ");return e||(n=`"${n.replace(/[\\"]/g,"\\$&")}"`),n}(t),r=s.data?.weights?.filter(t=>et.includes(t))??["normal"],h=s.data??{};for(let s=0;s<r.length;s++){const o=r[s],a=new FontFace(n,`url(${at(t)})`,{...h,weight:o});await a.load(),i.add(a),e.push(a)}return j.l.has(`${n}-and-url`)?j.l.get(`${n}-and-url`).entries.push({url:t,faces:e}):j.l.set(`${n}-and-url`,{entries:[{url:t,faces:e}]}),1===e.length?e[0]:e}return(0,G.R)("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){const s=Array.isArray(t)?t:[t],i=s[0].family,e=j.l.get(`${i}-and-url`),n=e.entries.find(t=>t.faces.some(t=>-1!==s.indexOf(t)));n.faces=n.faces.filter(t=>-1===s.indexOf(t)),0===n.faces.length&&(e.entries=e.entries.filter(t=>t!==n)),s.forEach(t=>{o.e.get().getFontFaceSet().delete(t)}),0===e.entries.length&&j.l.remove(`${i}-and-url`)}};var lt=n(8293),ut=n(8288),dt=n(1173);function ft(t,s=1){const i=dt.x.RETINA_PREFIX?.exec(t);return i?parseFloat(i[1]):s}function pt(t,s,i){t.label=i,t.mr=i;const e=new k.g({source:t,label:i}),n=()=>{delete s.promiseCache[i],j.l.has(i)&&j.l.remove(i)};return e.source.once("destroy",()=>{s.promiseCache[i]&&((0,G.R)("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),n())}),e.once("destroy",()=>{t.destroyed||((0,G.R)("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),n())}),e}const gt={extension:{type:e.Ag.LoadParser,priority:w.T.Low,name:"loadSVG"},name:"loadSVG",id:"svg",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test:t=>J(t,"image/svg+xml")||tt(t,".svg"),async load(t,s,i){return s.data?.parseAsGraphicsContext??this.config.parseAsGraphicsContext?async function(t){const s=await o.e.get().fetch(t),i=await s.text(),e=new ut.T;return e.svg(i),e}(t):async function(t,s,i,e){const n=await o.e.get().fetch(t),r=o.e.get().createImage();r.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(await n.text())}`,r.crossOrigin=e,await r.decode();const h=s.data?.width??r.width,a=s.data?.height??r.height,c=s.data?.resolution||ft(t),l=Math.ceil(h*c),u=Math.ceil(a*c),d=o.e.get().createCanvas(l,u),f=d.getContext("2d");f.imageSmoothingEnabled=!0,f.imageSmoothingQuality="high",f.drawImage(r,0,0,h*c,a*c);const{parseAsGraphicsContext:p,...g}=s.data??{};return pt(new lt.b({resource:d,alphaMode:"premultiply-alpha-on-upload",resolution:c,...g}),i,t)}(t,s,i,this.config.crossOrigin)},unload(t){t.destroy(!0)}};let mt=null;class yt{constructor(){mt||(mt=URL.createObjectURL(new Blob(['(function () {\n    \'use strict\';\n\n    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";\n    async function checkImageBitmap() {\n      try {\n        if (typeof createImageBitmap !== "function")\n          return false;\n        const response = await fetch(WHITE_PNG);\n        const imageBlob = await response.blob();\n        const imageBitmap = await createImageBitmap(imageBlob);\n        return imageBitmap.width === 1 && imageBitmap.height === 1;\n      } catch (_e) {\n        return false;\n      }\n    }\n    void checkImageBitmap().then((result) => {\n      self.postMessage(result);\n    });\n\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker(mt)}}yt.revokeObjectURL=function(){mt&&(URL.revokeObjectURL(mt),mt=null)};let bt=null;class wt{constructor(){bt||(bt=URL.createObjectURL(new Blob(['(function () {\n    \'use strict\';\n\n    async function loadImageBitmap(url, alphaMode) {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: ${response.status} ${response.statusText}`);\n      }\n      const imageBlob = await response.blob();\n      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);\n    }\n    self.onmessage = async (event) => {\n      try {\n        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);\n        self.postMessage({\n          data: imageBitmap,\n          uuid: event.data.uuid,\n          id: event.data.id\n        }, [imageBitmap]);\n      } catch (e) {\n        self.postMessage({\n          error: e,\n          uuid: event.data.uuid,\n          id: event.data.id\n        });\n      }\n    };\n\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker(bt)}}wt.revokeObjectURL=function(){bt&&(URL.revokeObjectURL(bt),bt=null)};let vt,xt=0;const At=new class{constructor(){this.We=!1,this._r=0,this.Or=[],this.tr=[],this.Ur={}}isImageBitmapSupported(){return void 0!==this.Dr||(this.Dr=new Promise(t=>{const{worker:s}=new yt;s.addEventListener("message",i=>{s.terminate(),yt.revokeObjectURL(),t(i.data)})})),this.Dr}loadImageBitmap(t,s){return this.Wr("loadImageBitmap",[t,s?.data?.alphaMode])}async Nr(){this.We||(this.We=!0)}Vr(){void 0===vt&&(vt=navigator.hardwareConcurrency||4);let t=this.Or.pop();return!t&&this._r<vt&&(this._r++,t=(new wt).worker,t.addEventListener("message",t=>{this.Lr(t.data),this.Hr(t.target),this.Br()})),t}Hr(t){this.Or.push(t)}Lr(t){this.Ur[t.uuid]&&(void 0!==t.error?this.Ur[t.uuid].reject(t.error):this.Ur[t.uuid].resolve(t.data),delete this.Ur[t.uuid])}async Wr(t,s){await this.Nr();const i=new Promise((i,e)=>{this.tr.push({id:t,arguments:s,resolve:i,reject:e})});return this.Br(),i}Br(){if(!this.tr.length)return;const t=this.Vr();if(!t)return;const s=this.tr.pop(),i=s.id;this.Ur[xt]={resolve:s.resolve,reject:s.reject},t.postMessage({data:s.arguments,uuid:xt++,id:i})}reset(){this.Or.forEach(t=>t.terminate()),this.Or.length=0,Object.values(this.Ur).forEach(({reject:t})=>{t?.(new Error("WorkerManager has been reset before completion"))}),this.Ur={},this.tr.length=0,this.We=!1,this._r=0}},Mt=[".jpeg",".jpg",".png",".webp",".avif"],kt=["image/jpeg","image/png","image/webp","image/avif"],St={name:"loadTextures",id:"texture",extension:{type:e.Ag.LoadParser,priority:w.T.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:t=>J(t,kt)||tt(t,Mt),async load(t,s,i){let e=null;return e=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await At.isImageBitmapSupported()?await At.loadImageBitmap(t,s):await async function(t,s){const i=await o.e.get().fetch(t);if(!i.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${i.status} ${i.statusText}`);const e=await i.blob();return"premultiplied-alpha"===s?.data?.alphaMode?createImageBitmap(e,{premultiplyAlpha:"none"}):createImageBitmap(e)}(t,s):await new Promise((s,i)=>{e=o.e.get().createImage(),e.crossOrigin=this.config.crossOrigin,e.src=t,e.complete?s(e):(e.onload=()=>{s(e)},e.onerror=i)}),pt(new lt.b({resource:e,alphaMode:"premultiply-alpha-on-upload",resolution:s.data?.resolution||ft(t),...s.data}),i,t)},unload(t){t.destroy(!0)}};var Ct=n(6139),Tt=n(6858);const $t=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"];let Pt,It;const Et={name:"loadVideo",id:"video",extension:{type:e.Ag.LoadParser,name:"loadVideo"},test(t){if(!Pt||!It){const{validVideoExtensions:t,validVideoMime:s}=function(){const t=[],s=[];for(const i of $t){const e=Ct.$.MIME_TYPES[i.substring(1)]||`video/${i.substring(1)}`;V(e)&&(t.push(i),s.includes(e)||s.push(e))}return{validVideoExtensions:t,validVideoMime:s}}();Pt=t,It=s}const s=J(t,It),i=tt(t,Pt);return s||i},async load(t,s,i){const e={...Ct.$.defaultOptions,resolution:s.data?.resolution||ft(t),alphaMode:s.data?.alphaMode||await(0,Tt.C)(),...s.data},n=document.createElement("video"),r={preload:!1!==e.autoLoad?"auto":void 0,"webkit-playsinline":!1!==e.playsinline?"":void 0,playsinline:!1!==e.playsinline?"":void 0,muted:!0===e.muted?"":void 0,loop:!0===e.loop?"":void 0,autoplay:!1!==e.autoPlay?"":void 0};Object.keys(r).forEach(t=>{const s=r[t];void 0!==s&&n.setAttribute(t,s)}),!0===e.muted&&(n.muted=!0),function(t,s,i){void 0!==i||s.startsWith("data:")?!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous"):t.crossOrigin=function(t,s=globalThis.location){if(t.startsWith("data:"))return"";s||(s=globalThis.location);const i=new URL(t,document.baseURI);return i.hostname!==s.hostname||i.port!==s.port||i.protocol!==s.protocol?"anonymous":""}(s)}(n,t,e.crossorigin);const h=document.createElement("source");let o;if(e.mime)o=e.mime;else if(t.startsWith("data:"))o=t.slice(5,t.indexOf(";"));else if(!t.startsWith("blob:")){const s=t.split("?")[0].slice(t.lastIndexOf(".")+1).toLowerCase();o=Ct.$.MIME_TYPES[s]||`video/${s}`}return h.src=t,o&&(h.type=o),new Promise(r=>{const o=async()=>{const h=new Ct.$({...e,resource:n});var a;n.removeEventListener("canplay",o),s.data.preload&&await(a=n,new Promise((t,s)=>{function i(){n(),t()}function e(t){n(),s(t)}function n(){a.removeEventListener("canplaythrough",i),a.removeEventListener("error",e)}a.addEventListener("canplaythrough",i),a.addEventListener("error",e),a.load()})),r(pt(h,i,t))};e.preload&&!e.autoPlay&&n.load(),n.addEventListener("canplay",o),n.appendChild(h)})},unload(t){t.destroy(!0)}},Bt={extension:{type:e.Ag.ResolveParser,name:"resolveTexture"},test:St.test,parse:t=>({resolution:parseFloat(dt.x.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t})},Rt={extension:{type:e.Ag.ResolveParser,priority:-2,name:"resolveJson"},test:t=>dt.x.RETINA_PREFIX.test(t)&&t.endsWith(".json"),parse:Bt.parse},zt=new class{constructor(){this.qr=[],this.We=!1,this.resolver=new dt.x,this.loader=new K,this.cache=j.l,this.Yr=new F(this.loader),this.Yr.active=!0,this.reset()}async init(t={}){if(this.We)return void(0,G.R)("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");if(this.We=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let s=t.manifest;"string"==typeof s&&(s=await this.load(s)),this.resolver.addManifest(s)}const s=t.texturePreference?.resolution??1,i="number"==typeof s?[s]:s,e=await this.Xr({preferredFormats:t.texturePreference?.format,skipDetections:t.skipDetections,detections:this.qr});this.resolver.prefer({params:{format:e,resolution:i}}),t.preferences&&this.setPreferences(t.preferences),t.loadOptions&&(this.loader.loadOptions={...this.loader.loadOptions,...t.loadOptions})}add(t){this.resolver.add(t)}async load(t,s){this.We||await this.init();const i=(0,Q.a)(t),e=(0,X.z)(t).map(t=>{if("string"!=typeof t){const s=this.resolver.getAlias(t);return s.some(t=>!this.resolver.hasKey(t))&&this.add(t),Array.isArray(s)?s[0]:s}return this.resolver.hasKey(t)||this.add({alias:t,src:t}),t}),n=this.resolver.resolve(e),r=await this.Qr(n,s);return i?r[e[0]]:r}addBundle(t,s){this.resolver.addBundle(t,s)}async loadBundle(t,s){this.We||await this.init();let i=!1;"string"==typeof t&&(i=!0,t=[t]);const e=this.resolver.resolveBundle(t),n={},r=Object.keys(e);let h=0;const o=[],a=r.map((t,i)=>{const r=e[t],a=Object.values(r),c=[...new Set(a.flat())].reduce((t,s)=>t+(s.progressSize||1),0);return o.push(0),h+=c,this.Qr(r,t=>{o[i]=t*c,s?.(o.reduce((t,s)=>t+s,0)/h)}).then(s=>{n[t]=s})});return await Promise.all(a),i?n[t[0]]:n}async backgroundLoad(t){this.We||await this.init(),"string"==typeof t&&(t=[t]);const s=this.resolver.resolve(t);this.Yr.add(Object.values(s))}async backgroundLoadBundle(t){this.We||await this.init(),"string"==typeof t&&(t=[t]);const s=this.resolver.resolveBundle(t);Object.values(s).forEach(t=>{this.Yr.add(Object.values(t))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this.We=!1}get(t){if("string"==typeof t)return j.l.get(t);const s={};for(let i=0;i<t.length;i++)s[i]=j.l.get(t[i]);return s}async Qr(t,s){const i=[...new Set(Object.values(t))];this.Yr.active=!1;const e=await this.loader.load(i,s);this.Yr.active=!0;const n={};return i.forEach(t=>{const s=e[t.src],i=[t.src];t.alias&&i.push(...t.alias),i.forEach(t=>{n[t]=s}),j.l.set(i,s)}),n}async unload(t){this.We||await this.init();const s=(0,X.z)(t).map(t=>"string"!=typeof t?t.src:t),i=this.resolver.resolve(s);await this.Zr(i)}async unloadBundle(t){this.We||await this.init(),t=(0,X.z)(t);const s=this.resolver.resolveBundle(t),i=Object.keys(s).map(t=>this.Zr(s[t]));await Promise.all(i)}async Zr(t){const s=Object.values(t);s.forEach(t=>{j.l.remove(t.src)}),await this.loader.unload(s)}async Xr(t){let s=[];t.preferredFormats&&(s=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const i of t.detections)t.skipDetections||await i.test()?s=await i.add(s):t.skipDetections||(s=await i.remove(s));return s=s.filter((t,i)=>s.indexOf(t)===i),s}get detections(){return this.qr}setPreferences(t){this.loader.parsers.forEach(s=>{s.config&&Object.keys(s.config).filter(s=>s in t).forEach(i=>{s.config[i]=t[i]})})}};e.XO.handleByList(e.Ag.LoadParser,zt.loader.parsers).handleByList(e.Ag.ResolveParser,zt.resolver.parsers).handleByList(e.Ag.CacheParser,zt.cache.parsers).handleByList(e.Ag.DetectionParser,zt.detections),e.XO.add(_,W,U,Y,L,H,q,st,it,ct,gt,St,Et,z,R,Bt,Rt);const Gt={loader:e.Ag.LoadParser,resolver:e.Ag.ResolveParser,cache:e.Ag.CacheParser,detection:e.Ag.DetectionParser};e.XO.handle(e.Ag.Asset,t=>{const s=t.ref;Object.entries(Gt).filter(([t])=>!!s[t]).forEach(([t,i])=>e.XO.add(Object.assign(s[t],{extension:s[t].extension??i})))},t=>{const s=t.ref;Object.keys(Gt).filter(t=>!!s[t]).forEach(t=>e.XO.remove(s[t]))}),n(6557);var Ft=n(9408),jt=n(6844),_t=n(218),Ot=n(2812),Ut=n(4985);class Dt extends Ut.l{constructor(t,s){const{text:i,resolution:e,style:n,anchor:r,width:h,height:o,roundPixels:a,...c}=t;super({...c}),this.batched=!0,this.et=null,this.Kr=!0,this.Jr=!0,this.th=s,this.text=i??"",this.style=n,this.resolution=e??null,this.allowChildren=!1,this.be=new Ot.o({js:()=>{this.onViewUpdate()}}),r&&(this.anchor=r),this.roundPixels=a??!1,void 0!==h&&(this.width=h),void 0!==o&&(this.height=o)}get anchor(){return this.be}set anchor(t){"number"==typeof t?this.be.set(t):this.be.copyFrom(t)}set text(t){t=t.toString(),this.sh!==t&&(this.sh=t,this.onViewUpdate())}get text(){return this.sh}set resolution(t){this.Kr=null===t,this.et=t,this.onViewUpdate()}get resolution(){return this.et}get style(){return this.ot}set style(t){t||(t={}),this.ot?.off("update",this.onViewUpdate,this),t instanceof this.th?this.ot=t:this.ot=new this.th(t),this.ot.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(t){this.ve(t,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(t){this.Ae(t,this.bounds.height)}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this.bounds.width,t.height=Math.abs(this.scale.y)*this.bounds.height,t}setSize(t,s){"object"==typeof t?(s=t.height??t.width,t=t.width):s??(s=t),void 0!==t&&this.ve(t,this.bounds.width),void 0!==s&&this.Ae(s,this.bounds.height)}containsPoint(t){const s=this.bounds.width,i=this.bounds.height,e=-s*this.anchor.x;let n=0;return t.x>=e&&t.x<=e+s&&(n=-i*this.anchor.y,t.y>=n&&t.y<=n+i)}onViewUpdate(){this.didViewUpdate||(this.Jr=!0),super.onViewUpdate()}destroy(t=!1){super.destroy(t),this.owner=null,this._i=null,this.be=null,("boolean"==typeof t?t:t?.style)&&this.ot.destroy(t),this.ot=null,this.sh=null}get styleKey(){return`${this.sh}:${this.ot.styleKey}:${this.et}`}}var Wt,Nt,Vt=n(9492),Lt=n(4016),Ht=n(8291);class qt extends Dt{constructor(...t){const s=function(t){let s=t[0]??{};return("string"==typeof s||t[1])&&((0,m.t6)(m.lj,'use new Text({ text: "hi!", style }) instead'),s={text:s,style:t[1]}),s}(t);super(s,Ht.x),this.renderPipeId="text",s.textureStyle&&(this.textureStyle=s.textureStyle instanceof _t.n?s.textureStyle:new _t.n(s.textureStyle))}updateBounds(){const t=this._i,s=this.be;let i=0,e=0;if(this.ot.trim){const{frame:t,canvasAndContext:s}=Vt.v.getCanvasAndContext({text:this.text,style:this.ot,resolution:1});Vt.v.returnCanvasAndContext(s),i=t.width,e=t.height}else{const t=Lt.P.measureText(this.sh,this.ot);i=t.width,e=t.height}t.minX=-s.vs*i,t.maxX=t.minX+i,t.minY=-s.xs*e,t.maxY=t.minY+e}}n(4486),e.XO.add(r,h);class Yt{constructor(t){this.app=null,this.timeoutId=null,this.gameManager=t,this.container=document.createElement("div")}async init(){console.log("[IntroScreen] init() called");const t=this.gameManager.getUILayer();this.container.style.cssText="\n            width: 100%;\n            height: 100%;\n            position: relative;\n        ",console.log("[IntroScreen] Getting game key...");const s=await i.getGameKey(),e=Date.now();this.gameManager.setGameData({gameKey:s,startTime:e}),console.log("[IntroScreen] Game key received:",s);const n=document.getElementById("game-canvas");if(!n)return void console.error("[IntroScreen] Canvas not found!");console.log("[IntroScreen] Canvas found");const r=window.__pixiApp;if(r)try{r.stage&&r.renderer&&(r.stage.destroy({children:!0}),r.renderer.destroy&&r.renderer.destroy()),window.__pixiApp=null}catch(t){console.warn("Failed to destroy existing Pixi app:",t),window.__pixiApp=null}this.app=new b,await this.app.init({canvas:n,width:720,height:1280,backgroundColor:0}),window.__pixiApp=this.app;const h=new Ft.A;h.rect(0,0,720,1280),h.fill(1710638);const o=new qt(" !",{fontSize:48,fill:16777215});o.anchor.set(.5),o.x=360,o.y=640,h.addChild(o),this.app.stage.addChild(h),console.log("[IntroScreen] Setting timeout for 3000ms, isDevelopment: false");const a=this.gameManager;this.timeoutId=window.setTimeout(()=>{console.log("[IntroScreen] Timeout fired, switching to game screen"),null!==this.timeoutId&&a.showScreen(Nt.GAME)},3e3),t.appendChild(this.container)}destroy(){null!==this.timeoutId&&(console.log("[IntroScreen] Clearing timeout"),clearTimeout(this.timeoutId),this.timeoutId=null),this.app=null,this.container.parentNode&&this.container.parentNode.removeChild(this.container)}}class Xt{constructor(t,s,i,e,n){this.breakTimer=0,this.isBreaking=!1,this.breakCallback=null,this.type=t,this.x=s,this.y=i,this.width=e,this.height=n,this.sprite=new Ft.A,this.sprite.x=s,this.sprite.y=i,this.updateSprite()}updateSprite(){this.sprite.clear();let t=3046706,s=1793568;if(this.type===Wt.BREAKABLE_ICE?(t=16739179,s=13840175):this.type===Wt.WIDE_ICE&&(t=4367861,s=1668818),this.isBreaking){const i=1-this.breakTimer/3;this.sprite.rect(0,0,this.width,this.height),this.sprite.stroke({color:s,width:2,alpha:i}),this.sprite.rect(2,2,this.width-4,this.height-4),this.sprite.fill({color:t,alpha:i})}else this.sprite.rect(0,0,this.width,this.height),this.sprite.stroke({color:s,width:2}),this.sprite.rect(2,2,this.width-4,this.height-4),this.sprite.fill(t);this.sprite.x=this.x,this.sprite.y=this.y}startBreaking(t){this.isBreaking||(this.isBreaking=!0,this.breakCallback=t,this.breakTimer=0)}update(t){this.sprite&&!this.sprite.destroyed&&this.isBreaking&&(this.breakTimer+=t/1e3,this.updateSprite(),this.breakTimer>=3&&this.breakCallback&&this.breakCallback())}getType(){return this.type}getBounds(){return{x:this.x,y:this.y,width:this.width,height:this.height}}getSprite(){return this.sprite}destroy(){this.sprite&&!this.sprite.destroyed&&(this.sprite.parent&&this.sprite.parent.removeChild(this.sprite),this.sprite.destroy()),this.sprite=null}}class Qt{constructor(t,s,i,e){this.velocityX=0,this.velocityY=0,this.gravity=.5,this.direction=1,this.textureL=null,this.textureR=null,this.isJumping=!1,this.jumpStartX=0,this.jumpStartY=0,this.jumpTargetX=0,this.jumpTargetY=0,this.jumpProgress=0,this.jumpDuration=0,this.jumpStartTime=0,this.characterId=t,this.x=s,this.y=i,this.onTextureLoaded=e,this.velocityY=0,this.sprite=new jt.k,this.sprite.x=s,this.sprite.y=i,this.sprite.anchor.set(.5),this.sprite.visible=!0,this.sprite.alpha=1,this.sprite.hitArea=new M.M(-25,-35,50,70),this.loadTextures()}async loadTextures(){try{const t=this.characterId+1,s=`images/${t}L.png`,i=`images/${t}R.png`;this.textureL=await zt.load(s),this.textureR=await zt.load(i);const e=this.textureL&&this.textureL.width||this.textureR&&this.textureR.width||1024,n=this.textureL&&this.textureL.height||this.textureR&&this.textureR.height||1024,r=50/e,h=70/n;this.sprite.scale.set(r,h),this.updateSprite(),this.sprite.texture&&this.sprite.texture!==k.g.EMPTY&&(this.sprite.hitArea=new M.M(-this.sprite.width/2/r,-this.sprite.height/2/h,this.sprite.width/r,this.sprite.height/h)),this.sprite.x=this.x,this.sprite.y=this.y,this.sprite.visible=!0,this.sprite.alpha=1,this.sprite.texture,this.onTextureLoaded&&this.onTextureLoaded()}catch(t){console.error(`[Character] Failed to load character images for ID ${this.characterId}:`,t),this.textureL=k.g.EMPTY,this.textureR=k.g.EMPTY,this.updateSprite()}}updateSprite(){if(!this.sprite||this.sprite.destroyed)return;const t=this.direction>0?this.textureR:this.textureL;t&&t!==k.g.EMPTY&&(this.sprite.texture=t)}update(t){if(this.sprite&&!this.sprite.destroyed){if(this.isJumping){const t=Date.now()-this.jumpStartTime;this.jumpProgress=Math.min(1,t/this.jumpDuration);const s=this.jumpProgress,i=s<.5?2*s*s:1-Math.pow(-2*s+2,2)/2,e=this.jumpTargetX-this.jumpStartX,n=this.jumpTargetY-this.jumpStartY,r=60+Math.sqrt(e*e+n*n)/144*30;this.x=this.jumpStartX+(this.jumpTargetX-this.jumpStartX)*i;const h=this.jumpTargetY-this.jumpStartY,o=r*(4*s*(1-s));this.y=this.jumpStartY+h*s-o,this.jumpProgress>=1&&(this.isJumping=!1,this.x=this.jumpTargetX,this.y=this.jumpTargetY,this.velocityX=0,this.velocityY=0)}else this.x+=this.velocityX*(t/16.67),this.y+=this.velocityY*(t/16.67);this.sprite&&!this.sprite.destroyed&&(this.sprite.x=this.x,this.sprite.y=this.y,this.sprite.visible||(this.sprite.visible=!0),this.sprite.alpha<1&&(this.sprite.alpha=1))}}jumpTo(t,s){this.jumpStartX=this.x,this.jumpStartY=this.y,this.jumpTargetX=t,this.jumpTargetY=s;const i=t-this.jumpStartX,e=s-this.jumpStartY,n=Math.sqrt(i*i+e*e)/144;this.jumpDuration=400*Math.max(.5,Math.min(2,n)),this.isJumping=!0,this.jumpProgress=0,this.jumpStartTime=Date.now(),this.velocityX=0,this.velocityY=0}applyGravity(){this.isJumping||(this.velocityY+=this.gravity)}setX(t){this.x=t,this.sprite&&!this.sprite.destroyed&&(this.sprite.x=t)}setY(t){this.y=t,this.sprite&&!this.sprite.destroyed&&(this.sprite.y=t)}setVelocityY(t){this.velocityY=t}setDirection(t){this.direction!==t&&(this.direction=t,this.updateSprite())}getX(){return this.x}getY(){return this.y}getVelocityY(){return this.velocityY}getIsJumping(){return this.isJumping}getBounds(){let t=this.sprite.width,s=this.sprite.height;return(!t||t<=1||t>200||!s||s<=1||s>200)&&(t=50,s=70),{x:this.x-t/2,y:this.y-s/2,width:t,height:s}}getSprite(){return this.sprite}destroy(){this.sprite&&!this.sprite.destroyed&&(this.sprite.parent&&this.sprite.parent.removeChild(this.sprite),this.sprite.destroy()),this.sprite=null}}class Zt{constructor(t,s,i){this.text=null,this.velocityY=2,this.type=t,this.x=s,this.y=i,this.itemNumber="obstacle"===t?1:"star"===t?2:3,this.sprite=new p.mc,this.sprite.x=s,this.sprite.y=i,this.graphics=new Ft.A,this.sprite.addChild(this.graphics),this.updateSprite()}updateSprite(){this.graphics.clear();let t=16711680,s="circle";if("star"===this.type?(t=16766720,s="star"):"bottle"===this.type&&(t=65280,s="rect"),"circle"===s)this.graphics.circle(0,0,15),this.graphics.fill(t);else if("star"===s){const s=5,i=15,e=8,n=2*Math.PI/s;for(let t=0;t<2*s;t++){const s=t%2==0?i:e,r=t*n/2-Math.PI/2,h=Math.cos(r)*s,o=Math.sin(r)*s;0===t?this.graphics.moveTo(h,o):this.graphics.lineTo(h,o)}this.graphics.closePath(),this.graphics.fill(t)}else this.graphics.rect(-10,-20,20,40),this.graphics.fill(t);this.text&&(this.sprite.removeChild(this.text),this.text.destroy()),this.text=new qt({text:this.itemNumber.toString(),style:{fontSize:16,fill:16777215,fontWeight:"bold",stroke:{color:0,width:2}}}),this.text.anchor.set(.5),this.text.x=0,this.text.y=0,this.sprite.addChild(this.text),this.sprite.x=this.x,this.sprite.y=this.y}update(t){this.sprite&&!this.sprite.destroyed&&(this.y+=this.velocityY*(t/16.67),this.sprite.y=this.y)}getType(){return this.type}getX(){return this.x}getY(){return this.y}getBounds(){return{x:this.x-15,y:this.y-15,width:30,height:30}}getSprite(){return this.sprite}getItemNumber(){return this.itemNumber}getItemDescription(){return 1===this.itemNumber?" (1):  -3":2===this.itemNumber?" (2):  3 ":" (3):  +10"}destroy(){this.text&&(this.text.parent&&this.text.parent.removeChild(this.text),this.text.destroy(),this.text=null),this.graphics&&(this.graphics.parent&&this.graphics.parent.removeChild(this.graphics),this.graphics.destroy()),this.sprite&&!this.sprite.destroyed&&(this.sprite.parent&&this.sprite.parent.removeChild(this.sprite),this.sprite.destroy()),this.sprite=null}}!function(t){t.NORMAL="normal",t.BREAKABLE_ICE="breakable_ice",t.WIDE_ICE="wide_ice"}(Wt||(Wt={}));class Kt{constructor(t,s){this.platforms=[],this.items=[],this.camera={x:0,y:0},this.timeRemaining=300,this.score=0,this.isPaused=!1,this.itemSpawnTimer=0,this.platformWidth=144,this.platformHeight=30,this.gridSize=144,this.lastPlatformY=0,this.lastPlatformX=0,this.startPlatformY=0,this.direction=1,this.starPauseTimer=0,this.isStarPaused=!1,this.canJump=!0,this.lastCameraY=0,this.wasJumping=!1,this.tickerCallback=null,this.app=t,this.createInitialPlatforms(360,995),this.camera.x=0+this.platformWidth/2,this.camera.y=0,this.lastCameraY=this.camera.y,this.character=new Qt(s,360,960,()=>{if(this.character&&this.platforms.length>0){const t=this.platforms[0].getBounds(),s=this.character.getBounds(),i=t.y-s.height/2;this.character.setY(i),this.character.setVelocityY(0);const e=this.character.getSprite();e.visible=!0,e.alpha=1,e.x=this.character.getX(),e.y=this.character.getY()}});const i=this.character.getSprite();this.app.stage.addChild(i),this.app.stage.setChildIndex(i,this.app.stage.children.length-1),this.render(),this.startGameLoop()}createInitialPlatforms(t,s){if(!this.app||!this.app.stage)return void console.error("[Game] Cannot create initial platforms: app or stage is null");const i=new Xt(Wt.NORMAL,t-this.platformWidth/2,s,this.platformWidth,this.platformHeight);this.platforms.push(i),this.app.stage.addChild(i.getSprite()),this.lastPlatformY=s,this.lastPlatformX=t,this.startPlatformY=s,console.log("[Game] Initial platform created at:",t,s),console.log("[Game] Total platforms after initial:",this.platforms.length);for(let t=0;t<20;t++)this.generatePlatforms();console.log("[Game] Total platforms after generation:",this.platforms.length);let e=this.lastPlatformX,n=this.lastPlatformY;for(let t=0;t<5;t++){const t=Math.random()<.5?1:-1,s=Math.random()<.5?1:2,i=n+this.gridSize*s,r=e+this.gridSize*s*t;if(r<this.platformWidth/2||r>720-this.platformWidth/2)continue;const h=this.platforms.find(t=>{const s=t.getBounds().y;return Math.abs(s-i)<this.gridSize/2});if(h)continue;const o=new Xt(Wt.NORMAL,r-this.platformWidth/2,i,this.platformWidth,this.platformHeight);this.platforms.push(o),this.app.stage.addChild(o.getSprite()),n=i,e=r}}generatePlatforms(){if(!this.app||!this.app.stage)return;const t=this.camera.y,s=Math.floor(5*Math.random())+1,i=Math.random()<.5?1:-1;let e=this.lastPlatformX,n=this.lastPlatformY;const r=new Set;for(let h=0;h<s;h++){const s=Math.random()<.5?1:2,h=n-this.gridSize*s,o=e+this.gridSize*s*i;if(o<this.platformWidth/2||o>720-this.platformWidth/2){const t=-1*i,n=e+this.gridSize*s*t;if(!(n>=this.platformWidth/2&&n<=720-this.platformWidth/2))continue;e=n}else e=o;const a=Math.round(h/this.gridSize);if(r.has(a))continue;if(this.platforms.find(t=>{const s=t.getBounds().y;return Math.abs(s-h)<this.gridSize/2}))continue;if(h>t+2560)continue;const c=Math.abs(h-this.startPlatformY),l=(Math.floor(c/this.gridSize),this.determinePlatformTypeByHeight(h,s,n)),u=l===Wt.WIDE_ICE?2*this.platformWidth:this.platformWidth,d=new Xt(l,e-u/2,h,u,this.platformHeight);this.platforms.push(d),this.app.stage.addChild(d.getSprite()),this.platforms.length<=10&&console.log(`[Game] Platform created: type=${l}, x=${e-u/2}, y=${h}, width=${u}`),r.add(a),n=h,this.lastPlatformY=h,this.lastPlatformX=e}if(this.platforms.length>0){const t=this.platforms.reduce((t,s)=>{const i=t.getBounds().y;return s.getBounds().y<i?s:t}),s=t.getBounds().y;if(s<this.lastPlatformY){this.lastPlatformY=s;const i=t.getBounds();this.lastPlatformX=i.x+i.width/2}}}selectRandomCandidates(t,s){return[...t].sort(()=>Math.random()-.5).slice(0,Math.min(s,t.length))}determinePlatformTypeByHeight(t,s,i){const e=Math.abs(t-i),n=Math.floor(e/this.gridSize);let r,h,o,a,c,l,u,d;n<=10?(r=4,h=4,o=1,a=1,c=1,l=1):n<=20?(r=3,h=3,o=1,a=1,c=2,l=2):n<=30?(r=3,h=3,o=1,a=1,c=3,l=3):n<=40?(r=3,h=3,o=1,a=1,c=4,l=4):(r=3,h=3,o=1,a=1,c=5,l=5),1===s?(u=[r,o,c],d=[Wt.NORMAL,Wt.WIDE_ICE,Wt.BREAKABLE_ICE]):(u=[h,a,l],d=[Wt.NORMAL,Wt.WIDE_ICE,Wt.BREAKABLE_ICE]);const f=u.reduce((t,s)=>t+s,0);let p=Math.random()*f;for(let t=0;t<u.length;t++)if(p-=u[t],p<=0)return d[t];return Wt.NORMAL}determinePlatformType(t){const s=this.startPlatformY,i=Math.abs(t-s),e=Math.floor(i/this.gridSize);if(e>0&&e%10==0){let t=1;e>=500?t=5:e>=400?t=4:e>=300?t=3:(e>=200||e>=100)&&(t=2);const s=Math.min(.9,.2*t);if(Math.random()<s)return Wt.BREAKABLE_ICE}return Math.random()<.1?Wt.WIDE_ICE:Wt.NORMAL}update(){if(!this.app||!this.app.ticker)return;const t=this.app.ticker.deltaMS;if(t&&!(t<=0)){if(this.isStarPaused?(this.starPauseTimer-=t/1e3,this.starPauseTimer<=0&&(this.isStarPaused=!1)):this.timeRemaining-=t/1e3,this.timeRemaining<=0)return this.timeRemaining=0,void this.endGame();this.character&&(this.wasJumping=this.character.getIsJumping(),this.character.update(t)),this.platforms.forEach(s=>{s.update(t)}),this.checkPlatformCollisions(),this.character&&this.wasJumping&&!this.character.getIsJumping()&&this.checkJumpLanding(),this.itemSpawnTimer+=t/1e3,this.itemSpawnTimer>=5&&(this.spawnItem(),this.itemSpawnTimer=0);for(let s=this.items.length-1;s>=0;s--){const i=this.items[s];i.getY()>this.camera.y+1280+100?(i.destroy(),this.items.splice(s,1)):i.update(t)}if(this.checkItemCollisions(),this.updateCamera(),this.app){const t=this.camera.y-1920;this.lastPlatformY>t&&this.generatePlatforms()}if(this.character){const t=960,s=Math.floor((t-this.character.getY())/this.gridSize);s>this.score&&(this.score=s)}}}checkPlatformCollisions(){if(!this.character)return;const t=this.character.getBounds(),s=t.width||50,i=t.height||70,e=t.y+i,n=t.x+s/2,r=this.character.getIsJumping();let h=!1;for(let t=0;t<this.platforms.length&&!h;t++){const s=this.platforms[t],o=s.getBounds(),a=o.y,c=o.y+o.height,l=r?120:80,u=n>=o.x&&n<=o.x+o.width,d=e>=a-l&&e<=a+l||!r&&e>=a&&e<=c+l,f=this.character.getVelocityY();if(u&&d&&(f>=-20||!r)){const e=a-i/2;this.character.setY(e),this.character.setVelocityY(0),h=!0,this.canJump=!0,s.getType()===Wt.BREAKABLE_ICE&&s.startBreaking(()=>{s.destroy(),this.platforms.splice(t,1)})}}if(h||(this.character.applyGravity(),this.canJump=!1),i>0){const t=1280,s=this.camera.y+t,i=this.character.getY();e>s&&i>1160&&this.endGame()}}checkJumpLanding(){if(!this.character||this.character.getIsJumping())return;const t=this.character.getBounds(),s=(t.width,t.height||70),i=this.character.getX(),e=this.character.getY();let n=null,r=1/0;for(const t of this.platforms){const s=t.getBounds(),h=e-s.y;if(i>=s.x&&i<=s.x+s.width&&h>=-50&&h<=100){const s=Math.abs(h);s<r&&(r=s,n=t)}}if(n&&r<150){const t=n.getBounds().y-s/2;if(this.character.setY(t),this.character.setVelocityY(0),this.canJump=!0,n.getType()===Wt.BREAKABLE_ICE){const t=this.platforms.indexOf(n);n.startBreaking(()=>{n.destroy(),this.platforms.splice(t,1)})}}}checkItemCollisions(){if(!this.character)return;const t=this.character.getBounds();for(let s=this.items.length-1;s>=0;s--){const i=this.items[s],e=i.getBounds();t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y&&(this.handleItemCollision(i),i.destroy(),this.items.splice(s,1))}}handleItemCollision(t){const s=t.getType();"obstacle"===s?this.timeRemaining=Math.max(0,this.timeRemaining-3):"star"===s?(this.isStarPaused=!0,this.starPauseTimer=3):"bottle"===s&&(this.timeRemaining+=10)}spawnItem(){if(!this.app||!this.app.stage)return;const t=this.camera.y,s=this.camera.y+1280,i=this.platforms.filter(i=>{const e=i.getBounds().y;return e>=t-100&&e<=s+100});if(0===i.length)return;const e=i[Math.floor(Math.random()*i.length)].getBounds(),n=e.x+e.width/2,r=e.y-50,h=new Zt(["obstacle","star","bottle"][Math.floor(3*Math.random())],n,r);this.items.push(h),this.app.stage.addChild(h.getSprite())}updateCamera(){if(!this.character)return;const t=this.character.getY(),s=this.character.getX(),i=this.camera.y;if(t-this.camera.y<960&&(this.camera.y=t-960),this.camera.y<i){const t=this.camera.y-1920;this.lastPlatformY>t&&this.generatePlatforms()}this.camera.x=s-360+this.platformWidth/2,this.lastCameraY=this.camera.y}render(){this.app&&this.app.stage&&this.app.stage.position&&this.app.stage.position.set(-this.camera.x,-this.camera.y)}jump(t){if(this.isPaused)return;if(!this.character)return;if(!this.canJump)return;const s=t?this.gridSize:2*this.gridSize,i=this.character.getX()+s*this.direction,e=this.character.getY()-s;this.character.jumpTo(i,e),this.canJump=!1}changeDirection(){this.character&&(this.direction*=-1,this.character.setDirection(this.direction))}getTimeRemaining(){return this.timeRemaining}getScore(){return this.score}pause(){this.isPaused=!0}resume(){this.isPaused=!1}endGame(){this.isPaused=!0;const t=new CustomEvent("gameEnd",{detail:{score:this.score}});window.dispatchEvent(t)}startGameLoop(){this.app&&this.app.ticker?(this.tickerCallback=()=>{if(!this.isPaused&&this.app&&this.app.stage&&!this.app.stage.destroyed&&this.app.ticker&&this.app.renderer)try{this.update(),this.render()}catch(t){if(console.warn("[Game] Error in ticker callback:",t),this.app&&this.app.ticker&&this.tickerCallback)try{this.app.ticker.remove(this.tickerCallback)}catch(t){console.warn("[Game] Error removing ticker callback after error:",t)}}},this.app.ticker.add(this.tickerCallback)):console.error("[Game] Cannot start game loop: app or ticker is null")}destroy(){if(this.tickerCallback&&this.app&&this.app.ticker){try{this.app.ticker.remove(this.tickerCallback)}catch(t){console.warn("[Game] Error removing ticker callback:",t)}this.tickerCallback=null}if(this.platforms.forEach(t=>{if(t){const s=t.getSprite();s&&s.parent&&s.parent.removeChild(s),t.destroy()}}),this.platforms=[],this.items.forEach(t=>{if(t){const s=t.getSprite();s&&s.parent&&s.parent.removeChild(s),t.destroy()}}),this.items=[],this.character){const t=this.character.getSprite();t&&t.parent&&t.parent.removeChild(t),this.character.destroy(),this.character=null}}}class Jt{constructor(t){this.app=null,this.game=null,this.jumpButton=null,this.directionButton=null,this.timeBar=null,this.scoreText=null,this.jumpStartTime=0,this.isJumping=!1,this.introTimeoutId=null,this.isIntroPhase=!0,this.uiUpdateCallback=null,this.gameManager=t,this.container=document.createElement("div")}async init(){console.log("[GameScreen] init() started");try{const t=this.gameManager.getUILayer();this.container.style.cssText="\n                width: 100%;\n                height: 100%;\n                position: relative;\n            ",console.log("[GameScreen] Checking for existing app...");const s=window.__pixiApp;if(s)try{if(s&&s.stage&&s.renderer){s.ticker&&s.ticker.started&&s.ticker.stop();try{s.stage.removeChildren()}catch(t){console.warn("Error removing stage children:",t)}try{s.stage.destroy&&s.stage.destroy({children:!0})}catch(t){console.warn("Error destroying stage:",t)}try{s.renderer&&s.renderer.destroy&&s.renderer.destroy()}catch(t){console.warn("Error destroying renderer:",t)}}window.__pixiApp=null}catch(t){console.warn("Failed to destroy existing Pixi app:",t),window.__pixiApp=null}console.log("[GameScreen] Creating Pixi Application...");try{const t={width:720,height:1280,backgroundColor:0,antialias:!0,resolution:window.devicePixelRatio||1,autoDensity:!0};this.app=new b,await this.app.init(t);const s=document.getElementById("game-container");s&&s.appendChild(this.app.canvas),console.log("[GameScreen] Pixi app initialized successfully"),console.log("[GameScreen] Renderer type:",this.app.renderer.type)}catch(t){console.error("[GameScreen] Pixi app init failed:",t)}window.__pixiApp=this.app,console.log("[GameScreen] Getting game key...");const e=await i.getGameKey(),n=Date.now();this.gameManager.setGameData({gameKey:e,startTime:n}),console.log("[GameScreen] Game key received:",e),this.showIntroScreen();const r=3e3;console.log(`[GameScreen] Intro will last ${r}ms`),this.introTimeoutId=window.setTimeout(()=>{this.startGame()},r),t.appendChild(this.container),console.log("[GameScreen] init() completed successfully")}catch(t){throw console.error("[GameScreen] Error in init():",t),t}}showIntroScreen(){if(!this.app||!this.app.stage)return;console.log("[GameScreen] Showing intro screen"),this.isIntroPhase=!0;const t=new Ft.A;t.rect(0,0,720,1280),t.fill(1710638);const s=new qt({text:" !",style:{fontSize:48,fill:16777215}});s.anchor.set(.5),s.x=360,s.y=640,t.addChild(s),this.app.stage.addChild(t),console.log("[GameScreen] Intro screen added to stage, children count:",this.app.stage.children.length)}startGame(){if(!this.app)return;console.log("[GameScreen] Starting game"),this.isIntroPhase=!1,this.app.stage&&this.app.stage.removeChildren(),this.app.renderer&&this.app.renderer.background&&(this.app.renderer.background.color=8900331);const t=this.app.canvas,s=document.getElementById("game-container");s&&(s.style.width="720px",s.style.height="1280px",console.log("[GameScreen] Game container size set:",{width:s.style.width,height:s.style.height,offsetWidth:s.offsetWidth,offsetHeight:s.offsetHeight})),t&&(t.style.cssText="\n                    width: 720px !important;\n                    height: 1280px !important;\n                    display: block !important;\n                    position: absolute !important;\n                    top: 0 !important;\n                    left: 0 !important;\n                ",t.width=720,t.height=1280),t&&s&&t.parentElement!==s&&(console.warn("[GameScreen] Canvas is not in game-container, moving it..."),s.appendChild(t)),setTimeout(()=>{if(t){const i=window.getComputedStyle(t);console.log("[GameScreen] Canvas check (after style):",{exists:!!t,width:t.width,height:t.height,offsetWidth:t.offsetWidth,offsetHeight:t.offsetHeight,clientWidth:t.clientWidth,clientHeight:t.clientHeight,style:i.display,computedWidth:i.width,computedHeight:i.height,computedPosition:i.position,computedTop:i.top,computedLeft:i.left,parent:t.parentElement?.tagName,parentId:t.parentElement?.id,parentWidth:t.parentElement?.offsetWidth,parentHeight:t.parentElement?.offsetHeight,inDOM:document.body.contains(t),inGameContainer:s?.contains(t)}),0!==t.offsetWidth&&0!==t.offsetHeight||(console.warn("[GameScreen] Canvas size is still 0, trying to fix..."),t.style.setProperty("width","720px","important"),t.style.setProperty("height","1280px","important"),t.style.setProperty("min-width","720px","important"),t.style.setProperty("min-height","1280px","important"))}},100),console.log("[GameScreen] Canvas check:",{exists:!!t,width:t?.width,height:t?.height,offsetWidth:t?.offsetWidth,offsetHeight:t?.offsetHeight,style:t?window.getComputedStyle(t).display:"N/A",computedWidth:t?window.getComputedStyle(t).width:"N/A",computedHeight:t?window.getComputedStyle(t).height:"N/A",parent:t?.parentElement?.tagName,inDOM:!!t&&document.body.contains(t)}),this.app.renderer&&(this.app.renderer.render(this.app.stage),console.log("[GameScreen] Forced render executed, stage children:",this.app.stage.children.length));const i=this.gameManager.getGameData();console.log("[GameScreen] Creating game with characterId:",i.characterId),this.game=new Kt(this.app,i.characterId),console.log("[GameScreen] Game created"),console.log("[GameScreen] Creating UI..."),this.createUI(),window.addEventListener("gameEnd",this.handleGameEnd.bind(this)),this.uiUpdateCallback=()=>{this.game&&this.app&&this.updateUI()},this.app.ticker.add(this.uiUpdateCallback)}checkWebGLSupport(){try{const t=document.createElement("canvas");return!(!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(t){return!1}}createUI(){const t=document.createElement("div");t.style.cssText="\n            position: absolute;\n            top: 20px;\n            left: 20px;\n            right: 20px;\n            z-index: 1001;\n            background: rgba(0, 0, 0, 0.5);\n            padding: 10px;\n            border-radius: 10px;\n        ";const s=document.createElement("div");s.textContent=" ",s.style.cssText="color: white; font-size: 18px; margin-bottom: 5px;",this.timeBar=document.createElement("div"),this.timeBar.style.cssText="\n            width: 100%;\n            height: 30px;\n            background: #333;\n            border-radius: 5px;\n            overflow: hidden;\n        ";const i=document.createElement("div");i.id="time-bar-fill",i.style.cssText="\n            width: 100%;\n            height: 100%;\n            background: linear-gradient(90deg, #4CAF50 0%, #8BC34A 100%);\n            transition: width 0.1s linear;\n        ",this.timeBar.appendChild(i),t.appendChild(s),t.appendChild(this.timeBar),this.scoreText=document.createElement("div"),this.scoreText.id="score-text",this.scoreText.textContent="0m",this.scoreText.style.cssText="\n            position: absolute;\n            top: 80px;\n            left: 50%;\n            transform: translateX(-50%);\n            z-index: 1001;\n            color: white;\n            font-size: 24px;\n            font-weight: bold;\n            background: rgba(0, 0, 0, 0.5);\n            padding: 10px 20px;\n            border-radius: 10px;\n        ";const e=document.createElement("div");e.style.cssText="\n            position: absolute;\n            bottom: 20px;\n            left: 0;\n            right: 0;\n            display: flex;\n            justify-content: space-between;\n            padding: 0 20px;\n            z-index: 1001;\n        ",this.directionButton=document.createElement("button"),this.directionButton.textContent="",this.directionButton.style.cssText="\n            width: 80px;\n            height: 80px;\n            font-size: 36px;\n            border-radius: 50%;\n            background: rgba(255, 255, 255, 0.8);\n        ",this.directionButton.onclick=()=>{this.game&&this.game.changeDirection()},this.jumpButton=document.createElement("button"),this.jumpButton.textContent="",this.jumpButton.style.cssText="\n            width: 120px;\n            height: 80px;\n            font-size: 24px;\n            border-radius: 50%;\n            background: rgba(255, 107, 107, 0.9);\n        ",this.jumpButton.addEventListener("mousedown",this.startJump.bind(this)),this.jumpButton.addEventListener("mouseup",this.endJump.bind(this)),this.jumpButton.addEventListener("mouseleave",this.endJump.bind(this)),this.jumpButton.addEventListener("touchstart",this.startJump.bind(this)),this.jumpButton.addEventListener("touchend",this.endJump.bind(this)),e.appendChild(this.directionButton),e.appendChild(this.jumpButton),this.container.appendChild(t),this.container.appendChild(this.scoreText),this.container.appendChild(e)}startJump(t){t.preventDefault(),this.isJumping=!0,this.jumpStartTime=Date.now()}endJump(t){if(t.preventDefault(),!this.isJumping||!this.game)return;const s=Date.now()-this.jumpStartTime<300;this.game.jump(s),this.isJumping=!1}updateUI(){if(!this.game)return;const t=this.game.getTimeRemaining()/300*100,s=document.getElementById("time-bar-fill");s&&(s.style.width=`${Math.max(0,t)}%`,s.style.background=t<20?"linear-gradient(90deg, #f44336 0%, #ff5252 100%)":t<50?"linear-gradient(90deg, #ff9800 0%, #ffb74d 100%)":"linear-gradient(90deg, #4CAF50 0%, #8BC34A 100%)"),this.scoreText&&(this.scoreText.textContent=`${this.game.getScore()}m`)}handleGameEnd(t){const s=t.detail.score;this.gameManager.setGameData({score:s}),this.gameManager.showScreen(Nt.RESULT)}destroy(){if(null!==this.introTimeoutId&&(clearTimeout(this.introTimeoutId),this.introTimeoutId=null),window.removeEventListener("gameEnd",this.handleGameEnd.bind(this)),this.app)try{if(this.uiUpdateCallback&&this.app.ticker){try{this.app.ticker.remove(this.uiUpdateCallback)}catch(t){console.warn("[GameScreen] Error removing UI update callback:",t)}this.uiUpdateCallback=null}if(this.app.ticker)try{this.app.ticker.started&&this.app.ticker.stop()}catch(t){console.warn("[GameScreen] Error stopping ticker:",t)}}catch(t){console.warn("[GameScreen] Error cleaning up ticker:",t)}if(this.game&&(this.game.destroy(),this.game=null),this.app){try{if(this.app.stage)try{const t=this.app.stage;[...t.children].forEach(s=>{try{s&&!s.destroyed&&t&&t.removeChild(s)}catch(t){console.warn("[GameScreen] Error removing child:",t)}})}catch(t){console.warn("[GameScreen] Error removing children:",t)}if(this.app.destroy)try{this.app.destroy(!0)}catch(t){console.warn("[GameScreen] Error destroying app:",t);try{this.app.stage&&this.app.stage.destroy({children:!0}),this.app.renderer&&this.app.renderer.destroy&&this.app.renderer.destroy()}catch(t){console.warn("[GameScreen] Error in manual cleanup:",t)}}else this.app.stage&&this.app.stage.destroy({children:!0}),this.app.renderer&&this.app.renderer.destroy&&this.app.renderer.destroy()}catch(t){console.warn("[GameScreen] Error destroying Pixi app:",t)}this.app=null,window.__pixiApp&&(window.__pixiApp=null)}this.container.parentNode&&this.container.parentNode.removeChild(this.container)}}class ts{constructor(t){this.gameManager=t,this.container=document.createElement("div")}async init(){const t=this.gameManager.getUILayer();this.container.style.cssText="\n            width: 100%;\n            height: 100%;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            background: rgba(0, 0, 0, 0.9);\n            color: white;\n            padding: 40px;\n        ";const s=document.createElement("div");s.style.cssText="\n            width: 100%;\n            max-width: 600px;\n            text-align: center;\n        ";const e=document.createElement("h1");e.textContent=" ",e.style.cssText="\n            font-size: 32px;\n            margin-bottom: 30px;\n        ";const n=document.createElement("div");n.textContent=" ...",n.style.cssText="font-size: 20px; margin-bottom: 20px;";const r=document.createElement("div");r.id="ranking-list",r.style.cssText="\n            text-align: left;\n            font-size: 18px;\n            line-height: 2;\n            margin-bottom: 30px;\n        ";const h=document.createElement("button");h.textContent="",h.style.cssText="\n            width: 200px;\n            height: 60px;\n            font-size: 24px;\n        ",h.onclick=()=>{this.gameManager.showScreen(Nt.START)},s.appendChild(e),s.appendChild(n),s.appendChild(r),s.appendChild(h),this.container.appendChild(s),t.appendChild(this.container);try{const t=await i.getMonthlyRanking();n.remove(),t&&t.length>0?t.forEach((t,s)=>{const i=document.createElement("div");i.textContent=`${s+1}. ${t.nickname} - ${t.score}m`,i.style.cssText="\n                        padding: 10px;\n                        border-bottom: 1px solid rgba(255, 255, 255, 0.2);\n                    ",r.appendChild(i)}):r.textContent="  ."}catch(t){n.textContent="   .",console.error("Ranking load error:",t)}}destroy(){this.container.parentNode&&this.container.parentNode.removeChild(this.container)}}class ss{constructor(t){this.rankingData=null,this.gameManager=t,this.container=document.createElement("div")}async init(){const t=this.gameManager.getUILayer(),s=this.gameManager.getGameData();this.container.style.cssText="\n            width: 100%;\n            height: 100%;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            background: rgba(0, 0, 0, 0.9);\n            color: white;\n            padding: 40px;\n            overflow-y: auto;\n        ";const e=document.createElement("div");e.style.cssText="\n            width: 100%;\n            max-width: 600px;\n            text-align: center;\n        ";const n=document.createElement("h1");n.textContent=" ",n.style.cssText="\n            font-size: 32px;\n            margin-bottom: 20px;\n        ";const r=document.createElement("div");r.textContent=` : ${s.score}m`,r.style.cssText="\n            font-size: 24px;\n            margin-bottom: 30px;\n            color: #ffd700;\n        ";const h=document.createElement("div");h.textContent="  ...",h.style.cssText="font-size: 18px; margin-bottom: 20px;";const o=document.createElement("div");o.id="ranking-list",o.style.cssText="\n            text-align: left;\n            font-size: 18px;\n            line-height: 2;\n            margin-bottom: 30px;\n            max-height: 400px;\n            overflow-y: auto;\n        ";const a=document.createElement("div");a.id="my-rank",a.style.cssText="\n            font-size: 20px;\n            font-weight: bold;\n            color: #4CAF50;\n            margin-bottom: 30px;\n            padding: 15px;\n            background: rgba(76, 175, 80, 0.2);\n            border-radius: 10px;\n        ";const c=document.createElement("div");c.style.cssText="\n            display: flex;\n            flex-direction: column;\n            gap: 15px;\n        ";const l=document.createElement("button");l.textContent="  ",l.style.cssText="\n            width: 100%;\n            height: 60px;\n            font-size: 20px;\n            background: #ff6b6b;\n        ",l.onclick=()=>{this.gameManager.showScreen(Nt.SHARE)};const u=document.createElement("button");u.textContent="",u.style.cssText="\n            width: 100%;\n            height: 60px;\n            font-size: 20px;\n        ",u.onclick=()=>{this.gameManager.showScreen(Nt.GAME)},c.appendChild(l),c.appendChild(u),e.appendChild(n),e.appendChild(r),e.appendChild(h),e.appendChild(o),e.appendChild(a),e.appendChild(c),this.container.appendChild(e),t.appendChild(this.container);try{this.rankingData=await i.getResultRanking(s.score),h.remove(),this.rankingData.topRankings&&this.rankingData.topRankings.length>0&&this.rankingData.topRankings.slice(0,7).forEach((t,s)=>{const i=document.createElement("div");i.textContent=`${s+1}. ${t.nickname} - ${t.score}m`,i.style.cssText="\n                        padding: 10px;\n                        border-bottom: 1px solid rgba(255, 255, 255, 0.2);\n                    ",o.appendChild(i)}),this.rankingData.myRank&&(a.textContent=` : ${this.rankingData.myRank.rank} (${this.rankingData.myRank.score}m)`)}catch(t){h.textContent="   .",console.error("Result ranking load error:",t)}}destroy(){this.container.parentNode&&this.container.parentNode.removeChild(this.container)}}class is{constructor(t){this.gameManager=t,this.container=document.createElement("div")}init(){const t=this.gameManager.getUILayer(),s=this.gameManager.getGameData();this.container.style.cssText="\n            width: 100%;\n            height: 100%;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            background: rgba(0, 0, 0, 0.9);\n            color: white;\n            padding: 40px;\n            overflow-y: auto;\n        ";const i=document.createElement("div");i.style.cssText="\n            width: 100%;\n            max-width: 600px;\n            text-align: center;\n        ";const e=document.createElement("div");e.id="share-image",e.style.cssText="\n            width: 100%;\n            max-width: 500px;\n            height: 400px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            border-radius: 20px;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            margin: 0 auto 30px;\n            position: relative;\n            overflow: hidden;\n        ";const n=document.createElement("img"),r=s.characterId+1;n.src=`images/${r}L.png`,n.style.cssText="\n            width: 150px;\n            height: 150px;\n            object-fit: contain;\n            margin-bottom: 20px;\n        ",n.alt=` ${r}`,e.appendChild(n);const h=document.createElement("div");h.style.cssText="\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            gap: 15px;\n        ",h.innerHTML=`\n            <div style="font-size: 32px; font-weight: bold; color: white;">${s.nickname}</div>\n            <div style="font-size: 48px; font-weight: bold; color: #ffd700;">${s.score}m</div>\n        `,e.appendChild(h);const o=document.createElement("div");o.textContent="#MR-PET #",o.style.cssText="\n            font-size: 20px;\n            margin-bottom: 30px;\n            color: #4CAF50;\n        ";const a=document.createElement("div");a.style.cssText="\n            display: flex;\n            flex-direction: column;\n            gap: 15px;\n        ";const c=document.createElement("button");c.textContent=" ",c.style.cssText="\n            width: 100%;\n            height: 60px;\n            font-size: 20px;\n        ",c.onclick=()=>{this.downloadImage()};const l=document.createElement("button");l.textContent=" ",l.style.cssText="\n            width: 100%;\n            height: 60px;\n            font-size: 20px;\n        ",l.onclick=()=>{this.copyHashtag()};const u=document.createElement("button");u.textContent="  ",u.style.cssText="\n            width: 100%;\n            height: 60px;\n            font-size: 20px;\n            background: #ff6b6b;\n        ",u.onclick=()=>{this.gameManager.showScreen(Nt.INFO_INPUT)},a.appendChild(c),a.appendChild(l),a.appendChild(u),i.appendChild(e),i.appendChild(o),i.appendChild(a),this.container.appendChild(i),t.appendChild(this.container)}async downloadImage(){if(!document.getElementById("share-image"))return;const t=this.gameManager.getGameData(),s=document.createElement("canvas");s.width=500,s.height=400;const i=s.getContext("2d");if(!i)return;const e=i.createLinearGradient(0,0,500,400);e.addColorStop(0,"#667eea"),e.addColorStop(1,"#764ba2"),i.fillStyle=e,i.fillRect(0,0,500,400);try{const s=t.characterId+1,e=new Image;e.crossOrigin="anonymous",await new Promise((t,i)=>{e.onload=t,e.onerror=i,e.src=`images/${s}L.png`});const n=150;i.drawImage(e,250-n/2,80,n,n)}catch(s){console.warn("Failed to load character image:",s),i.fillStyle="white",i.font="24px Arial",i.textAlign="center",i.fillText(` ${t.characterId+1}`,250,155)}i.fillStyle="white",i.font="bold 32px Arial",i.textAlign="center",i.fillText(t.nickname,250,280),i.fillStyle="#ffd700",i.font="bold 48px Arial",i.fillText(`${t.score}m`,250,340),s.toBlob(s=>{if(!s)return;const i=URL.createObjectURL(s),e=document.createElement("a");e.href=i,e.download=`jump_game_${t.score}m.png`,e.click(),URL.revokeObjectURL(i)})}copyHashtag(){const t="#MR-PET #";navigator.clipboard.writeText(t).then(()=>{alert(" !")}).catch(()=>{const s=document.createElement("textarea");s.value=t,document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s),alert(" !")})}destroy(){this.container.parentNode&&this.container.parentNode.removeChild(this.container)}}class es{constructor(t){this.gameManager=t,this.container=document.createElement("div")}init(){const t=this.gameManager.getUILayer();this.container.style.cssText="\n            width: 100%;\n            height: 100%;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            background: rgba(0, 0, 0, 0.9);\n            color: white;\n            padding: 40px;\n            overflow-y: auto;\n        ";const s=document.createElement("div");s.style.cssText="\n            width: 100%;\n            max-width: 600px;\n        ";const e=document.createElement("h1");e.textContent=" ",e.style.cssText="\n            font-size: 32px;\n            margin-bottom: 30px;\n            text-align: center;\n        ";const n=document.createElement("label");n.textContent=" ",n.style.cssText="display: block; margin-bottom: 5px; font-size: 18px;";const r=document.createElement("input");r.type="text",r.required=!0,r.style.cssText="\n            width: 100%;\n            height: 50px;\n            font-size: 18px;\n            padding: 0 15px;\n            border-radius: 5px;\n            margin-bottom: 20px;\n        ";const h=document.createElement("label");h.textContent="",h.style.cssText="display: block; margin-bottom: 5px; font-size: 18px;";const o=document.createElement("input");o.type="tel",o.required=!0,o.style.cssText="\n            width: 100%;\n            height: 50px;\n            font-size: 18px;\n            padding: 0 15px;\n            border-radius: 5px;\n            margin-bottom: 20px;\n        ";const a=document.createElement("label");a.textContent="",a.style.cssText="display: block; margin-bottom: 5px; font-size: 18px;";const c=document.createElement("input");c.type="text",c.required=!0,c.style.cssText="\n            width: 100%;\n            height: 50px;\n            font-size: 18px;\n            padding: 0 15px;\n            border-radius: 5px;\n            margin-bottom: 20px;\n        ";const l=document.createElement("label");l.textContent="",l.style.cssText="display: block; margin-bottom: 5px; font-size: 18px;";const u=document.createElement("input");u.type="text",u.required=!0,u.style.cssText="\n            width: 100%;\n            height: 50px;\n            font-size: 18px;\n            padding: 0 15px;\n            border-radius: 5px;\n            margin-bottom: 20px;\n        ";const d=document.createElement("div");d.style.cssText="\n            display: flex;\n            align-items: center;\n            margin-bottom: 30px;\n        ",this.agreeCheckbox=document.createElement("input"),this.agreeCheckbox.type="checkbox",this.agreeCheckbox.id="agree-checkbox",this.agreeCheckbox.style.cssText="\n            width: 24px;\n            height: 24px;\n            margin-right: 10px;\n        ";const f=document.createElement("label");f.htmlFor="agree-checkbox",f.textContent="  .",f.style.cssText="font-size: 18px; cursor: pointer;",d.appendChild(this.agreeCheckbox),d.appendChild(f);const p=document.createElement("button");p.textContent="",p.style.cssText="\n            width: 100%;\n            height: 60px;\n            font-size: 24px;\n            background: #4CAF50;\n        ",p.onclick=async()=>{if(!this.agreeCheckbox.checked)return void alert("  .");const t=this.gameManager.getGameData(),s={name:r.value.trim(),phone:o.value.trim(),address:c.value.trim(),detailAddress:u.value.trim(),score:t.score,gameKey:t.gameKey,startTime:t.startTime};if(s.name&&s.phone&&s.address&&s.detailAddress){p.disabled=!0,p.textContent=" ...";try{await i.submitEventInfo(s)?(alert(" !"),this.gameManager.showScreen(Nt.START)):(alert(" .  ."),p.disabled=!1,p.textContent="")}catch(t){console.error("Submit error:",t),alert("   ."),p.disabled=!1,p.textContent=""}}else alert("  .")},s.appendChild(e),s.appendChild(n),s.appendChild(r),s.appendChild(h),s.appendChild(o),s.appendChild(a),s.appendChild(c),s.appendChild(l),s.appendChild(u),s.appendChild(d),s.appendChild(p),this.container.appendChild(s),t.appendChild(this.container)}destroy(){this.container.parentNode&&this.container.parentNode.removeChild(this.container)}}class ns{constructor(t){this.gameManager=t,this.container=document.createElement("div")}init(){const t=this.gameManager.getUILayer();this.container.style.cssText="\n            width: 100%;\n            height: 100%;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            background: rgba(0, 0, 0, 0.9);\n            color: white;\n            padding: 40px;\n        ";const s=document.createElement("div");s.style.cssText="\n            max-width: 600px;\n            text-align: center;\n        ";const i=document.createElement("h1");i.textContent=" ",i.style.cssText="\n            font-size: 32px;\n            margin-bottom: 30px;\n        ";const e=document.createElement("div");e.innerHTML='\n            <p style="font-size: 20px; line-height: 1.6; margin-bottom: 20px;">\n                      .<br>\n                     ,     .<br>\n                    !<br>\n                    !\n            </p>\n            <div style="margin-top: 30px; padding: 20px; background: rgba(255, 255, 255, 0.1); border-radius: 10px;">\n                <h2 style="font-size: 24px; margin-bottom: 15px;"> </h2>\n                <p style="font-size: 18px; line-height: 1.8; text-align: left;">\n                    <strong>1  ( ):</strong>  -  -3<br>\n                    <strong>2  ( ):</strong>  -  3 <br>\n                    <strong>3  ( ):</strong>  -  +10\n                </p>\n            </div>\n        ';const n=document.createElement("button");n.textContent="",n.style.cssText="\n            width: 200px;\n            height: 60px;\n            font-size: 24px;\n            margin-top: 30px;\n        ",n.onclick=()=>{this.gameManager.showScreen(Nt.START)},s.appendChild(i),s.appendChild(e),s.appendChild(n),this.container.appendChild(s),t.appendChild(this.container)}destroy(){this.container.parentNode&&this.container.parentNode.removeChild(this.container)}}!function(t){t.START="start",t.HELP="help",t.RANKING="ranking",t.CHARACTER_SELECT="character_select",t.INTRO="intro",t.GAME="game",t.RESULT="result",t.SHARE="share",t.INFO_INPUT="info_input"}(Nt||(Nt={}));class rs{constructor(){this.currentScreen=null,this.gameData={nickname:"",characterId:0,score:0,gameKey:"",startTime:0},console.log("[GameManager] Constructor called"),this.uiLayer=document.getElementById("ui-layer"),this.uiLayer?console.log("[GameManager] ui-layer found"):console.error("[GameManager] ui-layer element not found!")}init(){console.log("[GameManager] init() called"),this.showScreen(Nt.START)}showScreen(i){switch(console.log(`[GameManager] showScreen called: ${i}`),this.currentScreen&&(console.log("[GameManager] Destroying current screen"),this.currentScreen.destroy()),this.uiLayer.innerHTML="",i){case Nt.START:this.currentScreen=new t(this);break;case Nt.HELP:this.currentScreen=new ns(this);break;case Nt.RANKING:this.currentScreen=new ts(this);break;case Nt.CHARACTER_SELECT:this.currentScreen=new s(this);break;case Nt.INTRO:console.log("[GameManager] Creating IntroScreen"),this.currentScreen=new Yt(this);break;case Nt.GAME:console.log("[GameManager] Creating GameScreen"),this.currentScreen=new Jt(this);break;case Nt.RESULT:this.currentScreen=new ss(this);break;case Nt.SHARE:this.currentScreen=new is(this);break;case Nt.INFO_INPUT:this.currentScreen=new es(this)}this.currentScreen?(console.log(`[GameManager] Calling init() on ${i}`),this.currentScreen.init()):console.error(`[GameManager] Failed to create screen: ${i}`)}getGameData(){return this.gameData}setGameData(t){this.gameData={...this.gameData,...t}}getUILayer(){return this.uiLayer}}console.log("=== GAME STARTING ==="),console.log("Main.ts loaded");try{console.log("Creating GameManager...");const t=new rs;console.log("GameManager created, calling init()..."),t.init(),console.log("GameManager.init() completed")}catch(t){console.error("Error initializing game:",t)}})()})();