"use strict";(self.webpackChunkjump_game=self.webpackChunkjump_game||[]).push([[397],{8397:(t,i,s)=>{var e=s(8507),n=s(7457),h=s(4458),o=s(7309);class r{constructor(t){this.t="",this.i=null,this.h=!1,this.updateTranslation=()=>{if(!this.o)return;const t=this.o.getBoundingClientRect(),i=this.o.width,s=this.o.height,e=t.width/i*this.l.resolution,n=t.height/s*this.l.resolution,h=`translate(${t.left}px, ${t.top}px) scale(${e}, ${n})`;h!==this.t&&(this.u.style.transform=h,this.t=h)},this.u=t.domElement,this.l=t.renderer,globalThis.OffscreenCanvas&&this.l.canvas instanceof OffscreenCanvas||(this.o=this.l.canvas,this.p())}get canvas(){return this.o}ensureAttached(){!this.u.parentNode&&this.o.parentNode&&(this.o.parentNode.appendChild(this.u),this.updateTranslation())}p(){"ResizeObserver"in globalThis?(this.i&&(this.i.disconnect(),this.i=null),this.i=new ResizeObserver(t=>{for(const i of t){if(i.target!==this.o)continue;const t=this.canvas.width,s=this.canvas.height,e=i.contentRect.width/t*this.l.resolution,n=i.contentRect.height/s*this.l.resolution;(this.v!==e||this.m!==n)&&(this.updateTranslation(),this.v=e,this.m=n)}}),this.i.observe(this.o)):this.h||o.R.shared.add(this.updateTranslation,this,h.d.HIGH)}destroy(){this.i?(this.i.disconnect(),this.i=null):this.h&&o.R.shared.remove(this.updateTranslation),this.u=null,this.l=null,this.o=null,this.h=!1,this.t="",this.v=null,this.m=null}}var l=s(5101);class u{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=u.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new l.b,this.page=new l.b,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,i,s){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,i,s,e,n){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}var a=/iPhone/i,c=/iPod/i,p=/iPad/i,v=/\biOS-universal(?:.+)Mac\b/i,d=/\bAndroid(?:.+)Mobile\b/i,f=/Android/i,m=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,b=/Silk/i,g=/Windows Phone/i,y=/\bWindows(?:.+)ARM\b/i,w=/BlackBerry/i,E=/BB10/i,T=/Opera Mini/i,P=/\b(CriOS|Chrome)(?:.+)Mobile/i,M=/Mobile(?:.+)Firefox\b/i,x=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};function _(t){var i={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?i.userAgent=t:t&&t.userAgent&&(i={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):i={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var s=i.userAgent,e=s.split("[FBAN");void 0!==e[1]&&(s=e[0]),void 0!==(e=s.split("Twitter"))[1]&&(s=e[0]);var n=function(t){return function(i){return i.test(t)}}(s),h={apple:{phone:n(a)&&!n(g),ipod:n(c),tablet:!n(a)&&(n(p)||x(i))&&!n(g),universal:n(v),device:(n(a)||n(c)||n(p)||n(v)||x(i))&&!n(g)},amazon:{phone:n(m),tablet:!n(m)&&n(b),device:n(m)||n(b)},android:{phone:!n(g)&&n(m)||!n(g)&&n(d),tablet:!n(g)&&!n(m)&&!n(d)&&(n(b)||n(f)),device:!n(g)&&(n(m)||n(b)||n(d)||n(f))||n(/\bokhttp\b/i)},windows:{phone:n(g),tablet:n(y),device:n(g)||n(y)},other:{blackberry:n(w),blackberry10:n(E),opera:n(T),firefox:n(M),chrome:n(P),device:n(w)||n(E)||n(T)||n(M)||n(P)},any:!1,phone:!1,tablet:!1};return h.any=h.apple.device||h.android.device||h.windows.device||h.other.device,h.phone=h.apple.phone||h.android.phone||h.windows.phone,h.tablet=h.apple.tablet||h.android.tablet||h.windows.tablet,h}const k=(_.default??_)(globalThis.navigator);var $=s(9903);const O=class t{constructor(t,i=k){this.T=i,this.debug=!1,this.P=!0,this.M=!0,this._=!1,this.k=!1,this.$=null,this.O={},this.B=0,this.D=[],this.I=0,this.C=500,this.S=!1,this.F=this.j.bind(this),this.U=this.X.bind(this),this.Y=null,(i.tablet||i.phone)&&this.L(),this.l=t}get isActive(){return this._}get isMobileAccessibility(){return this.k}get hookDiv(){return this.Y}get div(){return this.$}L(){const t=document.createElement("button");t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.zIndex=2..toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this.k=!0,this.W(),this.H()}),document.body.appendChild(t),this.Y=t}H(){this.Y&&(document.body.removeChild(this.Y),this.Y=null)}W(){if(this._)return;this._=!0,this.$||(this.$=document.createElement("div"),this.$.style.position="absolute",this.$.style.top="0px",this.$.style.left="0px",this.$.style.pointerEvents="none",this.$.style.zIndex=2..toString(),this.G=new r({domElement:this.$,renderer:this.l})),this.P&&globalThis.addEventListener("keydown",this.F,!1),this.M&&globalThis.document.addEventListener("mousemove",this.U,!0);const t=this.l.view.canvas;if(t.parentNode)this.G.ensureAttached(),this.K();else{const i=new MutationObserver(()=>{t.parentNode&&(i.disconnect(),this.G.ensureAttached(),this.K())});i.observe(document.body,{childList:!0,subtree:!0})}}K(){this.l.runners.postrender.add(this),this.l.lastObjectRendered&&this.N(this.l.lastObjectRendered)}q(){if(this._&&!this.k){this._=!1,globalThis.document.removeEventListener("mousemove",this.U,!0),this.P&&globalThis.addEventListener("keydown",this.F,!1),this.l.runners.postrender.remove(this);for(const t of this.D)t.J?.parentNode&&(t.J.parentNode.removeChild(t.J),t.J=null),t.V=!1;for(const t in this.O)this.O[t].forEach(t=>{t.parentNode&&t.parentNode.removeChild(t)}),delete this.O[t];this.$?.parentNode&&this.$.parentNode.removeChild(this.$),this.O={},this.D=[]}}N(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&(t.V||this.Z(t),t.B=this.B);const i=t.children;if(i)for(let t=0;t<i.length;t++)this.N(i[t])}init(i){const s={accessibilityOptions:{...t.defaultOptions,...i?.accessibilityOptions||{}}};this.debug=s.accessibilityOptions.debug,this.P=s.accessibilityOptions.activateOnTab,this.M=s.accessibilityOptions.deactivateOnMouseMove,s.accessibilityOptions.enabledByDefault&&this.W(),this.l.runners.postrender.remove(this)}postrender(){const t=performance.now();if(this.T.android.device&&t<this.I)return;if(this.I=t+this.C,!(this.l.renderingToScreen&&this.l.view.canvas||this.S))return;const i=new Set;if(this.l.lastObjectRendered){this.N(this.l.lastObjectRendered);for(const t of this.D)t.B===this.B&&i.add(this.D.indexOf(t))}for(let t=this.D.length-1;t>=0;t--){const s=this.D[t];i.has(t)||(s.J&&s.J.parentNode&&(s.J.parentNode.removeChild(s.J),this.tt(s.accessibleType).push(s.J),s.J=null),s.V=!1,(0,$.d)(this.D,t,1))}this.l.renderingToScreen&&this.G.ensureAttached();for(let t=0;t<this.D.length;t++){const i=this.D[t];if(!i.V||!i.J)continue;const s=i.J,e=i.hitArea||i.getBounds().rectangle;if(i.hitArea){const t=i.worldTransform;s.style.left=`${t.tx+e.x*t.a}px`,s.style.top=`${t.ty+e.y*t.d}px`,s.style.width=e.width*t.a+"px",s.style.height=e.height*t.d+"px"}else this.it(e),s.style.left=`${e.x}px`,s.style.top=`${e.y}px`,s.style.width=`${e.width}px`,s.style.height=`${e.height}px`}this.B++}st(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}it(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:i,height:s}=this.l;t.x+t.width>i&&(t.width=i-t.x),t.y+t.height>s&&(t.height=s-t.y)}Z(t){let i=this.tt(t.accessibleType).pop();i?(i.innerHTML="",i.removeAttribute("title"),i.removeAttribute("aria-label"),i.tabIndex=0):("button"===t.accessibleType?i=document.createElement("button"):(i=document.createElement(t.accessibleType),i.style.cssText="\n                        color: transparent;\n                        pointer-events: none;\n                        padding: 0;\n                        margin: 0;\n                        border: 0;\n                        outline: 0;\n                        background: transparent;\n                        box-sizing: border-box;\n                        user-select: none;\n                        -webkit-user-select: none;\n                        -moz-user-select: none;\n                        -ms-user-select: none;\n                    ",t.accessibleText&&(i.innerText=t.accessibleText)),i.style.width="100px",i.style.height="100px",i.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",i.style.position="absolute",i.style.zIndex=2..toString(),i.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?i.setAttribute("aria-live","off"):i.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?i.setAttribute("aria-relevant","additions"):i.setAttribute("aria-relevant","text"),i.addEventListener("click",this.et.bind(this)),i.addEventListener("focus",this.nt.bind(this)),i.addEventListener("focusout",this.ht.bind(this))),i.style.pointerEvents=t.accessiblePointerEvents,i.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?i.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(i.title=`container ${t.tabIndex}`),t.accessibleHint&&null!==t.accessibleHint&&i.setAttribute("aria-label",t.accessibleHint),t.interactive?i.tabIndex=t.tabIndex:i.tabIndex=0,this.debug&&this.st(i),t.V=!0,t.J=i,i.container=t,this.D.push(t),this.$.appendChild(t.J)}ot(t,i){const{container:s}=t.target,e=this.l.events.rootBoundary,n=Object.assign(new u(e),{target:s});e.rootTarget=this.l.lastObjectRendered,i.forEach(t=>e.dispatchEvent(n,t))}et(t){this.ot(t,["click","pointertap","tap"])}nt(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this.ot(t,["mouseover"])}ht(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this.ot(t,["mouseout"])}j(t){9===t.keyCode&&this.P&&this.W()}X(t){0===t.movementX&&0===t.movementY||this.q()}destroy(){this.q(),this.H(),this.G?.destroy(),this.G=null,this.$=null,this.O=null,this.D=null,this.l=null,this.Y=null,globalThis.removeEventListener("keydown",this.F),this.F=null,globalThis.document.removeEventListener("mousemove",this.U,!0),this.U=null}setAccessibilityEnabled(t){t?this.W():this.q()}tt(t){return this.O[t]||(this.O[t]=[]),this.O[t]}};O.extension={type:[e.Ag.WebGLSystem,e.Ag.WebGPUSystem],name:"accessibility"},O.defaultOptions={enabledByDefault:!1,debug:!1,activateOnTab:!0,deactivateOnMouseMove:!0};let A=O;e.XO.add(A),e.XO.mixin(n.mc,{accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,accessibleType:"button",accessibleText:null,accessiblePointerEvents:"auto",accessibleChildren:!0,V:!1,J:null,B:-1}),s(4732);var B=s(4486),D=s(268);const I=new class{constructor(){this.interactionFrequency=10,this.rt=0,this.lt=!1,this.ut=!1,this.ct=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this.rt=0,this.lt=!1,this.ut=!1,this.ct=!0}get pauseUpdate(){return this.ct}set pauseUpdate(t){this.ct=t}addTickerListener(){!this.ut&&this.domElement&&(o.R.system.add(this.vt,this,h.d.INTERACTION),this.ut=!0)}removeTickerListener(){this.ut&&(o.R.system.remove(this.vt,this),this.ut=!1)}pointerMoved(){this.lt=!0}dt(){if(!this.domElement||this.ct)return;if(this.lt)return void(this.lt=!1);const t=this.events.ft;this.events.supportsTouchEvents&&"touch"===t.pointerType||globalThis.document.dispatchEvent(this.events.supportsPointerEvents?new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY,pointerType:t.pointerType,pointerId:t.pointerId}):new MouseEvent("mousemove",{clientX:t.clientX,clientY:t.clientY}))}vt(t){this.rt+=t.deltaTime,this.rt<this.interactionFrequency||(this.rt=0,this.dt())}destroy(){this.removeTickerListener(),this.events=null,this.domElement=null,this.rt=0,this.lt=!1,this.ut=!1,this.ct=!0}};class C extends u{constructor(){super(...arguments),this.client=new l.b,this.movement=new l.b,this.offset=new l.b,this.global=new l.b,this.screen=new l.b}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,i,s){return t.worldTransform.applyInverse(s||this.global,i)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,i,s,e,n,h,o,r,l,u,a,c,p,v,d){throw new Error("Method not implemented.")}}class S extends C{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class F extends C{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}F.DOM_DELTA_PIXEL=0,F.DOM_DELTA_LINE=1,F.DOM_DELTA_PAGE=2;const j=new l.b,R=new l.b;class U{constructor(t){this.dispatch=new B.A,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this.bt=[],this.gt=[],this.yt=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,i){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:i,priority:0}),this.mappingTable[t].sort((t,i)=>t.priority-i.priority)}dispatchEvent(t,i){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,i),this.dispatch.emit(i||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const i=this.mappingTable[t.type];if(i)for(let s=0,e=i.length;s<e;s++)i[s].fn(t);else(0,D.R)(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,i){I.pauseUpdate=!0;const s=this[this.yt&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive"](this.rootTarget,this.rootTarget.eventMode,j.set(t,i),this.hitTestFn,this.hitPruneFn);return s&&s[0]}propagate(t,i){if(!t.target)return;const s=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let e=0,n=s.length-1;e<n;e++)if(t.currentTarget=s[e],this.notifyTarget(t,i),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,i),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(let e=s.length-2;e>=0;e--)if(t.currentTarget=s[e],this.notifyTarget(t,i),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,i,s=this.bt){if(0===s.length)return;t.eventPhase=t.BUBBLING_PHASE;const e=Array.isArray(i)?i:[i];for(let i=s.length-1;i>=0;i--)e.forEach(e=>{t.currentTarget=s[i],this.notifyTarget(t,e)})}propagationPath(t){const i=[t];for(let s=0;s<2048&&t!==this.rootTarget&&t.parent;s++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");i.push(t.parent),t=t.parent}return i.reverse(),i}hitTestMoveRecursive(t,i,s,e,n,h=!1){let o=!1;if(this.wt(t))return null;if("dynamic"!==t.eventMode&&"dynamic"!==i||(I.pauseUpdate=!1),t.interactiveChildren&&t.children){const r=t.children;for(let l=r.length-1;l>=0;l--){const u=r[l],a=this.hitTestMoveRecursive(u,this.Et(i)?i:u.eventMode,s,e,n,h||n(t,s));if(a){if(a.length>0&&!a[a.length-1].parent)continue;const i=t.isInteractive();(a.length>0||i)&&(i&&this.bt.push(t),a.push(t)),0===this.gt.length&&(this.gt=a),o=!0}}}const r=this.Et(i),l=t.isInteractive();return l&&l&&this.bt.push(t),h||this.gt.length>0?null:o?this.gt:r&&!n(t,s)&&e(t,s)?l?[t]:[]:null}hitTestRecursive(t,i,s,e,n){if(this.wt(t)||n(t,s))return null;if("dynamic"!==t.eventMode&&"dynamic"!==i||(I.pauseUpdate=!1),t.interactiveChildren&&t.children){const h=t.children,o=s;for(let s=h.length-1;s>=0;s--){const r=h[s],l=this.hitTestRecursive(r,this.Et(i)?i:r.eventMode,o,e,n);if(l){if(l.length>0&&!l[l.length-1].parent)continue;const i=t.isInteractive();return(l.length>0||i)&&l.push(t),l}}}const h=this.Et(i),o=t.isInteractive();return h&&e(t,s)?o?[t]:[]:null}Et(t){return"static"===t||"dynamic"===t}wt(t){return!(t&&t.visible&&t.renderable&&t.measurable)||"none"===t.eventMode||"passive"===t.eventMode&&!t.interactiveChildren}hitPruneFn(t,i){if(t.hitArea&&(t.worldTransform.applyInverse(i,R),!t.hitArea.contains(R.x,R.y)))return!0;if(t.effects&&t.effects.length)for(let s=0;s<t.effects.length;s++){const e=t.effects[s];if(e.containsPoint&&!e.containsPoint(i,this.hitTestFn))return!0}return!1}hitTestFn(t,i){return!!t.hitArea||!!t?.containsPoint&&(t.worldTransform.applyInverse(i,R),t.containsPoint(R))}notifyTarget(t,i){if(!t.currentTarget.isInteractive())return;i??(i=t.type);const s=`on${i}`;t.currentTarget[s]?.(t);const e=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${i}capture`:i;this.Tt(t,e),t.eventPhase===t.AT_TARGET&&this.Tt(t,i)}mapPointerDown(t){if(!(t instanceof S))return void(0,D.R)("EventBoundary cannot map a non-pointer event as a pointer event");const i=this.createPointerEvent(t);if(this.dispatchEvent(i,"pointerdown"),"touch"===i.pointerType)this.dispatchEvent(i,"touchstart");else if("mouse"===i.pointerType||"pen"===i.pointerType){const t=2===i.button;this.dispatchEvent(i,t?"rightdown":"mousedown")}this.trackingData(t.pointerId).pressTargetsByButton[t.button]=i.composedPath(),this.freeEvent(i)}mapPointerMove(t){if(!(t instanceof S))return void(0,D.R)("EventBoundary cannot map a non-pointer event as a pointer event");this.bt.length=0,this.gt.length=0,this.yt=!0;const i=this.createPointerEvent(t);this.yt=!1;const s="mouse"===i.pointerType||"pen"===i.pointerType,e=this.trackingData(t.pointerId),n=this.findMountedTarget(e.overTargets);if(e.overTargets?.length>0&&n!==i.target){const e="mousemove"===t.type?"mouseout":"pointerout",h=this.createPointerEvent(t,e,n);if(this.dispatchEvent(h,"pointerout"),s&&this.dispatchEvent(h,"mouseout"),!i.composedPath().includes(n)){const e=this.createPointerEvent(t,"pointerleave",n);for(e.eventPhase=e.AT_TARGET;e.target&&!i.composedPath().includes(e.target);)e.currentTarget=e.target,this.notifyTarget(e),s&&this.notifyTarget(e,"mouseleave"),e.target=e.target.parent;this.freeEvent(e)}this.freeEvent(h)}if(n!==i.target){const e="mousemove"===t.type?"mouseover":"pointerover",h=this.clonePointerEvent(i,e);this.dispatchEvent(h,"pointerover"),s&&this.dispatchEvent(h,"mouseover");let o=n?.parent;for(;o&&o!==this.rootTarget.parent&&o!==i.target;)o=o.parent;if(!o||o===this.rootTarget.parent){const t=this.clonePointerEvent(i,"pointerenter");for(t.eventPhase=t.AT_TARGET;t.target&&t.target!==n&&t.target!==this.rootTarget.parent;)t.currentTarget=t.target,this.notifyTarget(t),s&&this.notifyTarget(t,"mouseenter"),t.target=t.target.parent;this.freeEvent(t)}this.freeEvent(h)}const h=[],o=this.enableGlobalMoveEvents??!0;this.moveOnAll?h.push("pointermove"):this.dispatchEvent(i,"pointermove"),o&&h.push("globalpointermove"),"touch"===i.pointerType&&(this.moveOnAll?h.splice(1,0,"touchmove"):this.dispatchEvent(i,"touchmove"),o&&h.push("globaltouchmove")),s&&(this.moveOnAll?h.splice(1,0,"mousemove"):this.dispatchEvent(i,"mousemove"),o&&h.push("globalmousemove"),this.cursor=i.target?.cursor),h.length>0&&this.all(i,h),this.bt.length=0,this.gt.length=0,e.overTargets=i.composedPath(),this.freeEvent(i)}mapPointerOver(t){if(!(t instanceof S))return void(0,D.R)("EventBoundary cannot map a non-pointer event as a pointer event");const i=this.trackingData(t.pointerId),s=this.createPointerEvent(t),e="mouse"===s.pointerType||"pen"===s.pointerType;this.dispatchEvent(s,"pointerover"),e&&this.dispatchEvent(s,"mouseover"),"mouse"===s.pointerType&&(this.cursor=s.target?.cursor);const n=this.clonePointerEvent(s,"pointerenter");for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),e&&this.notifyTarget(n,"mouseenter"),n.target=n.target.parent;i.overTargets=s.composedPath(),this.freeEvent(s),this.freeEvent(n)}mapPointerOut(t){if(!(t instanceof S))return void(0,D.R)("EventBoundary cannot map a non-pointer event as a pointer event");const i=this.trackingData(t.pointerId);if(i.overTargets){const s="mouse"===t.pointerType||"pen"===t.pointerType,e=this.findMountedTarget(i.overTargets),n=this.createPointerEvent(t,"pointerout",e);this.dispatchEvent(n),s&&this.dispatchEvent(n,"mouseout");const h=this.createPointerEvent(t,"pointerleave",e);for(h.eventPhase=h.AT_TARGET;h.target&&h.target!==this.rootTarget.parent;)h.currentTarget=h.target,this.notifyTarget(h),s&&this.notifyTarget(h,"mouseleave"),h.target=h.target.parent;i.overTargets=null,this.freeEvent(n),this.freeEvent(h)}this.cursor=null}mapPointerUp(t){if(!(t instanceof S))return void(0,D.R)("EventBoundary cannot map a non-pointer event as a pointer event");const i=performance.now(),s=this.createPointerEvent(t);if(this.dispatchEvent(s,"pointerup"),"touch"===s.pointerType)this.dispatchEvent(s,"touchend");else if("mouse"===s.pointerType||"pen"===s.pointerType){const t=2===s.button;this.dispatchEvent(s,t?"rightup":"mouseup")}const e=this.trackingData(t.pointerId),n=this.findMountedTarget(e.pressTargetsByButton[t.button]);let h=n;if(n&&!s.composedPath().includes(n)){let i=n;for(;i&&!s.composedPath().includes(i);){if(s.currentTarget=i,this.notifyTarget(s,"pointerupoutside"),"touch"===s.pointerType)this.notifyTarget(s,"touchendoutside");else if("mouse"===s.pointerType||"pen"===s.pointerType){const t=2===s.button;this.notifyTarget(s,t?"rightupoutside":"mouseupoutside")}i=i.parent}delete e.pressTargetsByButton[t.button],h=i}if(h){const n=this.clonePointerEvent(s,"click");n.target=h,n.path=null,e.clicksByButton[t.button]||(e.clicksByButton[t.button]={clickCount:0,target:n.target,timeStamp:i});const o=e.clicksByButton[t.button];if(o.target===n.target&&i-o.timeStamp<200?++o.clickCount:o.clickCount=1,o.target=n.target,o.timeStamp=i,n.detail=o.clickCount,"mouse"===n.pointerType){const t=2===n.button;this.dispatchEvent(n,t?"rightclick":"click")}else"touch"===n.pointerType&&this.dispatchEvent(n,"tap");this.dispatchEvent(n,"pointertap"),this.freeEvent(n)}this.freeEvent(s)}mapPointerUpOutside(t){if(!(t instanceof S))return void(0,D.R)("EventBoundary cannot map a non-pointer event as a pointer event");const i=this.trackingData(t.pointerId),s=this.findMountedTarget(i.pressTargetsByButton[t.button]),e=this.createPointerEvent(t);if(s){let n=s;for(;n;)e.currentTarget=n,this.notifyTarget(e,"pointerupoutside"),"touch"===e.pointerType?this.notifyTarget(e,"touchendoutside"):"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.notifyTarget(e,2===e.button?"rightupoutside":"mouseupoutside"),n=n.parent;delete i.pressTargetsByButton[t.button]}this.freeEvent(e)}mapWheel(t){if(!(t instanceof F))return void(0,D.R)("EventBoundary cannot map a non-wheel event as a wheel event");const i=this.createWheelEvent(t);this.dispatchEvent(i),this.freeEvent(i)}findMountedTarget(t){if(!t)return null;let i=t[0];for(let s=1;s<t.length&&t[s].parent===i;s++)i=t[s];return i}createPointerEvent(t,i,s){const e=this.allocateEvent(S);return this.copyPointerData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=s??this.hitTest(e.global.x,e.global.y)??this.gt[0],"string"==typeof i&&(e.type=i),e}createWheelEvent(t){const i=this.allocateEvent(F);return this.copyWheelData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t,i.target=this.hitTest(i.global.x,i.global.y),i}clonePointerEvent(t,i){const s=this.allocateEvent(S);return s.nativeEvent=t.nativeEvent,s.originalEvent=t.originalEvent,this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.target=t.target,s.path=t.composedPath().slice(),s.type=i??s.type,s}copyWheelData(t,i){i.deltaMode=t.deltaMode,i.deltaX=t.deltaX,i.deltaY=t.deltaY,i.deltaZ=t.deltaZ}copyPointerData(t,i){t instanceof S&&i instanceof S&&(i.pointerId=t.pointerId,i.width=t.width,i.height=t.height,i.isPrimary=t.isPrimary,i.pointerType=t.pointerType,i.pressure=t.pressure,i.tangentialPressure=t.tangentialPressure,i.tiltX=t.tiltX,i.tiltY=t.tiltY,i.twist=t.twist)}copyMouseData(t,i){t instanceof C&&i instanceof C&&(i.altKey=t.altKey,i.button=t.button,i.buttons=t.buttons,i.client.copyFrom(t.client),i.ctrlKey=t.ctrlKey,i.metaKey=t.metaKey,i.movement.copyFrom(t.movement),i.screen.copyFrom(t.screen),i.shiftKey=t.shiftKey,i.global.copyFrom(t.global))}copyData(t,i){i.isTrusted=t.isTrusted,i.srcElement=t.srcElement,i.timeStamp=performance.now(),i.type=t.type,i.detail=t.detail,i.view=t.view,i.which=t.which,i.layer.copyFrom(t.layer),i.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const i=this.eventPool.get(t).pop()||new t(this);return i.eventPhase=i.NONE,i.currentTarget=null,i.defaultPrevented=!1,i.path=null,i.target=null,i}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const i=t.constructor;this.eventPool.has(i)||this.eventPool.set(i,[]),this.eventPool.get(i).push(t)}Tt(t,i){const s=t.currentTarget.Pt[i];if(s)if("fn"in s)s.once&&t.currentTarget.removeListener(i,s.fn,void 0,!0),s.fn.call(s.context,t);else for(let e=0,n=s.length;e<n&&!t.propagationImmediatelyStopped;e++)s[e].once&&t.currentTarget.removeListener(i,s[e].fn,void 0,!0),s[e].fn.call(s[e].context,t)}}const X={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Y=class t{constructor(i){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=i,this.rootBoundary=new U(null),I.init(this),this.autoPreventDefault=!0,this.Mt=!1,this.ft=new S(null),this.xt=new F(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...t.defaultEventFeatures},{set:(t,i,s)=>("globalMove"===i&&(this.rootBoundary.enableGlobalMoveEvents=s),t[i]=s,!0)}),this._t=this._t.bind(this),this.kt=this.kt.bind(this),this.$t=this.$t.bind(this),this.Ot=this.Ot.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this.At}init(i){const{canvas:s,resolution:e}=this.renderer;this.setTargetElement(s),this.resolution=e,t.At=i.eventMode??"passive",Object.assign(this.features,i.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){I.destroy(),this.setTargetElement(null),this.renderer=null,this.Bt=null}setCursor(t){t||(t="default");let i=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(i=!1),this.Bt===t)return;this.Bt=t;const s=this.cursorStyles[t];if(s)switch(typeof s){case"string":i&&(this.domElement.style.cursor=s);break;case"function":s(t);break;case"object":i&&Object.assign(this.domElement.style,s)}else i&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.ft}_t(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const i=this.Dt(t);this.autoPreventDefault&&i[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let t=0,s=i.length;t<s;t++){const s=i[t],e=this.It(this.ft,s);this.rootBoundary.mapEvent(e)}this.setCursor(this.rootBoundary.cursor)}kt(t){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,I.pointerMoved();const i=this.Dt(t);for(let t=0,s=i.length;t<s;t++){const s=this.It(this.ft,i[t]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}$t(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let i=t.target;t.composedPath&&t.composedPath().length>0&&(i=t.composedPath()[0]);const s=i!==this.domElement?"outside":"",e=this.Dt(t);for(let t=0,i=e.length;t<i;t++){const i=this.It(this.ft,e[t]);i.type+=s,this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}Ot(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const i=this.Dt(t);for(let t=0,s=i.length;t<s;t++){const s=this.It(this.ft,i[t]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const i=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(i)}setTargetElement(t){this.Ct(),this.domElement=t,I.domElement=t,this.St()}St(){if(this.Mt||!this.domElement)return;I.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.kt,!0),this.domElement.addEventListener("pointerdown",this._t,!0),this.domElement.addEventListener("pointerleave",this.Ot,!0),this.domElement.addEventListener("pointerover",this.Ot,!0),globalThis.addEventListener("pointerup",this.$t,!0)):(globalThis.document.addEventListener("mousemove",this.kt,!0),this.domElement.addEventListener("mousedown",this._t,!0),this.domElement.addEventListener("mouseout",this.Ot,!0),this.domElement.addEventListener("mouseover",this.Ot,!0),globalThis.addEventListener("mouseup",this.$t,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this._t,!0),this.domElement.addEventListener("touchend",this.$t,!0),this.domElement.addEventListener("touchmove",this.kt,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.Mt=!0}Ct(){if(!this.Mt||!this.domElement)return;I.removeTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction="")),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.kt,!0),this.domElement.removeEventListener("pointerdown",this._t,!0),this.domElement.removeEventListener("pointerleave",this.Ot,!0),this.domElement.removeEventListener("pointerover",this.Ot,!0),globalThis.removeEventListener("pointerup",this.$t,!0)):(globalThis.document.removeEventListener("mousemove",this.kt,!0),this.domElement.removeEventListener("mousedown",this._t,!0),this.domElement.removeEventListener("mouseout",this.Ot,!0),this.domElement.removeEventListener("mouseover",this.Ot,!0),globalThis.removeEventListener("mouseup",this.$t,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this._t,!0),this.domElement.removeEventListener("touchend",this.$t,!0),this.domElement.removeEventListener("touchmove",this.kt,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.Mt=!1}mapPositionToPoint(t,i,s){const e=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},n=1/this.resolution;t.x=(i-e.left)*(this.domElement.width/e.width)*n,t.y=(s-e.top)*(this.domElement.height/e.height)*n}Dt(t){const i=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let s=0,e=t.changedTouches.length;s<e;s++){const e=t.changedTouches[s];void 0===e.button&&(e.button=0),void 0===e.buttons&&(e.buttons=1),void 0===e.isPrimary&&(e.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===e.width&&(e.width=e.radiusX||1),void 0===e.height&&(e.height=e.radiusY||1),void 0===e.tiltX&&(e.tiltX=0),void 0===e.tiltY&&(e.tiltY=0),void 0===e.pointerType&&(e.pointerType="touch"),void 0===e.pointerId&&(e.pointerId=e.identifier||0),void 0===e.pressure&&(e.pressure=e.force||.5),void 0===e.twist&&(e.twist=0),void 0===e.tangentialPressure&&(e.tangentialPressure=0),void 0===e.layerX&&(e.layerX=e.offsetX=e.clientX),void 0===e.layerY&&(e.layerY=e.offsetY=e.clientY),e.isNormalized=!0,e.type=t.type,i.push(e)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&!(this.supportsPointerEvents&&t instanceof globalThis.PointerEvent)){const s=t;void 0===s.isPrimary&&(s.isPrimary=!0),void 0===s.width&&(s.width=1),void 0===s.height&&(s.height=1),void 0===s.tiltX&&(s.tiltX=0),void 0===s.tiltY&&(s.tiltY=0),void 0===s.pointerType&&(s.pointerType="mouse"),void 0===s.pointerId&&(s.pointerId=1),void 0===s.pressure&&(s.pressure=.5),void 0===s.twist&&(s.twist=0),void 0===s.tangentialPressure&&(s.tangentialPressure=0),s.isNormalized=!0,i.push(s)}else i.push(t);return i}normalizeWheelEvent(t){const i=this.xt;return this.Ft(i,t),i.deltaX=t.deltaX,i.deltaY=t.deltaY,i.deltaZ=t.deltaZ,i.deltaMode=t.deltaMode,this.mapPositionToPoint(i.screen,t.clientX,t.clientY),i.global.copyFrom(i.screen),i.offset.copyFrom(i.screen),i.nativeEvent=t,i.type=t.type,i}It(t,i){return t.originalEvent=null,t.nativeEvent=i,t.pointerId=i.pointerId,t.width=i.width,t.height=i.height,t.isPrimary=i.isPrimary,t.pointerType=i.pointerType,t.pressure=i.pressure,t.tangentialPressure=i.tangentialPressure,t.tiltX=i.tiltX,t.tiltY=i.tiltY,t.twist=i.twist,this.Ft(t,i),this.mapPositionToPoint(t.screen,i.clientX,i.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=i.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=X[t.type]||t.type),t}Ft(t,i){t.isTrusted=i.isTrusted,t.srcElement=i.srcElement,t.timeStamp=performance.now(),t.type=i.type,t.altKey=i.altKey,t.button=i.button,t.buttons=i.buttons,t.client.x=i.clientX,t.client.y=i.clientY,t.ctrlKey=i.ctrlKey,t.metaKey=i.metaKey,t.movement.x=i.movementX,t.movement.y=i.movementY,t.page.x=i.pageX,t.page.y=i.pageY,t.relatedTarget=null,t.shiftKey=i.shiftKey}};Y.extension={name:"events",type:[e.Ag.WebGLSystem,e.Ag.CanvasSystem,e.Ag.WebGPUSystem],priority:-1},Y.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let L=Y;const z={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,get interactive(){return"dynamic"===this.eventMode||"static"===this.eventMode},set interactive(t){this.eventMode=t?"static":"passive"},jt:void 0,get eventMode(){return this.jt??L.defaultEventMode},set eventMode(t){this.jt=t},isInteractive(){return"static"===this.eventMode||"dynamic"===this.eventMode},interactiveChildren:!0,hitArea:null,addEventListener(t,i,s){const e="boolean"==typeof s&&s||"object"==typeof s&&s.capture,n="object"==typeof s?s.signal:void 0,h="object"==typeof s&&!0===s.once,o="function"==typeof i?void 0:i;t=e?`${t}capture`:t;const r="function"==typeof i?i:i.handleEvent,l=this;n&&n.addEventListener("abort",()=>{l.off(t,r,o)}),h?l.once(t,r,o):l.on(t,r,o)},removeEventListener(t,i,s){const e="function"==typeof i?void 0:i;t="boolean"==typeof s&&s||"object"==typeof s&&s.capture?`${t}capture`:t,i="function"==typeof i?i:i.handleEvent,this.off(t,i,e)},dispatchEvent(t){if(!(t instanceof u))throw new Error("Container cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};e.XO.add(L),e.XO.mixin(n.mc,z);class W{constructor(t){this.Rt=[],this.l=t,this.l.runners.postrender.add(this),this.l.runners.init.add(this),this.u=document.createElement("div"),this.u.style.position="absolute",this.u.style.top="0",this.u.style.left="0",this.u.style.pointerEvents="none",this.u.style.zIndex="1000"}init(){this.G=new r({domElement:this.u,renderer:this.l})}addRenderable(t,i){this.Rt.includes(t)||this.Rt.push(t)}updateRenderable(t){}validateRenderable(t){return!0}postrender(){const t=this.Rt;if(0!==t.length){this.G.ensureAttached();for(let i=0;i<t.length;i++){const s=t[i],e=s.element;if(!s.parent||s.globalDisplayStatus<7)e?.remove(),t.splice(i,1),i--;else{this.u.contains(e)||(e.style.position="absolute",e.style.pointerEvents="auto",this.u.appendChild(e));const t=s.worldTransform,i=s.Ut,n=s.width*i.x,h=s.height*i.y;e.style.transformOrigin=`${n}px ${h}px`,e.style.transform=`matrix(${t.a}, ${t.b}, ${t.c}, ${t.d}, ${t.tx-n}, ${t.ty-h})`,e.style.opacity=s.groupAlpha.toString()}}}else this.u.remove()}destroy(){this.l.runners.postrender.remove(this);for(let t=0;t<this.Rt.length;t++){const i=this.Rt[t];i.element?.remove()}this.Rt.length=0,this.u.remove(),this.G.destroy(),this.l=null}}W.extension={type:[e.Ag.WebGLPipes,e.Ag.WebGPUPipes,e.Ag.CanvasPipes],name:"dom"},e.XO.add(W),s(9010),s(8480),s(8928),s(5285),s(9305),s(2206),s(6444),s(2623),s(8723),s(7252),s(3859)}}]);